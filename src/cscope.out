cscope 15 $HOMEcpp/gkmeans               0000276623
	@/home/pclin/cpp/gkmeans/abstractkmeans.cpp

1 
	~"ab¡¿ùkm—ns.h
"

2 
	~"pqm©h.h
"

3 
	~"tim”.h
"

5 
	~<io¡»am
>

6 
	~<iomª
>

7 
	~<ÿs£¹
>

8 
	~<f¡»am
>

9 
	~<c¡ršg
>

10 
	~<cm©h
>

12 
	~"pqm©h.h
"

15 
usšg
 
Çme¥aû
 
	g¡d
;

17 cÚ¡ 
	gAb¡¿ùKM—ns
::
·¿Bound
 = 1024;

18 cÚ¡ 
	gAb¡¿ùKM—ns
::
sm®lV®0
 = 0.0000001f;

20 
	gAb¡¿ùKM—ns
::
	$Ab¡¿ùKM—ns
()

22 
this
->
ndim
 = 0;

23 
this
->
Ïb–s
 = 
NULL
;

24 
this
->
d©a
 = 
NULL
;

25 
this
->
Ëns
 = 
NULL
;

26 
this
->
d©aTy³
 = 0;

27 
this
->
£ed
 = 
_kµ_
;

28 
this
->
šfoM­
 = 
NULL
;

29 
this
->
sd©a
.
cŞ
 = 
NULL
;

30 
this
->
sd©a
.
šdex
 = 
NULL
;

31 
this
->
sd©a
.
d©a
 = 
NULL
;

32 
this
->
_INIT_
 = 
çl£
;

33 
this
->
_REFINE_
 = 
çl£
;

34 
this
->
d¡Üt
 = 0;

36 
this
->
®lEg
 = 0;

38 
	`¡rıy
(
¤cm©â
, "");

39 
	}
}

41 
boŞ
 
	gAb¡¿ùKM—ns
::
	$š™Memry
(cÚ¡ 
dNum
, cÚ¡ 
şu¡Num
)

43 
i
 = 0;

44 
this
->
Ëns
 = (*)
	`ÿÎoc
Ñhis->
couÁ
, ());

45 
this
->
Ïb–s
 = (*)
	`ÿÎoc
Ñhis->
couÁ
, ());

46 
this
->
šfoM­
 = 
Ãw
 
CLSInfo
[this->
şnumb
];

48 if(
kmMtd
 !ğ
_´c_
 && kmMtd !ğ
_pqc_
)

49 { if(
kmMtd
 =ğ
_rbkmn_
 || kmMtd =ğ
_hek_
 || kmMtd =ğ
_hec_
)

52 if(!
d©aTy³
)

54 
this
->
	`nÜmVeùs
Ñhis->
d©a
,his->
ndim
,his->
couÁ
,his->
Ëns
);

57 
this
->
	`nÜmVeùs
Ñhis->
sd©a
,his->
ndim
,his->
couÁ
,his->
Ëns
);

58 
i
 = 0; i < 
this
->
couÁ
; i++)

60 if(
Ëns
[
i
] == 0)

62 
Ïb–s
[
i
] = -1;

66 
Ïb–s
[
i
] = 0;

69 if(
kmMtd
 !ğ
_½kmn_
)

71 
cout
<<"Normalize input vectors .......... ";

72 
cout
<<"yes\n";

78 if(!
d©aTy³
)

79 
®lEg
 = 
this
->
	`nÜmVeùs
Ñhis->
d©a
,his->
Ëns
,his->
ndim
,his->
couÁ
);

81 
this
->
	`nÜmVeùs
Ñhis->
sd©a
,his->
Ëns
,his->
ndim
,his->
couÁ
);

82 if(
kmMtd
 !ğ
_½kmn_
)

84 
cout
<<"Normalize input vectors .......... ";

85 
cout
<<"no\n";

90  
Œue
;

91 
	}
}

93 
boŞ
 
	gAb¡¿ùKM—ns
::
Ïb–2şu¡”
(
veùÜ
<> *
şu¡”s
)

95 
i
;

96 
	gi
 = 0; i < 
	gthis
->
	gşnumb
; i++)

98 
	gşu¡”s
[
i
].
ş—r
();

100 
	gi
 = 0; i < 
	gthis
->
	gcouÁ
; i++)

102 
	gşu¡”s
[
this
->
Ïb–s
[
i
]].
push_back
(i);

105  
	gŒue
;

108 
boŞ
 
	gAb¡¿ùKM—ns
::
	$g‘Lab–
(*
Ïb–s
)

110 
	`memıy
(
Ïb–s
, 
this
->Ïb–s, ()*this->
couÁ
);

112 
	}
}

114 
	gAb¡¿ùKM—ns
::
	$budşu¡”
(cÚ¡ *
¤câ
, cÚ¡ *
d¡â
, cÚ¡ *
_£ed_
, cÚ¡ *
lg_fœ¡
,

115 cÚ¡ *
üŒn
, cÚ¡ 
num
, 
boŞ
 
_»fše_
)

117 if(
kmMtd
 =ğ
_kµkmn_
)

118 
cout
<<"Th»ad fÜ c®cu. di¡ªû ...... "<<
this
->
nThrd
<<
’dl
;

120 
this
->
	`cÚfig
(
_£ed_
, 
lg_fœ¡
, 
üŒn
, 1);

121 
this
->
şnumb
 = 
num
;

122 
this
->
_INIT_
 =his->
	`š™
(
¤câ
);

124 
this
->
_REFINE_
 = 
_»fše_
;

125 
msgSŒ
[64];

126 
Tim”
 *
mytm
 = 
NULL
;

127 ifĞ
this
->
kmMtd
 !ğ
_½kmn_
)

129 
mytm
 = 
Ãw
 
	`Tim”
();

130 
mytm
->
	`¡¬t
();

132 if(!
this
->
_INIT_
 ||his->
couÁ
 == 0)

134 
cout
<<"erro :‚o„ow\n";

137 if(
this
->
couÁ
 <ğthis->
şnumb
)

139 
cout
<<"toØmªy clu¡”‚um:"<<"„ow = "<<
this
->
couÁ
<<" cÊumb = "<<this->
şnumb
<<
’dl
;

144 
this
->
	`š™Memry
Ñhis->
couÁ
, 
şnumb
);

145 
this
->
şnumb
 =his->
	`şu¡
(şnumb, 
d¡â
, 0);

148 
	`¥rštf
(
msgSŒ
, "%s\t%s\t%s\t%s\t%d\t%lf\t", 
mthSŒ
, 
_£ed_
, 
lg_fœ¡
, 
üŒn
, 
num
, 
this
->
d¡Üt
);

149 if(
this
->
kmMtd
 !ğ
_½kmn_
)

151 
mytm
->
	`’d
(
Œue
);

152 
d–‘e
 
mytm
;

154  
this
->
şnumb
;

155 
	}
}

157 
	gAb¡¿ùKM—ns
::
	$budşu¡”
(*
m©
, cÚ¡ 
row
, cÚ¡ 
dim
, cÚ¡ *
d¡â
,

158 cÚ¡ *
_£ed_
, cÚ¡ *
lg_fœ¡
, cÚ¡ *
üŒn
, cÚ¡ 
num
, 
boŞ
 
_»fše_
)

160 
	`as£¹
(
m©
);

161 
	`as£¹
(
üŒn
);

162 
	`as£¹
(
lg_fœ¡
);

163 
this
->
_REFER_
 = 
Œue
;

165 
this
->
	`cÚfig
(
_£ed_
, 
lg_fœ¡
, 
üŒn
, 0);

166 
this
->
şnumb
 = 
num
;

168 
this
->
_INIT_
 =his->
	`š™
(
m©
, 
row
, 
dim
);

169 
this
->
_REFINE_
 = 
_»fše_
;

171 
Tim”
 *
mytm
 = 
NULL
;

172 if(
this
->
kmMtd
 !ğ
_½kmn_
)

174 
mytm
 = 
Ãw
 
	`Tim”
();

175 
mytm
->
	`¡¬t
();

177 if(!
this
->
_INIT_
 ||his->
couÁ
 == 0)

179 
cout
<<"erro :‚o„ow\n";

182 if(
this
->
couÁ
 <ğthis->
şnumb
)

184 
cout
<<"toØmªy clu¡”‚um:"<<"„ow = "<<
this
->
couÁ
<<" cÊumb = "<<this->
şnumb
<<
’dl
;

189 
this
->
	`š™Memry
Ñhis->
couÁ
, 
şnumb
);

190 
this
->
şnumb
 =his->
	`şu¡
(şnumb, 
d¡â
, 0);

192 if(
this
->
kmMtd
 !ğ
_½kmn_
)

194 
mytm
->
	`’d
(
Œue
);

195 
d–‘e
 
mytm
;

198  
this
->
şnumb
;

199 
	}
}

201 *
	gAb¡¿ùKM—ns
::
	$g‘Clu¡”
(cÚ¡ 
şab–0
, &
row
, &
dim
)

203 
veùÜ
<>::
™”©Ü
 
™
;

204 
veùÜ
<> 
veùs
;

205 
i
 = 0;

206 
loc1
 = 0, 
loc2
 = 0, 
v
 = 0;

207 
ıysize
 = ()*
this
->
ndim
;

209 
i
 = 0; i < 
this
->
couÁ
; i++)

211 if(
şab–0
 =ğ
this
->
Ïb–s
[
i
])

213 
veùs
.
	`push_back
(
i
);

216 
row
 = 
veùs
.
	`size
();

217 *
ş_d©a
 = 
Ãw
 [
this
->
šfoM­
[
şab–0
].
n
*this->
ndim
];

219 
dim
 = 
this
->
ndim
;

220 
	`as£¹
(
row
 =ğ
this
->
šfoM­
[
şab–0
].
n
);

221 
™
 = 
veùs
.
	`begš
(), 
i
 = 0; iˆ!ğveùs.
	`’d
(); it++)

223 
v
 = *
™
;

224 
loc1
 = 
v
*
this
->
ndim
;

225 
loc2
 = 
i
*
this
->
ndim
;

226 
	`memıy
(
ş_d©a
+
loc2
, 
this
->
d©a
+
loc1
, 
ıysize
);

227 
i
++;

229 
veùs
.
	`ş—r
();

231  
ş_d©a
;

232 
	}
}

236 
	gAb¡¿ùKM—ns
::
	$g‘I2
(cÚ¡ *
Ds
, cÚ¡ 
k
, cÚ¡ 
dim
, cÚ¡ *
tm²s
)

238 
sumD¡
 = 0, 
tmpE
 = 0;

239 
i
 = 0, 
j
 = 0, 
loc
 = 0;

241 
j
 = 0; j < 
k
; j++)

243 if(
tm²s
[
j
] <= 0)

246 
loc
 = 
dim
*
j
;

247 
tmpE
 = 0;

249 
i
 = 0; i < 
dim
; i++)

251 
tmpE
 +ğ
Ds
[
loc
+
i
]*Ds[loc+i];

253 
sumD¡
 +ğ
tmpE
/
tm²s
[
j
];

255  
sumD¡
;

256 
	}
}

258 
	gAb¡¿ùKM—ns
::
	$ÿlAVGDi¡
(cÚ¡ *
Ds
, cÚ¡ *
Ns
, cÚ¡ 
şu¡Num
, 
CLSInfo
 *
šfos
)

261 *
dùs
 = 
Ãw
 [
şu¡Num
];

262 *
C
 = 
Ãw
 [
this
->
ndim
];

263 
tmpE
 = 0, 
sumEg
 = 0, 
tmpEg
 = 0,
sumDùs
 = 0;

265 
	`mem£t
(
dùs
, 0, ()*
şu¡Num
);

266 
i
, 
j
 = 0, 
loc
 = 0;

267 
c
 = 0;

268 
i
 = 0; i < 
this
->
couÁ
; i++)

270 
c
 = 
Ïb–s
[
i
];

271 if(
kmMtd
 =ğ
_rbkmn_
)

273 
dùs
[
c
] +ğ
Ëns
[
i
]*lens[i];

274 
sumDùs
 +ğ
Ëns
[
i
]*lens[i];

278 
dùs
[
c
] +ğ
Ëns
[
i
];

279 
sumDùs
 +ğ
Ëns
[
i
];

282 
i
 = 0; i < 
şu¡Num
; i++)

284 
šfos
[
i
].
n
 = 
Ns
[i];

286 if(
Ns
[
i
] < 1)

288 
šfos
[
i
].
E
 = 0;

291 
loc
 = 
i
*
this
->
ndim
;

292 
tmpEg
 = 0;

293 
j
 = 0; j < 
this
->
ndim
; j++)

295 
C
[
j
] = 
Ds
[
loc
+j]/
Ns
[
i
];

296 
tmpEg
 +ğ
Ds
[
loc
+
j
]*Ds[loc+j];

298 
sumEg
 +ğ
tmpEg
/
Ns
[
i
];

299 
tmpE
 = 
PQM©h
::
	`dvec_nÜm
(
C
, 
this
->
ndim
, 2);

300 
tmpE
 = 
dùs
[
i
] - 
šfos
[i].
n
*tmpE*tmpE;

301 if(
šfos
[
i
].
n
 > 1)

303 
šfos
[
i
].
E
 = 2*(
tmpE
/(šfos[i].
n
 - 1));

307 
šfos
[
i
].
E
 = 0;

311 
this
->
d¡Üt
 = (
sumDùs
 - 
sumEg
)/this->
couÁ
;

312 
d–‘e
 [] 
dùs
;

313 
d–‘e
 [] 
C
;

314 
dùs
 = 
C
 = 
NULL
;

315  
this
->
d¡Üt
;

316 
	}
}

318 
	gAb¡¿ùKM—ns
::
	$ÿlAVGDi¡
(cÚ¡ *
Ds
, cÚ¡ *
Ns
, cÚ¡ 
şu¡Num
)

320 *
dùs
 = 
Ãw
 [
şu¡Num
], 
tmpE
 = 0, 
sumEg
 = 0, 
tmpEg
 = 0;

321 
sumDùs
 = 0;

322 *
C
 = 
Ãw
 [
this
->
ndim
];

323 
	`mem£t
(
dùs
, 0, ()*
şu¡Num
);

324 
i
, 
j
 = 0, 
loc
 = 0;

325 
c
 = 0;

326 
i
 = 0; i < 
this
->
couÁ
; i++)

328 
c
 = 
Ïb–s
[
i
];

329 if(
kmMtd
 =ğ
_rbkmn_
)

331 
dùs
[
c
] +ğ
Ëns
[
i
]*lens[i];

332 
sumDùs
 +ğ
Ëns
[
i
]*lens[i];

336 
dùs
[
c
] +ğ
Ëns
[
i
];

337 
sumDùs
 +ğ
Ëns
[
i
];

340 
i
 = 0; i < 
şu¡Num
; i++)

342 if(
Ns
[
i
] < 1)

346 
loc
 = 
i
*
this
->
ndim
;

347 
tmpEg
 = 0;

348 
j
 = 0; j < 
this
->
ndim
; j++)

350 
C
[
j
] = 
Ds
[
loc
+j]/
Ns
[
i
];

351 
tmpEg
 +ğ
Ds
[
loc
+
j
]*Ds[loc+j];

353 
sumEg
 +ğ
tmpEg
/
Ns
[
i
];

354 
tmpE
 = 
PQM©h
::
	`dvec_nÜm
(
C
, 
this
->
ndim
, 2);

355 
tmpE
 = 
dùs
[
i
] - 
Ns
[i]*tmpE*tmpE;

358 
this
->
d¡Üt
 = (
sumDùs
 - 
sumEg
)/this->
couÁ
;

359 
d–‘e
 [] 
dùs
;

360 
d–‘e
 [] 
C
;

361 
dùs
 = 
C
 = 
NULL
;

362  
this
->
d¡Üt
;

363 
	}
}

366 
	gAb¡¿ùKM—ns
::
	$´štClu¡”s
(cÚ¡ *
d¡dœ
)

368 
şab–
 = 0, 
i
, 
j
, 
loc
, 
couÁ”
 = 
this
->
couÁ
;

369 
CLSInfo
 &
üÁšfo
 = 
šfoM­
[0];

370 
FILE
 *
å
 = 
NULL
;

371 
m©â
[1024];

372 
	`as£¹
(
d¡dœ
);

374 
j
 = 0; j < 
this
->
şnumb
; j++)

376 
üÁšfo
 = 
šfoM­
[
j
];

377 
	`¥rštf
(
m©â
, "%s%d.m©", 
d¡dœ
, 
j
);

378 
å
 = 
	`fİ’
(
m©â
, "w");

379 
	`årštf
(
å
,"%d %d\n", 
üÁšfo
.
n
, 
this
->
ndim
);

380 
	`fşo£
(
å
);

383 
i
 = 0; i < 
this
->
couÁ
; i++)

385 
şab–
 = 
Ïb–s
[
i
];

386 
loc
 = 
i
*
this
->
ndim
;

388 
	`¥rštf
(
m©â
, "%s%d.m©", 
d¡dœ
, 
şab–
);

389 
å
 = 
	`fİ’
(
m©â
, "a");

390 
j
 = 0; j < 
this
->
ndim
; j++)

392 
	`årštf
(
å
,"%à", 
d©a
[
loc
+
j
]);

394 
	`årštf
(
å
,"\n");

395 
	`fşo£
(
å
);

396 
couÁ”
--;

397 
cout
<<"\r\r"<<
	`£tw
(8)<<
couÁ”
;

399 
cout
<<
’dl
;

400 
	}
}

402 
	gAb¡¿ùKM—ns
::
	$´štClu¡”
(cÚ¡ *
d¡â
)

404 
FILE
 *
å
 = 
	`fİ’
(
d¡â
, "w");

405 if(
å
 =ğ
NULL
)

407 
cout
<<"F'"<<
d¡â
<<"' cannot open for write!\n";

410 
i
;

412 
i
 = 0; i < 
this
->
couÁ
; i++)

414 
	`årštf
(
å
, "%d\n", 
this
->
Ïb–s
[
i
]);

417 
	`fşo£
(
å
);

419 
	}
}

421 
	gAb¡¿ùKM—ns
::
	$idx2şab–
(cÚ¡ 
i
)

423 if(
this
->
Ïb–s
 =ğ
NULL
)

426 if(
i
 < 0 ||˜>ğ
this
->
couÁ
 ||his->
şnumb
 == 0)

432  
this
->
Ïb–s
[
i
];

434 
	}
}

436 
	gAb¡¿ùKM—ns
::
	$nÜmVeùs
(*
veùs
, *
Ëns
,

437 cÚ¡ 
dim
, cÚ¡ 
n0
)

439 
	`as£¹
(
veùs
);

440 
	`as£¹
(
Ëns
);

441 
i
 = 0, 
j
 = 0, 
loc
 = 0;

442 
Ën
 = 0, 
sumEg1
 = 0;

443 
i
 = 0; i < 
n0
; i++)

445 
Ën
 = 0;

446 
j
 = 0; j < 
dim
; j++)

448 
Ën
 +ğ
veùs
[
loc
+
j
]*vects[loc+j];

450 
Ëns
[
i
] = 
Ën
;

451 
sumEg1
 +ğ
Ëns
[
i
];

452 
loc
 +ğ
dim
;

454  
sumEg1
;

455 
	}
}

457 
	gAb¡¿ùKM—ns
::
	$nÜmVeùs
(cÚ¡ 
S·r£M©rix
 &
sveùs
, *
Ëns
,

458 cÚ¡ 
dim
, cÚ¡ 
n0
)

460 
	`as£¹
(
sveùs
.
d©a
);

461 
	`as£¹
(
sveùs
.
šdex
);

462 
	`as£¹
(
sveùs
.
cŞ
);

463 
	`as£¹
(
Ëns
);

464 
i
 = 0, 
j
 = 0;

465 
Ën
 = 0;

466 
i
 = 0; i < 
n0
; i++)

468 
Ën
 = 0;

469 
j
 = 
sveùs
.
cŞ
[
i
]; j < svects.col[i+1]; j++)

471 
Ën
 +ğ
sveùs
.
d©a
[
j
]*svects.data[j];

473 
Ëns
[
i
] = 
Ën
;

475 
	}
}

478 
	gAb¡¿ùKM—ns
::
	$nÜmVeùs
(
S·r£M©rix
 &
sveùs
, cÚ¡ 
d0
,

479 cÚ¡ 
n0
, *
Ëns
)

481 
	`as£¹
(
sveùs
.
d©a
);

482 
	`as£¹
(
sveùs
.
šdex
);

483 
	`as£¹
(
sveùs
.
cŞ
);

484 
	`as£¹
(
Ëns
);

485 
i
 = 0, 
j
 = 0, 
loc
 = 0;

486 
Ën
 = 0;

487 
i
 = 0; i < 
n0
; i++)

489 
Ën
 = 0;

490 
j
 = 
sveùs
.
cŞ
[
i
]; j < svects.col[i+1]; j++)

492 
Ën
 +ğ
sveùs
.
d©a
[
j
]*svects.data[j];

494 
Ëns
[
i
] = 
Ën
;

495 
Ën
 = 
	`sq¹
(len);

496 
Ëns
[
i
] = 1;

497 if(
Ën
 > 
Ab¡¿ùKM—ns
::
sm®lV®0
)

498 
j
 = 
sveùs
.
cŞ
[
i
]; j < svects.col[i+1]; j++)

500 
sveùs
.
d©a
[
j
] = sveùs.d©a[j]/
Ën
;

504 
Ëns
[
i
] = 0;

507 
loc
 +ğ
d0
;

510 
	}
}

512 
	gAb¡¿ùKM—ns
::
	$nÜmVeùs
(*
veùs
, cÚ¡ 
d0
,

513 cÚ¡ 
n0
, *
Ëns
)

515 
	`as£¹
(
veùs
);

516 
	`as£¹
(
Ëns
);

517 
i
 = 0, 
j
 = 0, 
loc
 = 0;

518 
Ën
 = 0;

519 
i
 = 0; i < 
n0
; i++)

521 
Ën
 = 0;

522 
j
 = 0; j < 
d0
; j++)

524 
Ën
 +ğ
veùs
[
loc
+
j
]*vects[loc+j];

526 
Ëns
[
i
] = 
Ën
;

527 
Ën
 = 
	`sq¹
(len);

528 
Ëns
[
i
] = 1;

529 if(
Ën
 > 
Ab¡¿ùKM—ns
::
sm®lV®0
)

531 
j
 = 0; j < 
d0
; j++)

533 
veùs
[
loc
+
j
] = veùs[loc+j]/
Ën
;

538 
Ëns
[
i
] = 0;

541 
loc
 +ğ
d0
;

545 
	}
}

547 
	gAb¡¿ùKM—ns
::
	$§veC’‹rs
(cÚ¡ *
d¡â
, *
¬¿yD
, 
boŞ
 
­³nd
, boŞ 
_nÜm_
)

549 
şab–
 = 0, 
j
, 
loc
;

550 
of¡»am
 *
outSŒm
 = 
NULL
;

551 if(
­³nd
)

553 
outSŒm
 = 
Ãw
 
	`of¡»am
(
d¡â
, 
ios
::
­p
);

557 
outSŒm
 = 
Ãw
 
	`of¡»am
(
d¡â
, 
ios
::
out
);

558 (*
outSŒm
)<<
this
->
şnumb
<<" "<<this->
ndim
<<
’dl
;;

561 
şab–
 = 0; cÏb– < 
this
->
şnumb
; clabel++)

563 
loc
 = 
şab–
*
this
->
ndim
;

564 
j
 = 0; j < 
this
->
ndim
; j++)

566 
¬¿yD
[
loc
+
j
] =‡¼ayD[loc+j]/
this
->
šfoM­
[
şab–
].
n
;

571 if(
_nÜm_
)

573 
PQM©h
::
	`l2_nÜm
(
¬¿yD
+
loc
, 
ndim
);

577 
j
 = 0; j < 
this
->
ndim
; j++)

579 (*
outSŒm
)<<
¬¿yD
[
loc
+
j
]<<" ";

581 (*
outSŒm
)<<
’dl
;

584 
outSŒm
->
	`şo£
();

587 
	}
}

589 
boŞ
 
	gAb¡¿ùKM—ns
::
	$§ve_şu¡
(cÚ¡ *
d¡â
)

591 if(
d¡â
 =ğ
NULL
 || !
	`¡rcmp
(dstfn,""))

592  
çl£
;

594 
of¡»am
 *
outSŒm
 = 
Ãw
 
	`of¡»am
(
d¡â
, 
ios
::
out
);

595 if(!
outSŒm
->
	`is_İ’
())

597 
cout
<<"\nDe¡šf'"<<
d¡â
<<"' cannot open for write!\n";

598  
çl£
;

601 
i
 = 0; i < 
this
->
couÁ
; i++)

603 (*
outSŒm
)<<
this
->
Ïb–s
[
i
]<<
’dl
;

605 
outSŒm
->
	`şo£
();

606  
Œue
;

607 
	}
}

610 
	gAb¡¿ùKM—ns
::
	$»£ab–s
(&
n
)

612 
i
;

613 
veùÜ
<> 
»®id
;

614 
m­
<, > 
lbm­
;

615 *
lb
 = 
Ãw
 [
this
->
şnumb
];

616 
	`mem£t
(
lb
, 0, ()*(
this
->
şnumb
));

617 
i
 = 0; i < 
this
->
couÁ
; i++)

619 
lb
[
Ïb–s
[
i
]] = 1;

621 
i
 = 0; i < 
this
->
şnumb
; i++)

623 if(
lb
[
i
] != 0)

624 
»®id
.
	`push_back
(
i
);

626 
i
 = 0; i < 
»®id
.
	`size
(); i++)

628 
lbm­
.
	`š£¹
(
·œ
<, >(
»®id
[
i
], i));

630 
i
 = 0; i < 
this
->
couÁ
; i++)

632 
Ïb–s
[
i
] = 
lbm­
[labels[i]];

634 
n
 = 
lbm­
.
	`size
();

636 
d–‘e
 [] 
lb
;

637 
lb
 = 
NULL
;

638 
	}
}

640 
	gAb¡¿ùKM—ns
::~
	$Ab¡¿ùKM—ns
()

642 if(
this
->
_REFER_
)

644 
this
->
d©a
 = 
NULL
;

645 
this
->
sd©a
.
d©a
 = 
NULL
;

646 
this
->
sd©a
.
šdex
 = 
NULL
;

647 
this
->
sd©a
.
cŞ
 = 
NULL
;

651 if(
this
->
d©a
 !ğ
NULL
)

653 
	`ä“
(
this
->
d©a
);

654 
this
->
d©a
 = 
NULL
;

656 if(
this
->
sd©a
.
šdex
 !ğ
NULL
)

658 
d–‘e
 [] 
this
->
sd©a
.
šdex
;

659 
d–‘e
 [] 
this
->
sd©a
.
cŞ
;

660 
this
->
sd©a
.
šdex
 = 
NULL
;

661 
this
->
sd©a
.
cŞ
 = 
NULL
;

664 if(
this
->
sd©a
.
d©a
 !ğ
NULL
)

666 
d–‘e
 [] 
this
->
sd©a
.
d©a
;

667 
this
->
sd©a
.
d©a
 = 
NULL
;

670 if(
this
->
šfoM­
 !ğ
NULL
)

672 
d–‘e
 [] 
this
->
šfoM­
;

673 
this
->
šfoM­
 = 
NULL
;

675 if(
this
->
Ëns
 !ğ
NULL
)

677 
	`ä“
(
this
->
Ëns
);

678 
this
->
Ëns
 = 
NULL
;

680 if(
this
->
Ïb–s
 !ğ
NULL
)

682 
	`ä“
(
this
->
Ïb–s
);

683 
this
->
Ïb–s
 = 
NULL
;

685 
	}
}

	@/home/pclin/cpp/gkmeans/abstractkmeans.h

1 #iâdeà
ABSTRACTKMEANS_H


2 
	#ABSTRACTKMEANS_H


	)

4 
	~"¥¬£m©rix.h
"

5 
	~"şsšfo.h
"

6 
	~"Â™em.h
"

8 
	~<unÜd”ed_£t
>

9 
	~<veùÜ
>

10 
	~<m­
>

12 
	sCLSIndex


14 
	mpublic
:

15 
CLSIndex
()

17 
šdex
 = 0;

18 
	mv®
 = 0.0;

20 
CLSIndex
(cÚ¡ 
idx
, cÚ¡ 
v®0
)

22 
	mšdex
 = 
idx
;

23 
	mv®
 = 
v®0
;

25 
	mšdex
;

26 
	mv®
;

28 
boŞ
 
LtComp
 (cÚ¡ 
CLSIndex
 *
a
,cÚ¡ CLSIndex *
b
)

30  (
	ma
->
	mv®
 < 
	mb
->val);

32 
boŞ
 
LgComp
 (cÚ¡ 
CLSIndex
 *
a
,cÚ¡ CLSIndex *
b
)

34  (
	ma
->
	mv®
 < 
	mb
->val);

39 
	eKMN_OPT
 {
	m_tkmn_
 = 0, 
	m_kµkmn_
 = 1, 
	m_xbkmn_
 = 2, 
	m_xtkmn_
 = 3, 
	m_mnkmn_
 = 4, 
	m_Şkmn_
 = 5, 
	m_rbkmn_
, 
	m_¼kmn_
, 
	m_lvq_
, 
	m_hek_
, 
	m_imk_
, 
	m_hec_
, 
	m_´c_
, 
	m_pqc_
, 
	m_½kmn_
};

40 
	eOPTZ
 {
	m_I1_
 = 0, 
	m_I2_
 = 1, 
	m_I3_
, 
	m_I4_
, 
	m_E1_
, 
	m_E2_
,
	m_T1_
};

41 
	eSEED
 {
	m_ºd_
 = 0, 
	m_kµ_
 = 1, 
	m_nÚ_
};

43 şas 
	cAb¡¿ùKM—ns


45 
	m´Ùeùed
:

46 
Ab¡¿ùKM—ns
();

48 
	m´Ùeùed
:

49 cÚ¡ 
·¿Bound
;

50 
	mcouÁ
, 
	mşnumb
;

51 
	mnITER
, 
	mndim
;

52 
	mnThrd
;

53 
	mveùÜ
<
	mNNI‹m
*> 
	msÜ‹d_¡ack
;

54 cÚ¡ 
	msm®lV®0
;

55 *
	mËns
, 
	m®lEg
;

56 
boŞ
 
	m_INIT_
, 
	m_REFER_
, 
	m_REFINE_
;

57 
	m¤cm©â
[1024];

58 
	mmthSŒ
[16];

59 
	mmvs
[2];

60 
	md¡Üt
;

61 
SEED
 
	m£ed
;

62 *
	md©a
;

64 
S·r£M©rix
 
	msd©a
;

65 
CLSInfo
 *
	mšfoM­
;

66 *
	mÏb–s
;

67 
KMN_OPT
 
	mkmMtd
;

68 
boŞ
 
	md©aTy³
;

69 
boŞ
 
	mSHUFFLE
;

70 
OPTZ
 
	mmyİtz
;

71 
	mpublic
:

72 
budşu¡”
(cÚ¡ *
¤câ
, cÚ¡ *
d¡â
, cÚ¡ *
_£ed_
, cÚ¡ *
lg_fœ¡
,

73 cÚ¡ *
üŒn
, cÚ¡ 
num
, 
boŞ
 
_»fše_
);

74 
budşu¡”
(*
m©
, cÚ¡ 
row
, cÚ¡ 
dim
, cÚ¡ *
d¡â
,

75 cÚ¡ *
_£ed_
, cÚ¡ *
lg_fœ¡
, cÚ¡ *
üŒn
, cÚ¡ 
num
, 
boŞ
 
_»fše_
);

77 
boŞ
 
š™Memry
(cÚ¡ 
dNum
, cÚ¡ 
şu¡Num
);

78 
vœtu®
 
boŞ
 
š™
(cÚ¡ *
¤câ
) = 0;

79 
vœtu®
 
boŞ
 
š™
(*
d©a
, cÚ¡ 
row
, cÚ¡ 
dim
) = 0;

80 
vœtu®
 
boŞ
 
cÚfig
(cÚ¡ *
_£ed_
, cÚ¡ *
lg_fœ¡
, cÚ¡ *
üŒn
, 
v”bo£
) = 0;

81 
vœtu®
 
şu¡
(cÚ¡ 
şu¡_num
, cÚ¡ *
d¡â
, cÚ¡ 
v”bo£
) = 0;

82 
g‘I2
(cÚ¡ *
Ds
, cÚ¡ 
k
, cÚ¡ 
dim
, cÚ¡ *
tm²s
);

84 
ÿlAVGDi¡
(cÚ¡ *
Ds
, cÚ¡ *
Ns
, cÚ¡ 
şu¡Num
, 
CLSInfo
 *
šfos
);

85 
ÿlAVGDi¡
(cÚ¡ *
Ds
, cÚ¡ *
Ns
, cÚ¡ 
şu¡Num
);

86 *
g‘Clu¡”
(cÚ¡ 
şab–0
, &
row
, &
dim
);

88 
vœtu®
 
§veC’‹rs
(cÚ¡ *
d¡â
, 
boŞ
 
­³nd
) = 0;

89 
§veC’‹rs
(cÚ¡ *
d¡â
, *
¬¿yD
, 
boŞ
 
­³nd
, boŞ 
nÜm
);

90 
vœtu®
 
ãtchC’‹rs
(*
ûÁ”s
) = 0;

92 
idx2şab–
(cÚ¡ 
i
);

94 
´štClu¡”s
(cÚ¡ *
d¡dœ
);

95 
´štClu¡”
(cÚ¡ *
d¡â
);

96 
boŞ
 
§ve_şu¡
(cÚ¡ *
d¡â
);

97 
boŞ
 
Ïb–2şu¡”
(
veùÜ
<> *
şu¡”s
);

98 
boŞ
 
g‘Lab–
(*
Ïb–s
);

100 
nÜmVeùs
(*
veùs
, *
Ëns
, cÚ¡ 
dim
, cÚ¡ 
n0
);

101 
nÜmVeùs
(cÚ¡ 
S·r£M©rix
 &
sveùs
, *
Ëns
, cÚ¡ 
dim
, cÚ¡ 
n0
);

102 
nÜmVeùs
(*
veùs
, cÚ¡ 
d0
, cÚ¡ 
n0
, *
Ëns
);

103 
nÜmVeùs
(
S·r£M©rix
 &
veùs
, cÚ¡ 
d0
, cÚ¡ 
n0
, *
Ëns
);

105 
»£ab–s
(&
şu¡num
);

107 
	mvœtu®
 ~
Ab¡¿ùKM—ns
();

	@/home/pclin/cpp/gkmeans/cleaner.cpp

1 
	~"ş—Ãr.h
"

3 
	~<ÿs£¹
>

5 
	gCËª”
::
ş—rM©rix
(
veùÜ
<veùÜ<> > &
m©rix
)

7 
veùÜ
<veùÜ<> >::
™”©Ü
 
v™
;

8 
	gv™
 = 
m©rix
.
begš
(); v™ !ğm©rix.
’d
(); vit++)

10 
	gveùÜ
<> &
	güÁVeù
 = *
v™
;

11 
	güÁVeù
.
ş—r
();

13 
	gm©rix
.
ş—r
();

17 
	gCËª”
::
ä“I‹mM­s
(
m­
<, m­<
¡ršg
, cÚ¡ *> *> &
™mM­s
)

19 
	gm­
<, m­<
	g¡ršg
,cÚ¡ *>* >::
™”©Ü
 
™
;

20 
	gm­
<
	g¡ršg
, cÚ¡ *>::
™”©Ü
 
™”
;

21 
	gm­
<
	g¡ršg
, cÚ¡ *> *
	güÁM­
;

22 
¡ršg
 
	gkey¡r
;

23 
	g™
 = 
™mM­s
.
begš
(); iˆ!ğ™mM­s.
’d
(); it++)

25 
	güÁM­
 = 
™
->
£cÚd
;

26 
	g™”
 = 
üÁM­
->
begš
(); i‹¸!ğüÁM­->
’d
(); iter++)

28 
	gkey¡r
 = 
™”
->
fœ¡
;

37 
	güÁM­
->
ş—r
();

38 
d–‘e
 
	güÁM­
;

40 
	g™mM­s
.
ş—r
();

43 
	gCËª”
::
ş—r_i2kM­
(
m­
<, cÚ¡ *> &
i2kM­
)

45 
	gm­
<,cÚ¡ *>::
™”©Ü
 
m™
;

47 cÚ¡ *
	gv®
;

48 
	gm™
 = 
i2kM­
.
begš
(); m™ !ği2kM­.
’d
(); mit++)

50 
	gv®
 = 
m™
->
£cÚd
;

51 
	gd–‘e
 [] 
	gv®
;

53 
	gi2kM­
.
”a£
(
i2kM­
.
begš
(),i2kM­.
’d
());

57 
	gCËª”
::
ä“P¬aM­
(
m­
<
¡ršg
, cÚ¡ *> &
·¿s
)

59 
	gm­
<
	g¡ršg
,cÚ¡ *>::
™”©Ü
 
m™
;

60 
¡ršg
 
	güÁ¡r
;

61 cÚ¡ *
	gv®
;

62 
	gm™
 = 
·¿s
.
begš
(); m™ !ğ·¿s.
’d
(); mit++)

64 
	gv®
 = 
m™
->
£cÚd
;

65 
	güÁ¡r
 = 
m™
->
fœ¡
;

66 
	güÁ¡r
.
”a£
(
üÁ¡r
.
begš
(),üÁ¡r.
’d
());

67 
	gd–‘e
 [] 
	gv®
;

69 
	g·¿s
.
”a£
(
·¿s
.
begš
(),·¿s.
’d
());

74 
	gCËª”
::
ä“SŒVeù
(
veùÜ
<cÚ¡ *> &
¡r_veù
)

76 cÚ¡ *
üÁChrs
;

77 
	gveùÜ
<cÚ¡ *>::
™”©Ü
 
™
;

78 
	g™
 = 
¡r_veù
.
begš
(); iˆ!ğ¡r_veù.
’d
(); it++)

80 
	güÁChrs
 = *
™
;

81 
	gd–‘e
 [] 
	güÁChrs
;

83 
	g¡r_veù
.
ş—r
();

87 
	gCËª”
::
ş—r_k2iM­
(
m­
<
¡ršg
, > &
»fTab
)

89 
	gm­
<
	g¡ršg
, >::
™”©Ü
 
m™
;

90 
¡ršg
 
	gkey
;

92 
	gm™
 = 
»fTab
.
begš
(); m™ !ğ»fTab.
’d
(); mit++)

94 
	gkey
 = 
m™
->
fœ¡
;

95 
	gkey
.
ş—r
();

98 
	g»fTab
.
ş—r
();

101 
	gCËª”
::
ş—r_k2iM­
(
m­
<
¡ršg
, > &
»fTab
)

103 
	gm­
<
	g¡ršg
, >::
™”©Ü
 
m™
;

104 
¡ršg
 
	gkey
;

106 
	gm™
 = 
»fTab
.
begš
(); m™ !ğ»fTab.
’d
(); mit++)

108 
	gkey
 = 
m™
->
fœ¡
;

109 
	gkey
.
ş—r
();

112 
	g»fTab
.
ş—r
();

115 
	gCËª”
::
ş—rNNLi¡
(
li¡
<
NNI‹m
*> &
ÂI‹ms
)

117 
NNI‹m
 *
üÁ_™m
 = 
NULL
;

118 
	gli¡
<
	gNNI‹m
*>::
™”©Ü
 
™m_™”
;

120 
	g™m_™”
 = 
ÂI‹ms
.
begš
(); itm_™” !ğÂI‹ms.
’d
(); itm_iter++)

122 
	güÁ_™m
 = *
™m_™”
;

123 
d–‘e
 
	güÁ_™m
;

125 
	gÂI‹ms
.
”a£
(
ÂI‹ms
.
begš
(),‚nI‹ms.
’d
());

128 
boŞ
 
	gCËª”
::
ş—rVeùÜ
(
veùÜ
<
NNI‹m
*> &
veùs
)

130 
veùÜ
<
NNI‹m
*>::
™”©Ü
 
v™
;

131 
NNI‹m
 *
	güÁItm
;

132 
	gv™
 = 
veùs
.
begš
(); v™ !ğveùs.
’d
(); vit++)

134 
	güÁItm
 = *
v™
;

135 
d–‘e
 
	güÁItm
;

137 
	gveùs
.
ş—r
();

138  
	gŒue
;

141 
	gCËª”
::
ş—rInfoM­
(
m­
<, 
CLSInfo
*> &
šfoM­
)

143 
	gm­
<, 
	gCLSInfo
*>::
™”©Ü
 
m™
;

144 
CLSInfo
 *
	güÁ_šfo
;

145 
	gm™
 = 
šfoM­
.
begš
(); m™ !ğšfoM­.
’d
(); mit++)

147 
	güÁ_šfo
 = 
m™
->
£cÚd
;

148 
d–‘e
 
	güÁ_šfo
;

150 
	gšfoM­
.
ş—r
();

155 
	gCËª”
::
ş—rTh»ad
(
veùÜ
<
¡d
::
th»ad
*> &
thrds
)

157 
veùÜ
<
¡d
::
th»ad
*>::
™”©Ü
 
™
;

158 
	g¡d
::
th»ad
* 
thrd
;

159 
	g™
 = 
thrds
.
begš
(); iˆ!ğthrds.
’d
(); it++)

161 
	gthrd
 = *
™
;

162 
d–‘e
 
	gthrd
;

164 
	gthrds
.
ş—r
();

166 
	gCËª”
::
ş—rClu¡
(
m­
<, 
£t
<> *> &
şu¡
)

168 autØ
	g™
 = 
şu¡
.
begš
(); iˆ!ğşu¡.
’d
(); it++)

170 
	g™
->
	g£cÚd
->
ş—r
();

172 
	gşu¡
.
ş—r
();

176 
	gCËª”
::
ş—rM­
(
m­
<, 
¡ršg
> &
is
)

178 
	gm­
<, 
	g¡ršg
>::
™”©Ü
 
™
;

180 
	g™
 = 
is
.
begš
(); iˆ!ğis.
’d
(); it++)

182 (
	g™
->
	g£cÚd
).
ş—r
();

184 
	gis
.
ş—r
();

187 
	gCËª”
::
ş—rM­
(
m­
<
¡ršg
, sŒšg> &
is
)

189 
	gm­
<
	g¡ršg
, sŒšg>::
™”©Ü
 
™
;

190 
¡ršg
 
	gkey
;

191 
	g™
 = 
is
.
begš
(); iˆ!ğis.
’d
(); it++)

193 
	gkey
 = 
™
->
fœ¡
;

194 
	gkey
.
ş—r
();

195 (
	g™
->
	g£cÚd
).
ş—r
();

197 
	gis
.
ş—r
();

200 
	gCËª”
::
ş—rM­
(
m­
<
¡ršg
, > &
is
)

202 
	gm­
<
	g¡ršg
, >::
™”©Ü
 
™
;

203 
¡ršg
 
	gkey
;

204 
	g™
 = 
is
.
begš
(); iˆ!ğis.
’d
(); it++)

206 
	gkey
 = 
™
->
fœ¡
;

207 
	gkey
.
ş—r
();

209 
	gis
.
ş—r
();

	@/home/pclin/cpp/gkmeans/cleaner.h

1 #iâdeà
CLEANER_H


2 
	#CLEANER_H


	)

4 
	~"şsšfo.h
"

5 
	~"Â™em.h
"

8 
	~<veùÜ
>

9 
	~<th»ad
>

10 
	~<li¡
>

11 
	~<m­
>

12 
	~<£t
>

24 
usšg
 
Çme¥aû
 
	g¡d
;

26 şas 
	cCËª”


30 
	mpublic
:

32 
ş—rNNLi¡
(
li¡
<
NNI‹m
*> &
ÂI‹ms
);

33 
ş—rNNLi¡
(
li¡
<
MšiNN
*> &
ÂI‹ms
);

35 
ş—rM©rix
(
veùÜ
<veùÜ<> > &
m©rix
);

37 
ş—r_k2iM­
(
m­
<
¡ršg
, > &
»fTab
);

38 
ş—r_k2iM­
(
m­
<
¡ršg
, > &
»fTab
);

39 
ş—r_i2kM­
(
m­
<, cÚ¡ *> &
i2kM­
);

41 
ä“I‹mM­s
(
m­
<, m­<
¡ršg
, cÚ¡ *> *> &
™mM­s
);

43 
ä“P¬aM­
(
m­
<
¡ršg
, cÚ¡ *> &
·¿s
);

44 
ä“SŒVeù
(
veùÜ
<cÚ¡ *> &
¡rVeù
);

45 
ş—rTh»ad
(
veùÜ
<
¡d
::
th»ad
*> &
thrds
);

47 
ş—rClu¡
(
m­
<, 
£t
<> *> &
şu¡
);

49 
boŞ
 
ş—rVeùÜ
(
veùÜ
<
NNI‹m
*> &
veùs
);

50 
ş—rInfoM­
(
m­
<, 
CLSInfo
*> &
šfoM­
);

52 
ş—rM­
(
m­
<, 
¡ršg
> &
is
);

53 
ş—rM­
(
m­
<
¡ršg
, sŒšg> &
ss
);

54 
ş—rM­
(
m­
<
¡ršg
, > &
si
);

	@/home/pclin/cpp/gkmeans/clsinfo.h

1 #iâdeà
CLSINDEX_H


2 
	#CLSINDEX_H


	)

4 
	~<veùÜ
>

6 
usšg
 
	g¡d
::
veùÜ
;

8 
	sCLSInfo


10 
	mpublic
:

11 
CLSInfo
()

13 
n
 = 0;

14 
	mE
 = 0.0;

16 
	mn
;

17 
	mE
;

20 
	gCLD©a
 : 
public
 
CLSInfo


22 
veùÜ
<> 
şu¡D©aId
;

	@/home/pclin/cpp/gkmeans/dataconvert.h

	@/home/pclin/cpp/gkmeans/distance.hpp

1 #iâdeà
EFANNA_DISTANCE_H_


2 
	#EFANNA_DISTANCE_H_


	)

3 
	~<¡dlib.h
>

4 
	~<veùÜ
>

5 
	~<£t
>

6 
	~<x86šŒš.h
>

7 
	~<cm©h
>

8 
	~<io¡»am
>

10 #ifdeà
__GNUC__


11 #ifdeà
__AVX__


12 
	#KGRAPH_MATRIX_ALIGN
 32

	)

14 #ifdeà
__SSE2__


15 
	#KGRAPH_MATRIX_ALIGN
 16

	)

17 
	#KGRAPH_MATRIX_ALIGN
 4

	)

24 
Çme¥aû
 
	gDISTANCE


27 
	g‹m¶©e
<
ty³Çme
 
	gT
>

28 
	sCªdid©e


30 
size_t
 
	grow_id
;

31 
T
 
	gdi¡ªû
;

32 
Cªdid©e
(cÚ¡ 
size_t
 
row_id
, cÚ¡ 
T
 
di¡ªû
):„ow_id(row_id), distance(distance) { }

34 
boŞ
 
	gİ”©Ü
 >(cÚ¡ 
	gCªdid©e
& 
	grhs
) const

36 ià(
	gthis
->
	gdi¡ªû
 =ğ
rhs
.
di¡ªû
)

38  
this
->
row_id
 > 
rhs
.row_id;

40  
	gthis
->
	gdi¡ªû
 > 
	grhs
.distance;

42 
boŞ
 
	gİ”©Ü
 <(cÚ¡ 
	gCªdid©e
& 
	grhs
) const

44 ià(
	gthis
->
	gdi¡ªû
 =ğ
rhs
.
di¡ªû
)

46  
this
->
row_id
 < 
rhs
.row_id;

48  
	gthis
->
	gdi¡ªû
 < 
	grhs
.distance;

52 
	g‹m¶©e
<
ty³Çme
 
	gT
>

53 şas 
	cDi¡ªû


55 
	gpublic
:

56 
vœtu®
 
T
 
com·»
(cÚ¡ T* 
a
, cÚ¡ T* 
b
, 
size_t
 
Ëngth
) const = 0;

57 
vœtu®
 
T
 
nÜm
(cÚ¡ T* 
a
, 
size_t
 
Ëngth
) const = 0;

58 
vœtu®
 
T
 
dÙ
(cÚ¡ T* 
a
, cÚ¡ T* 
b
, 
size_t
 
Ëngth
) const = 0;

59 
	gvœtu®
 ~
Di¡ªû
() {}

62 
	#SSE_L2SQR
(
addr1
, 
addr2
, 
de¡
, 
tmp1
, 
tmp2
) \

63 
tmp1
 = 
	`_mm_lßd_ps
(
addr1
);\

64 
tmp2
 = 
	`_mm_lßd_ps
(
addr2
);\

65 
tmp1
 = 
	`_mm_sub_ps
Ñmp1, 
tmp2
); \

66 
tmp1
 = 
	`_mm_mul_ps
(tmp1,mp1); \

67 
de¡
 = 
	`_mm_add_ps
(de¡, 
tmp1
);

	)

70 
	g‹m¶©e
<
ty³Çme
 
	gT
>

71 
şass
 
	gL2Di¡ªûSSE
: 
public
 
Di¡ªû
<
T
>

73 
public
:

74 
T
 
	tResuÉTy³
;

79 
ResuÉTy³
 
com·»
(cÚ¡ 
T
* 
a
, cÚ¡ T* 
b
, 
size_t
 
size
) const

82 
__m128
 
	gsum
;

83 
__m128
 
	gl0
, 
	gl1
, 
	gl2
, 
	gl3
;

84 
__m128
 
	gr0
, 
	gr1
, 
	gr2
, 
	gr3
;

85 
	gD
 = (
size
 + 3) & ~3U;

86 
	gDR
 = 
D
 % 16;

87 
	gDD
 = 
D
 - 
DR
;

88 cÚ¡ *
	gl
 = 
a
;

89 cÚ¡ *
	gr
 = 
b
;

90 cÚ¡ *
	ge_l
 = 
l
 + 
DD
;

91 cÚ¡ *
	ge_r
 = 
r
 + 
DD
;

92 
	guÅack
[4] 
__©Œibu‹__
 ((
®igÃd
 (16))) = {0, 0, 0, 0};

93 
ResuÉTy³
 
	g»t
 = 0.0;

94 
	gsum
 = 
_mm_lßd_ps
(
uÅack
);

95 
	gDR
)

98 
SSE_L2SQR
(
e_l
+8, 
e_r
+8, 
sum
, 
l2
, 
r2
);

100 
SSE_L2SQR
(
e_l
+4, 
e_r
+4, 
sum
, 
l1
, 
r1
);

102 
SSE_L2SQR
(
e_l
, 
e_r
, 
sum
, 
l0
, 
r0
);

104 
	gi
 = 0; i < 
	gDD
; i +ğ16, 
	gl
 +ğ16, 
	gr
 += 16)

106 
SSE_L2SQR
(
l
, 
r
, 
sum
, 
l0
, 
r0
);

107 
SSE_L2SQR
(
l
 + 4, 
r
 + 4, 
sum
, 
l1
, 
r1
);

108 
SSE_L2SQR
(
l
 + 8, 
r
 + 8, 
sum
, 
l2
, 
r2
);

109 
SSE_L2SQR
(
l
 + 12, 
r
 + 12, 
sum
, 
l3
, 
r3
);

111 
_mm_¡Üeu_ps
(
uÅack
, 
sum
);

112 
	g»t
 = 
uÅack
[0] + unpack[1] + unpack[2] + unpack[3];

113  
	g»t
;

116 
T
 
nÜm
(cÚ¡ T* 
a
, 
size_t
 
Ëngth
) const

120 
T
 
dÙ
(cÚ¡ T* 
a
, cÚ¡ T* 
b
, 
size_t
 
Ëngth
) const

128 
	g‹m¶©e
<
ty³Çme
 
	gT
>

129 
şass
 
	gL2Di¡ªû
: 
public
 
Di¡ªû
<
T
>

131 
public
:

132 
T
 
	tResuÉTy³
;

136 
ResuÉTy³
 
com·»
(cÚ¡ 
T
* 
a
, cÚ¡ T* 
b
, 
size_t
 
size
) const

138 
ResuÉTy³
 
	g»suÉ
 = ResultType();

139 
ResuÉTy³
 
	gdiff0
 = 0;

140 
	g»suÉ
 = 0;

141 
	gi
 = 0;

142 
	gi
 = 0; i < 
	gsize
; i++)

144 
	gdiff0
 = (
ResuÉTy³
)(
a
[
i
] - 
b
[i]);

145 
	g»suÉ
 +ğ
diff0
 * diff0;

147  
	g»suÉ
;

149 
T
 
nÜm
(cÚ¡ T* 
a
, 
size_t
 
Ëngth
) const

152 
ResuÉTy³
 
	g»suÉ
 = ResultType();

153 
	gi
 = 0;

154 
	gi
 = 0; i < 
	gËngth
; i++)

156 
	g»suÉ
 +ğ(
ResuÉTy³
)(
a
[
i
]*a[i]);

159  
	g»suÉ
;

161 
T
 
dÙ
(cÚ¡ T* 
a
, cÚ¡ T* 
b
, 
size_t
 
Ëngth
) const

163 
ResuÉTy³
 
	g»suÉ
 = ResultType();

164 
ResuÉTy³
 
	gdÙ0
, 
	gdÙ1
, 
	gdÙ2
, 
	gdÙ3
;

165 
	gi
 = 0;

166 
	gi
 = 0; i < 
	gËngth
; i++)

168 
	g»suÉ
 +ğ
a
[
i
]*
b
[i];

171  
	g»suÉ
;

175 
	g‹m¶©e
<
ty³Çme
 
	gT
>

176 
şass
 
	gFa¡L2Di¡ªû
: 
public
 
Di¡ªû
<
T
>

178 
public
:

179 
T
 
	tResuÉTy³
;

184 
ResuÉTy³
 
com·»
(cÚ¡ 
T
* 
a
, cÚ¡ T* 
b
, 
size_t
 
size
) const

186 
ResuÉTy³
 
	g»suÉ
 = ResultType();

187 
ResuÉTy³
 
	gdiff0
, 
	gdiff1
, 
	gdiff2
, 
	gdiff3
;

188 cÚ¡ 
T
* 
	gÏ¡
 = 
a
 + 
size
;

189 cÚ¡ 
T
* 
	gÏ¡group
 = 
Ï¡
 - 3;

192 
	ga
 < 
	gÏ¡group
)

194 
	gdiff0
 = (
ResuÉTy³
)(
a
[0] - 
b
[0]);

195 
	gdiff1
 = (
ResuÉTy³
)(
a
[1] - 
b
[1]);

196 
	gdiff2
 = (
ResuÉTy³
)(
a
[2] - 
b
[2]);

197 
	gdiff3
 = (
ResuÉTy³
)(
a
[3] - 
b
[3]);

198 
	g»suÉ
 +ğ
diff0
 * diff0 + 
diff1
 * diff1 + 
diff2
 * diff2 + 
diff3
 * diff3;

199 
	ga
 += 4;

200 
	gb
 += 4;

203 
	ga
 < 
	gÏ¡
)

205 
	gdiff0
 = (
ResuÉTy³
)(*
a
++ - *
b
++);

206 
	g»suÉ
 +ğ
diff0
 * diff0;

208  
	g»suÉ
;

210 
T
 
nÜm
(cÚ¡ T* 
a
, 
size_t
 
size
) const

212 
T
 
	g»suÉ
 = 
ResuÉTy³
();;

213 cÚ¡ 
T
* 
	gÏ¡
 = 
a
 + 
size
;

214 cÚ¡ 
T
* 
	gÏ¡group
 = 
Ï¡
 - 3;

217 
	ga
 < 
	gÏ¡group
)

219 
	g»suÉ
 +ğ
a
[0] *‡[0] +‡[1] *‡[1] +‡[2] *‡[2] +‡[3] *‡[3];

220 
	ga
 += 4;

223 
	ga
 < 
	gÏ¡
)

225 
	g»suÉ
 +ğ*
a
 * (*a);

226 
	ga
++;

228  
	g»suÉ
;

230 
T
 
dÙ
(cÚ¡ T* 
a
, cÚ¡ T* 
b
, 
size_t
 
size
) const

232 
T
 
	g»suÉ
 = 
ResuÉTy³
();;

233 cÚ¡ 
T
* 
	gÏ¡
 = 
a
 + 
size
;

234 cÚ¡ 
T
* 
	gÏ¡group
 = 
Ï¡
 - 3;

237 
	ga
 < 
	gÏ¡group
)

239 
	g»suÉ
 +ğ
a
[0] * 
b
[0] +‡[1] * b[1] +‡[2] * b[2] +‡[3] * b[3];

240 
	ga
 += 4;

241 
	gb
 += 4;

244 
	ga
 < 
	gÏ¡
)

246 
	g»suÉ
 +ğ(*
a
++è* (*
b
++);

248  
	g»suÉ
;

252 
	g‹m¶©e
<
ty³Çme
 
	gT
>

253 
şass
 
	gL2Di¡ªûAVXr4
: 
public
 
Di¡ªû
<
T
>

255 
public
:

256 
T
 
	tResuÉTy³
;

261 
	#AVX_L2SQR
(
addr1
, 
addr2
, 
de¡
, 
tmp1
, 
tmp2
) \

262 
tmp1
 = 
	`_mm256_lßdu_ps
(
addr1
);\

263 
tmp2
 = 
	`_mm256_lßdu_ps
(
addr2
);\

264 
tmp1
 = 
	`_mm256_sub_ps
Ñmp1, 
tmp2
); \

265 
tmp1
 = 
	`_mm256_mul_ps
(tmp1,mp1); \

266 
de¡
 = 
	`_mm256_add_ps
(de¡, 
tmp1
);

	)

267 
ResuÉTy³
 
com·»
(cÚ¡ 
T
* 
a
, cÚ¡ T* 
b
, 
size_t
 
size
) const

293 
__m256
 
	gsum
;

294 
__m256
 
	gl0
, 
	gl1
, 
	gl2
, 
	gl3
;

295 
__m256
 
	gr0
, 
	gr1
, 
	gr2
, 
	gr3
;

296 
	gD
 = (
size
 + 7) & ~7U;

297 
	gDR
 = 
D
 % 32;

298 
	gDD
 = 
D
 - 
DR
;

299 cÚ¡ *
	gl
 = 
a
;

300 cÚ¡ *
	gr
 = 
b
;

301 cÚ¡ *
	ge_l
 = 
l
 + 
DD
;

302 cÚ¡ *
	ge_r
 = 
r
 + 
DD
;

303 
	guÅack
[8] 
__©Œibu‹__
 ((
®igÃd
 (32))) = {0, 0, 0, 0, 0, 0, 0, 0};

304 
ResuÉTy³
 
	g»t
 = 0.0;

305 
	gsum
 = 
_mm256_lßdu_ps
(
uÅack
);

306 
	gDR
)

309 
AVX_L2SQR
(
e_l
+16, 
e_r
+16, 
sum
, 
l2
, 
r2
);

311 
AVX_L2SQR
(
e_l
+8, 
e_r
+8, 
sum
, 
l1
, 
r1
);

313 
AVX_L2SQR
(
e_l
, 
e_r
, 
sum
, 
l0
, 
r0
);

315 
	gi
 = 0; i < 
	gDD
; i +ğ32, 
	gl
 +ğ32, 
	gr
 += 32)

317 
AVX_L2SQR
(
l
, 
r
, 
sum
, 
l0
, 
r0
);

318 
AVX_L2SQR
(
l
 + 8, 
r
 + 8, 
sum
, 
l1
, 
r1
);

319 
AVX_L2SQR
(
l
 + 16, 
r
 + 16, 
sum
, 
l2
, 
r2
);

320 
AVX_L2SQR
(
l
 + 24, 
r
 + 24, 
sum
, 
l3
, 
r3
);

322 
_mm256_¡Üeu_ps
(
uÅack
, 
sum
);

323 
	g»t
 = 
uÅack
[0] + unpack[1] + unpack[2] + unpack[3] + unpack[4] + unpack[5] + unpack[6] + unpack[7];

324  
	g»t
;

326 
	#AVX_L2NORM
(
addr
, 
de¡
, 
tmp
) \

327 
tmp
 = 
	`_mm256_lßdu_ps
(
addr
); \

328 
tmp
 = 
	`_mm256_mul_ps
(tmp,mp); \

329 
de¡
 = 
	`_mm256_add_ps
(de¡, 
tmp
);

	)

330 
T
 
nÜm
(cÚ¡ T* 
a
, 
size_t
 
size
) const

332 
__m256
 
	gsum
;

333 
__m256
 
	gl0
, 
	gl1
;

334 
	gD
 = (
size
 + 7) & ~7U;

335 
	gDR
 = 
D
 % 16;

336 
	gDD
 = 
D
 - 
DR
;

337 cÚ¡ *
	gl
 = 
a
;

338 cÚ¡ *
	ge_l
 = 
l
 + 
DD
;

339 
	guÅack
[8] 
__©Œibu‹__
 ((
®igÃd
 (32))) = {0, 0, 0, 0, 0, 0, 0, 0};

340 
ResuÉTy³
 
	g»t
 = 0.0;

341 
	gsum
 = 
_mm256_lßdu_ps
(
uÅack
);

342 if(
	gDR
)

344 
AVX_L2NORM
(
e_l
, 
sum
, 
l0
);

346 
	gi
 = 0; i < 
	gDD
; i +ğ16, 
	gl
 += 16)

348 
AVX_L2NORM
(
l
, 
sum
, 
l0
);

349 
AVX_L2NORM
(
l
 + 8, 
sum
, 
l1
);

351 
_mm256_¡Üeu_ps
(
uÅack
, 
sum
);

352 
	g»t
 = 
uÅack
[0] + unpack[1] + unpack[2] + unpack[3] + unpack[4] + unpack[5] + unpack[6] + unpack[7];

353  
	g»t
;

355 
	#AVX_L2DOT
(
addr1
, 
addr2
, 
de¡
, 
tmp1
, 
tmp2
) \

356 
tmp1
 = 
	`_mm256_lßdu_ps
(
addr1
);\

357 
tmp2
 = 
	`_mm256_lßdu_ps
(
addr2
);\

358 
tmp1
 = 
	`_mm256_mul_ps
Ñmp1, 
tmp2
); \

359 
de¡
 = 
	`_mm256_add_ps
(de¡, 
tmp1
);

	)

360 
T
 
dÙ
(cÚ¡ T* 
a
, cÚ¡ T* 
b
, 
size_t
 
size
) const

362 
__m256
 
	gsum
;

363 
__m256
 
	gl0
, 
	gl1
;

364 
__m256
 
	gr0
, 
	gr1
;

365 
	gD
 = (
size
 + 7) & ~7U;

366 
	gDR
 = 
D
 % 16;

367 
	gDD
 = 
D
 - 
DR
;

368 cÚ¡ *
	gl
 = 
a
;

369 cÚ¡ *
	gr
 = 
b
;

370 cÚ¡ *
	ge_l
 = 
l
 + 
DD
;

371 cÚ¡ *
	ge_r
 = 
r
 + 
DD
;

372 
	guÅack
[8] 
__©Œibu‹__
 ((
®igÃd
 (32))) = {0, 0, 0, 0, 0, 0, 0, 0};

373 
ResuÉTy³
 
	g»t
 = 0.0;

374 
	gsum
 = 
_mm256_lßdu_ps
(
uÅack
);

375 if(
	gDR
)

377 
AVX_L2DOT
(
e_l
, 
e_r
, 
sum
, 
l0
, 
r0
);

380 
	gi
 = 0; i < 
	gDD
; i +ğ16, 
	gl
 +ğ16, 
	gr
 += 16)

382 
AVX_L2DOT
(
l
, 
r
, 
sum
, 
l0
, 
r0
);

383 
AVX_L2DOT
(
l
 + 8, 
r
 + 8, 
sum
, 
l1
, 
r1
);

385 
_mm256_¡Üeu_ps
(
uÅack
, 
sum
);

386 
	g»t
 = 
uÅack
[0] + unpack[1] + unpack[2] + unpack[3] + unpack[4] + unpack[5] + unpack[6] + unpack[7];

387  
	g»t
;

391 
	g‹m¶©e
<
ty³Çme
 
	gT
>

392 
şass
 
	gL2Di¡ªûAVX
: 
public
 
Di¡ªû
<
T
>

394 
public
:

395 
T
 
	tResuÉTy³
;

400 
	#AVX_L2SQR
(
addr1
, 
addr2
, 
de¡
, 
tmp1
, 
tmp2
) \

401 
tmp1
 = 
	`_mm256_lßdu_ps
(
addr1
);\

402 
tmp2
 = 
	`_mm256_lßdu_ps
(
addr2
);\

403 
tmp1
 = 
	`_mm256_sub_ps
Ñmp1, 
tmp2
); \

404 
tmp1
 = 
	`_mm256_mul_ps
(tmp1,mp1); \

405 
de¡
 = 
	`_mm256_add_ps
(de¡, 
tmp1
);

	)

406 
ResuÉTy³
 
com·»
(cÚ¡ 
T
* 
a
, cÚ¡ T* 
b
, 
size_t
 
size
) const

409 
__m256
 
	gsum
;

410 
__m256
 
	gl0
, 
	gl1
;

411 
__m256
 
	gr0
, 
	gr1
;

412 
	gD
 = (
size
 + 7) & ~7U;

413 
	gDR
 = 
D
 % 32;

414 
	gDD
 = 
D
 - 
DR
;

415 cÚ¡ *
	gl
 = 
a
;

416 cÚ¡ *
	gr
 = 
b
;

417 cÚ¡ *
	ge_l
 = 
l
 + 
DD
;

418 cÚ¡ *
	ge_r
 = 
r
 + 
DD
;

419 
	guÅack
[8] 
__©Œibu‹__
 ((
®igÃd
 (32))) = {0, 0, 0, 0, 0, 0, 0, 0};

420 
ResuÉTy³
 
	g»t
 = 0.0;

421 
	gsum
 = 
_mm256_lßdu_ps
(
uÅack
);

422 if(
	gDR
)

424 
AVX_L2SQR
(
e_l
, 
e_r
, 
sum
, 
l0
, 
r0
);

427 
	gi
 = 0; i < 
	gDD
; i +ğ16, 
	gl
 +ğ16, 
	gr
 += 16)

429 
AVX_L2SQR
(
l
, 
r
, 
sum
, 
l0
, 
r0
);

430 
AVX_L2SQR
(
l
 + 8, 
r
 + 8, 
sum
, 
l1
, 
r1
);

432 
_mm256_¡Üeu_ps
(
uÅack
, 
sum
);

433 
	g»t
 = 
uÅack
[0] + unpack[1] + unpack[2] + unpack[3] + unpack[4] + unpack[5] + unpack[6] + unpack[7];

434  
	g»t
;

436 
	#AVX_L2NORM
(
addr
, 
de¡
, 
tmp
) \

437 
tmp
 = 
	`_mm256_lßdu_ps
(
addr
); \

438 
tmp
 = 
	`_mm256_mul_ps
(tmp,mp); \

439 
de¡
 = 
	`_mm256_add_ps
(de¡, 
tmp
);

	)

440 
T
 
nÜm
(cÚ¡ T* 
a
, 
size_t
 
size
) const

442 
__m256
 
	gsum
;

443 
__m256
 
	gl0
, 
	gl1
;

444 
	gD
 = (
size
 + 7) & ~7U;

445 
	gDR
 = 
D
 % 16;

446 
	gDD
 = 
D
 - 
DR
;

447 cÚ¡ *
	gl
 = 
a
;

448 cÚ¡ *
	ge_l
 = 
l
 + 
DD
;

449 
	guÅack
[8] 
__©Œibu‹__
 ((
®igÃd
 (32))) = {0, 0, 0, 0, 0, 0, 0, 0};

450 
ResuÉTy³
 
	g»t
 = 0.0;

451 
	gsum
 = 
_mm256_lßdu_ps
(
uÅack
);

452 if(
	gDR
)

454 
AVX_L2NORM
(
e_l
, 
sum
, 
l0
);

456 
	gi
 = 0; i < 
	gDD
; i +ğ16, 
	gl
 += 16)

458 
AVX_L2NORM
(
l
, 
sum
, 
l0
);

459 
AVX_L2NORM
(
l
 + 8, 
sum
, 
l1
);

461 
_mm256_¡Üeu_ps
(
uÅack
, 
sum
);

462 
	g»t
 = 
uÅack
[0] + unpack[1] + unpack[2] + unpack[3] + unpack[4] + unpack[5] + unpack[6] + unpack[7];

463  
	g»t
;

465 
	#AVX_L2DOT
(
addr1
, 
addr2
, 
de¡
, 
tmp1
, 
tmp2
) \

466 
tmp1
 = 
	`_mm256_lßdu_ps
(
addr1
);\

467 
tmp2
 = 
	`_mm256_lßdu_ps
(
addr2
);\

468 
tmp1
 = 
	`_mm256_mul_ps
Ñmp1, 
tmp2
); \

469 
de¡
 = 
	`_mm256_add_ps
(de¡, 
tmp1
);

	)

470 
T
 
dÙ
(cÚ¡ T* 
a
, cÚ¡ T* 
b
, 
size_t
 
size
) const

472 
__m256
 
	gsum
;

473 
__m256
 
	gl0
, 
	gl1
;

474 
__m256
 
	gr0
, 
	gr1
;

475 
	gD
 = (
size
 + 7) & ~7U;

476 
	gDR
 = 
D
 % 16;

477 
	gDD
 = 
D
 - 
DR
;

478 cÚ¡ *
	gl
 = 
a
;

479 cÚ¡ *
	gr
 = 
b
;

480 cÚ¡ *
	ge_l
 = 
l
 + 
DD
;

481 cÚ¡ *
	ge_r
 = 
r
 + 
DD
;

482 
	guÅack
[8] 
__©Œibu‹__
 ((
®igÃd
 (32))) = {0, 0, 0, 0, 0, 0, 0, 0};

483 
ResuÉTy³
 
	g»t
 = 0.0;

484 
	gsum
 = 
_mm256_lßdu_ps
(
uÅack
);

485 if(
	gDR
)

487 
AVX_L2DOT
(
e_l
, 
e_r
, 
sum
, 
l0
, 
r0
);

490 
	gi
 = 0; i < 
	gDD
; i +ğ16, 
	gl
 +ğ16, 
	gr
 += 16)

492 
AVX_L2DOT
(
l
, 
r
, 
sum
, 
l0
, 
r0
);

493 
AVX_L2DOT
(
l
 + 8, 
r
 + 8, 
sum
, 
l1
, 
r1
);

495 
_mm256_¡Üeu_ps
(
uÅack
, 
sum
);

496 
	g»t
 = 
uÅack
[0] + unpack[1] + unpack[2] + unpack[3] + unpack[4] + unpack[5] + unpack[6] + unpack[7];

497  
	g»t
;

	@/home/pclin/cpp/gkmeans/evaluator.cpp

1 
	~"ev®u©Ü.h
"

2 
	~"ş—Ãr.h
"

3 
	~"pqm©h.h
"

4 
	~"ißg’t.h
"

5 
	~"v¡ršg.h
"

7 
	~<io¡»am
>

8 
	~<f¡»am
>

9 
	~<iomª
>

10 
	~<c¡dlib
>

11 
	~<c¡ršg
>

12 
	~<cm©h
>

13 
	~<lim™s
>

16 
usšg
 
Çme¥aû
 
	g¡d
;

18 
	gEv®u©Ü
::
	$di¡ÜtiÚ
(cÚ¡ * 
¤câ
, cÚ¡ * 
şu¡”â
)

20 *
d©a
;

21 
row
, 
cŞ
;

22 if(
VSŒšg
::
	`’dW™h
(
¤câ
, ".txt"))

24 
d©a
 = 
IOAg’t
::
	`lßdM©rix
(
¤câ
, 
row
, 
cŞ
);

26 if(
VSŒšg
::
	`’dW™h
(
¤câ
, ".fvecs"))

28 
d©a
 = 
IOAg’t
::
	`lßd_fvecs
(
¤câ
, 
cŞ
, 
row
);

30 if(
VSŒšg
::
	`’dW™h
(
¤câ
, ".mat"))

32 
d©a
 = 
IOAg’t
::
	`lßdD©
(
¤câ
, 
row
, 
cŞ
);

34 if(
VSŒšg
::
	`’dW™h
(
¤câ
, ".itm"))

36 
d©a
 = 
IOAg’t
::
	`lßdItms
(
¤câ
, "fsvb", 
row
, 
cŞ
);

40 
cout
<<"Unrecognizable input file format!!!\n";

41 
d©a
 = 
NULL
;

42 
	`ex™
(0);

45 
m­
<, 
£t
<> *> 
şu¡”s
;

46 
’
;

47 
i
, 
j
, 
k
;

48 
’
 = 0;

50 
i
 = 0; i < 
row
; i++)

52 
j
 = 0; j < 
cŞ
; j++)

53 
’
 +ğ
d©a
[
i
*
cŞ
+
j
]*data[i*col+j];

55 
Ev®u©Ü
::
	`lßdClu¡
(
şu¡”â
, 
şu¡”s
);

56 
İt
;

57 
şnumb
 = 
şu¡”s
.
	`size
();

58 *
Ds
 = 
Ãw
 [
şnumb
*
cŞ
];

59 
	`mem£t
(
Ds
, 0, ()*
şnumb
*
cŞ
);

60 
İt
 = 0;

62 
i
 = 0; i < 
şu¡”s
.
	`size
(); i++)

64 autØ
™
 = 
şu¡”s
[
i
]->
	`begš
(); iˆ!ğşu¡”s[i]->
	`’d
(); it++)

66 
k
 = 0; k < 
cŞ
; k++)

68 
Ds
[
i
*
cŞ
+
k
] +ğ
d©a
[(*
™
)*col+k];

72 
i
 = 0; i < 
şu¡”s
.
	`size
(); i++)

74 
j
 = 0; j < 
cŞ
; j++)

76 if(
şu¡”s
[
i
]->
	`size
() != 0)

77 
İt
 +ğ
Ds
[
i
*
cŞ
+
j
]*Ds[i*cŞ+j]/
şu¡”s
[i]->
	`size
();

80 
di¡ÜtiÚ
;

81 
di¡ÜtiÚ
 = 
’
 - 
İt
;

82 
di¡ÜtiÚ
 /ğ
row
;

83 
cout
<<"’ "<<
’
<<" o± "<<
İt
<<" di¡ÜtiÚ "<<
di¡ÜtiÚ
<<
’dl
;

84 
d–‘e
 [] 
Ds
;

85 
d–‘e
 [] 
d©a
;

86 
CËª”
::
	`ş—rClu¡
(
şu¡”s
);

87  
di¡ÜtiÚ
;

88 
	}
}

90 
	gEv®u©Ü
::
jacÿrd
(
m­
<, 
£t
<> *> &
şu¡
, m­<, s‘<> *> &
grdTrh
, cÚ¡ *
â
)

92 
	gm
 = 0, 
	gn
 = 0, 
	gi
 = 0, 
	gj
 = 0;

93 
	gm
 = 
şu¡
.
size
();

94 
	gn
 = 
grdTrh
.
size
();

96 *
	gv®
 = 
Ãw
 [
m
*
n
];

98 
mem£t
(
v®
, 0, ()*
m
*
n
);

100 
	gtmp
;

101 
	gveùÜ
<> 
š‹r£t
(
num”ic_lim™s
<>::
max
());

103 
	gi
 = 0; i < 
	gm
; i++)

105 
	gj
 = 0; j < 
	gn
; j++)

107 if(
	gşu¡
[
i
+1]->
size
() != 0)

109 autØ
™
 = 
¡d
::
£t_š‹r£ùiÚ
(
şu¡
[
i
+1]->
begš
(), clu¡[i+1]->
’d
(), 
grdTrh
[
j
+1]->begš(), grdTrh[j+1]->’d(),
š‹r£t
.begin());

110 
	gtmp
 = 
™
 - 
š‹r£t
.
begš
();

111 
	gtmp
 = 
tmp
/
grdTrh
[
j
+1]->
size
();

114 
	gtmp
 = 0;

115 
	gv®
[
i
*
n
+
j
] = 
tmp
;

118 
of¡»am
 
os
(
â
);

120 if(!
	gos
.
is_İ’
())

122 
	gcout
<<"ÿÀnÙ o³Àf"<<
	gâ
<<" for jaccard„esult\n";

123 
ex™
(0);

126 
	gos
<<"\t";

127 
	gi
 = 0; i < 
	gn
; i++)

129 
	gos
<<
£tw
(9)<<
	ggrdTrh
[
i
+1]->
size
()<<"\t";

131 
	gos
<<"\n";

132 
	gi
 = 0; i < 
	gm
; i++)

134 
	gos
<<
	gşu¡
[
i
+1]->
size
()<<"\t";

135 
	gj
 = 0; j < 
	gn
; j++)

137 
	gos
<<
£tw
(9)<<
	gv®
[
i
*
n
+
j
]<<"\t";

139 
	gos
<<
	g’dl
;

142 
	gos
.
şo£
();

144 
	gd–‘e
 [] 
	gv®
;

147 
	gEv®u©Ü
::
	$jacÿrd
(cÚ¡ *
£tâ
, cÚ¡ * 
grdâ
, cÚ¡ *
d¡â
)

149 
m­
<, 
£t
<> *> 
şu¡
, 
grdTrh
;

151 
IOAg’t
::
	`lßdClu¡
(
£tâ
, 
şu¡
);

152 
IOAg’t
::
	`lßdClu¡
(
grdâ
, 
grdTrh
);

154 
Ev®u©Ü
::
	`jacÿrd
(
şu¡
, 
grdTrh
, 
d¡â
);

156 
CËª”
::
	`ş—rClu¡
(
şu¡
);

157 
CËª”
::
	`ş—rClu¡
(
grdTrh
);

158 
	}
}

160 
	gEv®u©Ü
::
lßdClu¡
(cÚ¡ *
¤cFn
, 
m­
<, 
£t
<> *> &
şu¡s
)

162 
¡ršg
 
	gtmp
;

163 
	gveùÜ
<
	g¡ršg
> 
	gşu¡
;

164 
	g£t
<
	g¡ršg
> 
	g‹mp
;

165 
	g£t
<
	g¡ršg
>::
™”©Ü
 
™
;

166 
	gm­
<
	g¡ršg
, > 
	gmp
;

167 
	gi
;

169 if(
	gşu¡s
.
size
())

171 
	gcout
<<"ş—¸şu¡ *******"<<
	g’dl
;

172 
	gCËª”
::
ş—rClu¡
(
şu¡s
);

175 
if¡»am
 
šSŒ
(
¤cFn
);

177 if(!
	gšSŒ
.
is_İ’
())

179 
	gcout
<<"Ev®u©Ü::lßdClu¡ o³Àf"<<
	g¤cFn
<<" fa"<<
	g’dl
;

180 
ex™
(0);

182 
	gšSŒ
>>
	gtmp
)

184 
	gşu¡
.
push_back
(
tmp
);

187 
	gšSŒ
.
şo£
();

190 
	gs
 = 
şu¡
.
size
();

191 
	gi
 = 0; i < 
	gs
; i++)

193 
	g‹mp
.
š£¹
(
şu¡
[
i
]);

196 
	gi
 = 0;

197 
	g™
 = 
‹mp
.
begš
(); iˆ!ğ‹mp.
’d
(); it++)

199 
	g£t
<> * 
	gtmpşu¡
 = 
Ãw
 
£t
<>;

200 
	gmp
.
š£¹
(
·œ
<
¡ršg
,>(*
™
, 
i
));

201 
	gşu¡s
.
š£¹
(
·œ
<, 
£t
<> *>(
i
, 
tmpşu¡
));

202 
	gi
++;

206 
	gi
 = 0; i < 
	gs
; i++)

208 
	gşu¡s
[
mp
[
şu¡
[
i
]]]->
š£¹
(i);

211 
	gşu¡
.
ş—r
();

216 
	gEv®u©Ü
::
’Œİy
(
m­
<, 
£t
<> *> &
şu¡s
, m­<, s‘<> *> &
grdT¹h
)

218 
	gE
 = 0;

219 
	gtmpE
 = 0, 
	gtmp
 = 0;

220 
	gq
 = 
grdT¹h
.
size
();

221 
	glgq
 = 
log
(
q
);

222 *
	gÄ
 = 
Ãw
 [
q
];

223 
	gn
 = 0;

224 
	gÄs
;

225 
	gi
 = 0; i < 
	gşu¡s
.
size
(); i++)

227 
	gn
 +ğ
şu¡s
[
i
]->
size
();

229 
	gj
 = 0; j < 
	gşu¡s
.
size
(); j++)

231 
	gi
 = 0; i < 
	gq
; i++)

233 
	gÄ
[
i
] = 
Ev®u©Ü
::
š‹rSeù
(*
şu¡s
[
j
], *
grdT¹h
[i]);

235 
	gÄs
 = 
şu¡s
[
j
]->
size
();

236 
	gtmpE
 = 0;

237 
	gi
 = 0; i < 
	gq
; i++)

239 if(
	gÄ
[
i
] != 0)

241 
tmp
 = 
Ä
[
i
]/
Äs
;

242 
	gtmpE
 +ğ
tmp
*
log
(tmp);

245 
	gE
 +ğ-(
tmpE
/
lgq
)*(
Äs
/
n
);

247 
	gd–‘e
 [] 
	gÄ
;

248  
	gE
;

251 
	gEv®u©Ü
::
’Œİy
(
£t
<> &
şu¡
, 
m­
<, s‘<> *> &
grdT¹h
)

253 
	gE
 = 0;

254 
	gtmpE
 = 0, 
	gtmp
 = 0;

255 
	gq
 = 
grdT¹h
.
size
();

256 
	glgq
 = 
log
(
q
);

257 *
	gÄ
 = 
Ãw
 [
q
];

258 
	gÄs
;

260 
	gi
 = 0; i < 
	gq
; i++)

262 
	gÄ
[
i
] = 
Ev®u©Ü
::
š‹rSeù
(
şu¡
, *
grdT¹h
[i]);

264 
	gÄs
 = 
şu¡
.
size
();

265 
	gtmpE
 = 0;

266 
	gi
 = 0; i < 
	gq
; i++)

268 if(
	gÄ
[
i
] != 0)

270 
tmp
 = 
Ä
[
i
]/
Äs
;

271 
	gtmpE
 +ğ
tmp
*
log
(tmp);

274 
	gE
 = -
tmpE
/
lgq
;

275 
	gd–‘e
 [] 
	gÄ
;

276  
	gE
;

279 
	gEv®u©Ü
::
pur™y
(
m­
<, 
£t
<> *> &
şu¡s
, m­<, s‘<> *> &
grdT¹h
)

281 
	gP
 = 0;

282 
	gtmp
 = 0;

283 
	gq
 = 
grdT¹h
.
size
();

284 *
	gÄ
 = 
Ãw
 [
q
];

285 
	gn
 = 0;

286 
	gi
 = 0; i < 
	gşu¡s
.
size
(); i++)

288 
	gn
 +ğ
şu¡s
[
i
]->
size
();

290 
	gj
 = 0; j < 
	gşu¡s
.
size
(); j++)

292 
	gi
 = 0; i < 
	gq
; i++)

294 
	gÄ
[
i
] = 
Ev®u©Ü
::
š‹rSeù
(*
şu¡s
[
j
], *
grdT¹h
[i]);

296 
	gtmp
 = 0;

297 
	gi
 = 0; i < 
	gq
; i++)

299 if(
	gÄ
[
i
] > 
	gtmp
)

300 
	gtmp
 = 
Ä
[
i
];

302 
	gP
 +ğ
tmp
;

304 
	gP
 = 
P
/
n
;

305 
	gd–‘e
 [] 
	gÄ
;

306  
	gP
;

309 
	gEv®u©Ü
::
pur™y
(
£t
<> &
şu¡
, 
m­
<, s‘<> *> &
grdT¹h
)

311 
	gP
 = 0;

312 
	gtmp
 = 0;

313 
	gq
 = 
grdT¹h
.
size
();

314 
	gn
 = 
şu¡
.
size
();

315 *
	gÄ
 = 
Ãw
 [
q
];

316 
	gi
 = 0; i < 
	gq
; i++)

318 
	gÄ
[
i
] = 
Ev®u©Ü
::
š‹rSeù
(
şu¡
, *
grdT¹h
[i]);

320 
	gtmp
 = 0;

321 
	gi
 = 0; i < 
	gq
; i++)

323 if(
	gÄ
[
i
] > 
	gtmp
)

324 
	gtmp
 = 
Ä
[
i
];

327 
	gP
 = 
tmp
/
n
;

328 
	gd–‘e
 [] 
	gÄ
;

329  
	gP
;

332 
	gEv®u©Ü
::
š‹rSeù
(cÚ¡ 
£t
<> &
s1
, cÚ¡ s‘<> &
s2
)

334 
	gn
 = 0;

335 
	g£t
<>::
™”©Ü
 
™
;

336 
	g™
 = 
s1
.
begš
(); iˆ!ğs1.
’d
(); it++)

338 if(
	gs2
.
fšd
(*
™
è!ğ
s2
.
’d
())

339 
n
++;

341  
	gn
;

344 
	gEv®u©Ü
::
	$funScÜe
(cÚ¡ *
şu¡Fn
, cÚ¡ *
d©Fn
, cÚ¡ *
fun
)

346 
scÜe
 = 0;

347 *
Ds
;

348 
k
;

349 
row
;

350 
dim
;

351 *
tm²s
;

354 
m­
<, 
£t
<> *>
şu¡s
;

355 *
d©
;

356 
Ev®u©Ü
::
	`lßdClu¡
(
şu¡Fn
, 
şu¡s
);

357 
d©
 = 
IOAg’t
::
	`lßdD©
(
d©Fn
, 
row
, 
dim
);

358 
k
 = 
şu¡s
.
	`size
();

359 
tm²s
 = 
Ãw
 [
k
];

360 
Ds
 = 
Ãw
 [
k
*
dim
];

362 
i
 = 0; i < 
k
; i++)

364 
tm²s
[
i
] = 
şu¡s
[i]->
	`size
();

365 
loc
 = 
i
*
dim
;

367 
j
 = 0; j < 
dim
; j++)

369 
Ds
[
loc
 + 
j
] = 0;

371 
£t
<>::
™”©Ü
 
k
 = 
şu¡s
[
i
]->
	`begš
(); k !ğşu¡s[i]->
	`’d
(); k++)

373 
Ds
[
loc
 + 
j
] +ğ
d©
[j + (*
k
)*
dim
];

378 if(!
	`¡rcmp
(
fun
, "i2"))

380 
scÜe
 = 
PQM©h
::
	`g‘I2
(
Ds
, 
k
, 
dim
, 
tm²s
);

382 if(!
	`¡rcmp
(
fun
, "e2"))

384 
scÜe
 = 
PQM©h
::
	`g‘E2
(
Ds
, 
k
, 
dim
, 
tm²s
);

386 if(!
	`¡rcmp
(
fun
, "i1"))

388 
scÜe
 = 
PQM©h
::
	`g‘I1
(
Ds
, 
k
, 
dim
, 
tm²s
);

390 if(!
	`¡rcmp
(
fun
, "e1"))

392 
scÜe
 = 
PQM©h
::
	`g‘E1
(
Ds
, 
k
, 
dim
, 
tm²s
);

394 
d–‘e
 [] 
tm²s
;

395 
d–‘e
 [] 
Ds
;

396 
d–‘e
 [] 
d©
;

397 
CËª”
::
	`ş—rClu¡
(
şu¡s
);

398  
scÜe
;

399 
	}
}

401 
	gEv®u©Ü
::
	$’Œİy
(cÚ¡ *
¤cFn
, cÚ¡ *
grdFn
)

403 
e
;

404 
m­
<, 
£t
<> *> 
ourşu¡s
, 
grdşu¡s
;

405 
Ev®u©Ü
::
	`lßdClu¡
(
¤cFn
, 
ourşu¡s
);

406 
Ev®u©Ü
::
	`lßdClu¡
(
grdFn
, 
grdşu¡s
);

407 
e
 = 
Ev®u©Ü
::
	`’Œİy
(
ourşu¡s
, 
grdşu¡s
);

408 
CËª”
::
	`ş—rClu¡
(
ourşu¡s
);

409 
CËª”
::
	`ş—rClu¡
(
grdşu¡s
);

410  
e
;

411 
	}
}

413 
	gEv®u©Ü
::
	$pur™y
(cÚ¡ *
¤cFn
, cÚ¡ *
grdFn
)

415 
p
;

416 
m­
<, 
£t
<> *> 
ourşu¡s
, 
grdşu¡s
;

417 
Ev®u©Ü
::
	`lßdClu¡
(
¤cFn
, 
ourşu¡s
);

418 
Ev®u©Ü
::
	`lßdClu¡
(
grdFn
, 
grdşu¡s
);

419 
p
 = 
Ev®u©Ü
::
	`pur™y
(
ourşu¡s
, 
grdşu¡s
);

420 
CËª”
::
	`ş—rClu¡
(
ourşu¡s
);

421 
CËª”
::
	`ş—rClu¡
(
grdşu¡s
);

422  
p
;

423 
	}
}

425 
	gEv®u©Ü
::
	$g‘SEP
(cÚ¡ *
şu¡Fn
, cÚ¡ *
grdFn
, cÚ¡ *
d©Fn
, &
scÜe
, &
e
, &
p
, cÚ¡ *
fun
)

427 
scÜe
 = 
Ev®u©Ü
::
	`funScÜe
(
şu¡Fn
, 
d©Fn
, 
fun
);

428 
e
 = 
Ev®u©Ü
::
	`’Œİy
(
şu¡Fn
, 
grdFn
);

429 
p
 = 
Ev®u©Ü
::
	`pur™y
(
şu¡Fn
, 
grdFn
);

430 
	}
}

432 
	gEv®u©Ü
::
	$NN»ÿÎ
(*
kLi¡
,
row
,
dim
,
k
,cÚ¡ *
grdD¡
)

434 
grow
=0,
gdim
=0;

435 
œow
,
idim
;

436 
i
;

437 
m©chCouÁ
=0;

438 *
grdŒuth
 =
IOAg’t
::
	`lßdgroundŒuth
(
grdD¡
,
grow
,
gdim
);

439 
cout
<<"gdim:"<<
gdim
<<
’dl
;

440 
cout
<<"k:"<<
k
<<
’dl
;

441 if(
gdim
<
k
)

443 
cout
<<"”rÜ!beÿu£ gdim<tİk"<<
’dl
;

446 
œow
 = 0;œow<
row
;irow++)

448 
idim
=0;idim<
k
;idim++)

450 
tmpm©
 = 
kLi¡
[
œow
*
dim
+
idim
];

452 
i
=0;i<
k
;i++)

454 
tmpgrd
 = 
grdŒuth
[
œow
*
gdim
+
i
];

455 if(
tmpgrd
==
tmpm©
)

457 
m©chCouÁ
++;

462 
»ÿÎ
 = 0;

463 
cout
<<"m©chcouÁ:"<<
m©chCouÁ
<<
’dl
;

464 
»ÿÎ
 = (
m©chCouÁ
*1.0/
k
)/
row
;

465  
»ÿÎ
;

466 
	}
}

468 
	gEv®u©Ü
::
	$‹¡
()

501 
row
,
dim
;

505 cÚ¡ *
grdD¡
 = "/home/pclin/nns_benchmark-master/data/rand/grd/rand100k100d_gold_knn30.txt";

506 cÚ¡ *
¤câ
 = "/home/pclin/nns_benchmark-master/data/rand/randNN/rand100k100dNN.txt";

508 *
kli¡
 = 
IOAg’t
::
	`lßdgroundŒuth
(
¤câ
,
row
,
dim
);

510 
cout
<<"„ow:"<<
row
<<
’dl
;

511 
cout
<<" dim:"<<
dim
<<
’dl
;

512 
r
;

513 
r
=
Ev®u©Ü
::
	`NN»ÿÎ
(
kli¡
,
row
,
dim
,30,
grdD¡
);

514 
cout
<<"»ÿÎ="<<
r
<<
’dl
;

515 
	}
}

	@/home/pclin/cpp/gkmeans/evaluator.h

1 #iâdeà
EVALUATOR_H


2 
	#EVALUATOR_H


	)

4 
	~<veùÜ
>

5 
	~<m­
>

6 
	~<£t
>

8 
usšg
 
Çme¥aû
 
	g¡d
;

17 şas 
	cEv®u©Ü


19 
	mpublic
:

20 
	$Ev®u©Ü
(){}

21 
vœtu®
 ~
	$Ev®u©Ü
(){
	}
}

24 
lßdClu¡
(cÚ¡ *
¤cFn
, 
m­
<, 
£t
<> *> &
şu¡s
);

25 
’Œİy
(
m­
<, 
£t
<> *> &
şu¡s
, m­<, s‘<> *> &
grdT¹h
);

26 
pur™y
(
m­
<, 
£t
<> *> &
şu¡s
, m­<, s‘<> *> &
grdT¹h
);

27 
’Œİy
(
£t
<> &
şu¡
, 
m­
<, s‘<> *> &
grdT¹h
);

28 
pur™y
(
£t
<> &
şu¡
, 
m­
<, s‘<> *> &
grdT¹h
);

29 
’Œİy
(cÚ¡ *
¤cFn
, cÚ¡ *
grdFn
);

30 
pur™y
(cÚ¡ *
¤cFn
, cÚ¡ *
grdFn
);

31 
š‹rSeù
(cÚ¡ 
£t
<> &
s1
, cÚ¡ s‘<> &
£t2
);

32 
funScÜe
(cÚ¡ *
şu¡Fn
, cÚ¡ *
d©Fn
, cÚ¡ *
fun
);

33 
g‘SEP
(cÚ¡ *
şu¡Fn
, cÚ¡ *
grdFn
, cÚ¡ *
d©Fn
, &
scÜe
, &
e
, &
p
, cÚ¡ *
fun
);

34 
jacÿrd
(
m­
<, 
£t
<> *> &
şu¡s
, m­<, s‘<> *> &
grdTrh
, cÚ¡ *
â
);

35 
jacÿrd
(cÚ¡ *
£tâ
, cÚ¡ * 
grdâ
, cÚ¡ *
d¡â
);

36 
di¡ÜtiÚ
(cÚ¡ * 
¤câ
, cÚ¡ * 
şu¡”â
);

45 
NN»ÿÎ
(*
kLi¡
,
row
,
dim
,
k
,cÚ¡ *
grdD¡
);

48 
‹¡
();

	@/home/pclin/cpp/gkmeans/ioagent.cpp

1 
	~"ißg’t.h
"

3 
	~"sü¬£r.h
"

4 
	~"v¡ršg.h
"

5 
	~"pqm©h.h
"

6 
	~"ş—Ãr.h
"

8 
	~<unÜd”ed_m­
>

9 
	~<dœ’t.h
>

10 
	~<ty³šfo
>

11 
	~<io¡»am
>

12 
	~<f¡»am
>

13 
	~<ÿs£¹
>

14 
	~<c¡ršg
>

15 
	~<iomª
>

16 
	~<cm©h
>

17 
	~<c¡dlib
>

19 
usšg
 
Çme¥aû
 
	g¡d
;

21 *
	gIOAg’t
::
	$lßdPQ
(cÚ¡ *
¤câ
, &
row
, &
cŞ
)

23 
if¡»am
 
	`is
(
¤câ
);

24 if(!
is
.
	`is_İ’
())

26 
cout
<<"FaØ»ad "<<
¤câ
<<
’dl
;

27 
	`ex™
(0);

30 
is
>>
row
>>
cŞ
;

31 
i
, 
j
;

32 
tmp
;

33 *
d©a
 = 
Ãw
 [
row
*
cŞ
];

34 
i
 = 0; i < 
row
; i++)

35 
j
 = 0; j < 
cŞ
; j++)

37 
is
>>
tmp
;

38 
d©a
[
i
*
cŞ
+
j
] = 
tmp
;

40 
is
.
	`şo£
();

41  
d©a
;

42 
	}
}

44 *
	gIOAg’t
::
	$lßdKNNG
(cÚ¡ *
¤cFn
, &
row
, &
dim
)

46 
row
 = 
dim
 = 0;

47 *
kÂG
 = 
NULL
, 
iRow
 = 0, 
i
 = 0, 
idx
 = 0, 
v®
 = 0;

48 
if¡»am
 *
šSŒm
 = 
Ãw
 
	`if¡»am
(
¤cFn
);

49 (*
šSŒm
)>>
row
;

50 (*
šSŒm
)>>
dim
;

51 
kÂG
 = 
Ãw
 [
row
*
dim
];

52 !
šSŒm
->
	`eof
(è&&
iRow
 < 
row
)

54 
i
 = 0; i < 
dim
; i++, 
idx
++)

56 (*
šSŒm
)>>
v®
;

57 
kÂG
[
idx
] = 
v®
;

59 
iRow
++;

61 
šSŒm
->
	`şo£
();

63  
kÂG
;

64 
	}
}

66 *
	gIOAg’t
::
	$lßdKNNG1
(cÚ¡ *
¤cFn
, &
row
, &
dim
)

68 
row
 = 
dim
 = 0;

69 *
kÂG
 = 
NULL
, 
iRow
 = 0, 
i
 = 0, 
idx
 = 0, 
v®
 = 0;

70 
h—d
 = 0;

71 
if¡»am
 *
šSŒm
 = 
Ãw
 
	`if¡»am
(
¤cFn
);

72 (*
šSŒm
)>>
row
;

73 (*
šSŒm
)>>
dim
;

74 
kÂG
 = 
Ãw
 [
row
*
dim
];

75 !
šSŒm
->
	`eof
(è&&
iRow
 < 
row
)

77 (*
šSŒm
)>>
h—d
;

78 
i
 = 0; i < 
dim
; i++, 
idx
++)

80 (*
šSŒm
)>>
v®
;

81 
kÂG
[
idx
] = 
v®
;

83 
iRow
++;

85 
šSŒm
->
	`şo£
();

87  
kÂG
;

88 
	}
}

90 
	gIOAg’t
::
	$m”gKNNG
(cÚ¡ *
kÂgFn1
, cÚ¡ *
kÂgFn2
, cÚ¡ *
d¡KÂg
)

92 
unÜd”ed_m­
<, 
£t
<> * >::
™”©Ü
 
m™
;

93 
unÜd”ed_m­
<, 
£t
<> * > 
kÂGM­
;

94 
£t
<>::
™”©Ü
 
s™
;

95 
£t
<> *
üÁS‘
 = 
NULL
;

96 
iRow
 = 0, 
i
 = 0, 
idx
 = 0, 
v®
 = 0;

97 
h—d
 = 0, 
row
 = 0, 
dim
 = 0;

98 
if¡»am
 *
šSŒm
 = 
Ãw
 
	`if¡»am
(
kÂgFn1
);

99 (*
šSŒm
)>>
row
;

100 (*
šSŒm
)>>
dim
;

101 
i
 = 0; i < 
row
; i++)

103 
kÂGM­
.
	`š£¹
(
·œ
<, 
£t
<> *> (
i
, 
Ãw
 set<>) );

105 !
šSŒm
->
	`eof
(è&&
iRow
 < 
row
)

107 (*
šSŒm
)>>
h—d
;

108 
üÁS‘
 = 
kÂGM­
[
h—d
];

109 
i
 = 0; i < 
dim
; i++, 
idx
++)

111 (*
šSŒm
)>>
v®
;

112 
üÁS‘
->
	`š£¹
(
v®
);

115 
šSŒm
->
	`şo£
();

117 
šSŒm
 = 
Ãw
 
	`if¡»am
(
kÂgFn2
);

118 (*
šSŒm
)>>
row
;

119 (*
šSŒm
)>>
dim
;

120 !
šSŒm
->
	`eof
(è&&
iRow
 < 
row
)

122 (*
šSŒm
)>>
h—d
;

123 
üÁS‘
 = 
kÂGM­
[
h—d
];

124 
i
 = 0; i < 
dim
; i++, 
idx
++)

126 (*
šSŒm
)>>
v®
;

127 
üÁS‘
->
	`š£¹
(
v®
);

130 
šSŒm
->
	`şo£
();

132 
of¡»am
 *
outSŒm
 = 
Ãw
 
	`of¡»am
(
d¡KÂg
, 
ios
::
out
);

133 (*
outSŒm
)<<
kÂGM­
.
	`size
()<<" "<<30<<
’dl
;

134 
mšSz
 = 0;

135 
m™
 = 
kÂGM­
.
	`begš
(); m™ !ğkÂGM­.
	`’d
(); mit++)

137 
üÁS‘
 = 
m™
->
£cÚd
;

138 
mšSz
 = 
üÁS‘
->
	`size
()<30?crntSet->size():30;

139 (*
outSŒm
)<<
m™
->
fœ¡
;

140 (*
outSŒm
)<<" "<<
mšSz
;

141 
s™
 = 
üÁS‘
->
	`begš
(), 
idx
 = 0; s™ !ğüÁS‘->
	`’d
() && idx < 30; sit++, idx++)

143 (*
outSŒm
)<<" "<<*
s™
;

145 (*
outSŒm
)<<
’dl
;

146 
üÁS‘
->
	`ş—r
();

147 
d–‘e
 
üÁS‘
;

149 
kÂGM­
.
	`ş—r
();

150 
outSŒm
->
	`şo£
();

151 
	}
}

153 *
	gIOAg’t
::
	$lßdPQInfo
(cÚ¡ *
¤câ
, &
pqn
, &
pql
, &
pqm
)

155 
if¡»am
 
	`is
(
¤câ
);

156 if(!
is
.
	`is_İ’
())

158 
cout
<<"FaØ»ad "<<
¤câ
<<
’dl
;

159 
	`ex™
(0);

161 
is
>>
pqn
>>
pql
>>
pqm
;

162 
i
, 
j
, 
k
;

163 *
d©a
 = 
Ãw
 [
pqn
*
pql
*
pqm
];

165 
i
 = 0; i < 
pqm
; i++)

167 
j
 = 0; j < 
pqn
; j++)

169 
k
 = 0; k < 
pql
; k++)

171 
is
>>
d©a
[
i
*
pqn
*
pql
+
j
*pql+
k
];

175 
is
.
	`şo£
();

176  
d©a
;

177 
	}
}

179 *
	gIOAg’t
::
	$lßdM©rix
(cÚ¡ *
¤câ
, &
row
, &
cŞ
)

181 
	`as£¹
(
¤câ
);

182 
v®s
[2] = {0};

184 
if¡»am
 *
šSŒm
 = 
Ãw
 
	`if¡»am
();

185 
šSŒm
->
	`İ’
(
¤câ
, 
ios
::
š
);

186 if(
šSŒm
->
	`ç
())

188 
cout
<<"FaØ»ad "<<
¤câ
<<
’dl
;

189 
d–‘e
 
šSŒm
;

190 
	`ex™
(0);

193 (*
šSŒm
)>>
v®s
[0];

194 (*
šSŒm
)>>
v®s
[1];

195 
row
 = ()
	`round
(
v®s
[0]);

196 
cŞ
 = ()
	`round
(
v®s
[1]);

197 *
m©
 = 
Ãw
 [
row
*
cŞ
];

198 
	`mem£t
(
m©
, 0, ()*
row
*
cŞ
);

199 *
tmp
 = 
Ãw
 [
cŞ
];

200 
œow
, 
idim
, 
loc
;

202 
œow
 = 0; irow < 
row
; irow++)

204 
loc
 = 
œow
*
cŞ
;

205 
idim
 = 0; idim < 
cŞ
; idim++)

207 (*
šSŒm
è>>
tmp
[
idim
];

209 
idim
 = 0; idim < 
cŞ
; idim++)

211 
m©
[
loc
 + 
idim
] = 
tmp
[idim];

213 
	`mem£t
(
tmp
, 0, ()*
idim
);

215 
šSŒm
->
	`şo£
();

216 
	`as£¹
(
œow
 > 0);

217 
row
 = 
œow
;

218 
d–‘e
 
šSŒm
;

219 
d–‘e
 [] 
tmp
;

220  
m©
;

221 
	}
}

223 *
	gIOAg’t
::
	$lßdIM©
(cÚ¡ *
¤câ
, &
row
, &
cŞ
)

225 
	`as£¹
(
¤câ
);

226 
v®s
[2] = {0};

228 
if¡»am
 *
šSŒm
 = 
Ãw
 
	`if¡»am
();

229 
šSŒm
->
	`İ’
(
¤câ
, 
ios
::
š
);

230 if(
šSŒm
->
	`ç
())

232 
cout
<<"FaØ»ad "<<
¤câ
<<
’dl
;

233 
d–‘e
 
šSŒm
;

234 
	`ex™
(0);

237 (*
šSŒm
)>>
v®s
[0];

238 (*
šSŒm
)>>
v®s
[1];

239 
row
 = ()
	`round
(
v®s
[0]);

240 
cŞ
 = ()
	`round
(
v®s
[1]);

241 *
m©
 = 
Ãw
 [
row
*
cŞ
];

242 
	`mem£t
(
m©
, 0, ()*
row
*
cŞ
);

243 *
tmp
 = 
Ãw
 [
cŞ
];

244 
œow
, 
idim
, 
loc
, 
num
 = 0;

246 
œow
 = 0; irow < 
row
; irow++)

248 
loc
 = 
œow
*
cŞ
;

249 (*
šSŒm
è>> 
num
;

250 
idim
 = 0; idim < 
cŞ
; idim++)

252 (*
šSŒm
è>>
tmp
[
idim
];

254 
idim
 = 0; idim < 
cŞ
; idim++)

256 
m©
[
loc
 + 
idim
] = 
tmp
[idim];

258 
	`mem£t
(
tmp
, 0, ()*
idim
);

260 
šSŒm
->
	`şo£
();

261 
	`as£¹
(
œow
 > 0);

262 
row
 = 
œow
;

263 
d–‘e
 
šSŒm
;

264 
d–‘e
 [] 
tmp
;

265  
m©
;

266 
	}
}

268 *
	gIOAg’t
::
lßdTruncM©
(cÚ¡ *
¤cFn
, &
row
, &
dim
, 
veùÜ
<> &
ids
)

270 
if¡»am
 *
	gšSŒm
 = 
Ãw
 if¡»am(
¤cFn
, 
ios
::
š
);

271 
	gi
 = 0, 
	gj
 = 0, 
	gid
;

272 (*
	gšSŒm
)>>
	grow
;

273 (*
	gšSŒm
)>>
	gdim
;

274 *
	gm©
 = 
Ãw
 [
dim
*
row
];

275 
	gi
 = 0; i < 
	grow
; i++)

277 (*
	gšSŒm
)>>
	gid
;

278 
	gids
.
push_back
(
id
);

279 
	gj
 = 0; j < 
	gdim
; j++)

281 (*
	gšSŒm
)>>
	gm©
[
i
*
dim
+
j
];

284 
	gšSŒm
->
şo£
();

285  
	gm©
;

288 
	gIOAg’t
::
§veTruncM©
(cÚ¡ *
d¡Fn
, cÚ¡ 
dim
, *
m©
, 
£t
<> &
ids
)

290 
of¡»am
 *
	goutSŒm
 = 
Ãw
 of¡»am(
d¡Fn
, 
ios
::
out
);

291 
	g£t
<>::
™”©Ü
 
s™
;

292 
	grow
 = 
ids
.
size
(), 
	gi
 = 0, 
	gj
 = 0;

293 (*
	goutSŒm
)<<
	grow
<<" "<<
	gdim
<<
	g’dl
;

294 
	gs™
 = 
ids
.
begš
(), 
	gi
 = 0; s™ !ğids.
’d
(); sit++,i++)

296 (*
	goutSŒm
)<<*
	gs™
;

297 
	gj
 = 0; j < 
	gdim
; j++)

299 (*
	goutSŒm
)<<" "<<
	gm©
[
i
*
dim
+
j
];

301 (*
	goutSŒm
)<<
	g’dl
;

303 
	goutSŒm
->
şo£
();

306 *
	gIOAg’t
::
	$lßd_fvecs
(cÚ¡ *
fvecâ
, &
r
, &
d
)

309 *
m©
 = 
NULL
, *
veù
 = NULL, *
µm©
 = NULL;

310 
di
 = 0, 
œ
 = 0;

311 
d
 = 0;

312 
r
 = 0;

313 
bg
 = 0, 
fsize
 = 0, 
bfsz
 = 0;

315 
if¡»am
 *
šSŒm
 = 
Ãw
 
	`if¡»am
(
fvecâ
, 
ios
::
š
|ios::
bš¬y
);

316 if(!
šSŒm
->
	`is_İ’
())

318 
cout
<<"F'"<<
fvecâ
<<"' cannot open for„ead!\n";

319  
NULL
;

323 
bg
 = ()
šSŒm
->
	`‹Îg
();

324 
šSŒm
->
	`»ad
((*)&
di
, ());

325 
d
 = 
di
;

326 
bfsz
 = 
d
*();

327 
šSŒm
->
	`£ekg
(0, 
ios
::
’d
);

328 
fsize
 = ()
šSŒm
->
	`‹Îg
(è- 
bg
;

329 
šSŒm
->
	`şo£
();

330 
r
 = 
fsize
/((è+ 
bfsz
);

331 if(
r
 == 0)

333 
cout
<<"No data has been†oaded!\n";

334 
r
 = 
d
 = 0;

335  
NULL
;

337 
veù
 = 
Ãw
 [
d
];

338 
m©
 = 
Ãw
 [
r
*
d
];

339 
	`mem£t
(
m©
, 0, ()*
r
*
d
);

340 
µm©
 = 
m©
;

341 
šSŒm
 = 
Ãw
 
	`if¡»am
(
fvecâ
, 
ios
::
š
|ios::
bš¬y
);

342 !
šSŒm
->
	`eof
(è&& 
œ
 < 
r
)

344 
šSŒm
->
	`»ad
((*)&
di
, ());

346 if(
di
 == 0)

349 
bfsz
 = 
di
*();

350 
šSŒm
->
	`»ad
((*)
veù
, 
bfsz
);

351 
	`memıy
(
µm©
, 
veù
, 
bfsz
);

352 
	`mem£t
(
veù
, 0, 
bfsz
);

353 
µm©
 =…pm© + 
d
;

354 
di
 = 0;

355 
œ
++;

358 
d–‘e
 [] 
veù
;

359 
veù
 = 
NULL
;

360 
šSŒm
->
	`şo£
();

361  
m©
;

362 
	}
}

364 *
	gIOAg’t
::
	$lßd_bvecs
(cÚ¡ *
bvecâ
, &
r
, &
d
)

366 *
veù
 = 
NULL
;

367 *
m©
 = 
NULL
, *
fveù
 = NULL, *
µm©
 = NULL;

368 
di
 = 0;

369 
œ
 = 0, 
i
 = 0;

370 
d
 = 0;

371 
r
 = 0;

372 
bg
 = 0, 
fsize
 = 0, 
bfsz
 = 0;

374 
if¡»am
 *
šSŒm
 = 
Ãw
 
	`if¡»am
(
bvecâ
, 
ios
::
š
|ios::
bš¬y
);

375 if(!
šSŒm
->
	`is_İ’
())

377 
cout
<<"F'"<<
bvecâ
<<"' cannot open for„ead!\n";

378  
NULL
;

382 
bg
 = ()
šSŒm
->
	`‹Îg
();

383 
šSŒm
->
	`»ad
((*)&
di
, ());

384 
d
 = 
di
;

385 
bfsz
 = 
d
*();

386 
šSŒm
->
	`£ekg
(0, 
ios
::
’d
);

387 
fsize
 = ()
šSŒm
->
	`‹Îg
(è- 
bg
;

388 
šSŒm
->
	`şo£
();

389 
r
 = 
fsize
/((è+ 
bfsz
);

390 
r
 =„>10000000?10000000:r;

391 if(
r
 == 0)

393 
cout
<<"No data has been†oaded!\n";

394 
r
 = 
d
 = 0;

395  
NULL
;

397 
veù
 = 
Ãw
 [
d
];

399 
m©
 = (*)
	`ÿÎoc
(
r
, 
d
*());

400 
fveù
 = 
Ãw
 [
d
];

402 
µm©
 = 
m©
;

403 
šSŒm
 = 
Ãw
 
	`if¡»am
(
bvecâ
, 
ios
::
š
|ios::
bš¬y
);

404 if(!
šSŒm
->
	`is_İ’
())

406 
cout
<<"F'"<<
bvecâ
<<"' cannot open for„ead!\n";

407  
NULL
;

409 !
šSŒm
->
	`eof
(è&& 
œ
 < 
r
)

411 
šSŒm
->
	`»ad
((*)&
di
, ());

413 if(
di
 == 0)

416 
bfsz
 = 
di
*();

417 
šSŒm
->
	`»ad
((*)
veù
, 
bfsz
);

418 
i
 = 0; i < 
di
; i++)

420 
fveù
[
i
] = ()
veù
[i];

423 
	`memıy
(
µm©
, 
fveù
, 
di
*());

424 
	`mem£t
(
veù
, 0, 
bfsz
);

425 
µm©
 =…pm© + 
di
;

426 
di
 = 0;

427 
œ
++;

430 
d–‘e
 [] 
veù
;

431 
d–‘e
 [] 
fveù
;

432 
veù
 = 
NULL
;

433 
fveù
 = 
NULL
;

434 
šSŒm
->
	`şo£
();

454  
m©
;

455 
	}
}

457 *
	gIOAg’t
::
	$lßdNN
(cÚ¡ *
Ââ
, &
row
, &
dim
)

459 
if¡»am
 
	`is
(
Ââ
);

460 if(!
is
.
	`is_İ’
())

462 
cout
<<"ÿÀnÙ†ßd‚Àf"<<
Ââ
<<
’dl
;

463  
NULL
;

465 
is
>>
row
>>
dim
;

466 
cout
<<"row:"<<
row
;

467 
cout
<<"dim:"<<
dim
;

468 *
tİLi¡
 = (*)
	`ÿÎoc
(
row
, 
dim
*());

470 
tmp
, 
i
, 
j
;

483 
i
=0;i<
row
;i++)

485 
j
=0;j<
dim
;j++)

487 
is
>>
tmp
;

488 
tİLi¡
[
i
*
dim
+
j
] = 
tmp
;

491 
is
.
	`şo£
();

492  
tİLi¡
;

493 
	}
}

495 *
	gIOAg’t
::
	$lßdgroundŒuth
(cÚ¡ *
gtd¡
,&
row
,&
dim
)

497 
œow
,
idim
;

498 
id
,
k
;

499 
tmp
;

500 
if¡»am
 *
šS
 = 
Ãw
 
	`if¡»am
(
gtd¡
,
ios
::
š
);

501 if(!
šS
->
	`is_İ’
())

503 
cout
<<"F"<<
gtd¡
<<" cannot open for„ead!\n";

504  
NULL
;

506 (*
šS
)>>
row
;

507 (*
šS
)>>
id
;

508 (*
šS
)>>
dim
;

509 *
tİli¡
 = (*)
	`ÿÎoc
(
row
,
dim
*());

510 
šS
->
	`şo£
();

513 
if¡»am
 *
šSŒm
 = 
Ãw
 
	`if¡»am
(
gtd¡
,
ios
::
š
);

514 if(!
šSŒm
->
	`is_İ’
())

516 
cout
<<"F"<<
gtd¡
<<" cannot open for„ead!\n";

517  
NULL
;

519 (*
šSŒm
)>>
row
;

520 
œow
 = 0; irow<
row
;irow++)

522 (*
šSŒm
)>>
id
;

523 (*
šSŒm
)>>
k
;

524 
idim
 = 0; idim<
k
;idim++)

526 (*
šSŒm
)>>
tmp
;

527 
tİli¡
[
œow
*
k
+
idim
] = 
tmp
;

530  
tİli¡
;

531 
	}
}

533 *
	gIOAg’t
::
	$lßd_bvecs
(cÚ¡ *
bvecâ
, &
r
, &
d
, 
row
)

535 *
veù
 = 
NULL
;

536 *
m©
 = 
NULL
, *
fveù
 = NULL, *
µm©
 = NULL;

537 
di
 = 0;

538 
œ
 = 0, 
i
 = 0;

539 
d
 = 0;

540 
r
 = 0;

541 
bg
 = 0, 
fsize
 = 0, 
bfsz
 = 0;

543 
if¡»am
 *
šSŒm
 = 
Ãw
 
	`if¡»am
(
bvecâ
, 
ios
::
š
|ios::
bš¬y
);

544 if(!
šSŒm
->
	`is_İ’
())

546 
cout
<<"F'"<<
bvecâ
<<"' cannot open for„ead!\n";

547  
NULL
;

551 
bg
 = ()
šSŒm
->
	`‹Îg
();

552 
šSŒm
->
	`»ad
((*)&
di
, ());

553 
d
 = 
di
;

554 
bfsz
 = 
d
*();

555 
šSŒm
->
	`£ekg
(0, 
ios
::
’d
);

556 
fsize
 = ()
šSŒm
->
	`‹Îg
(è- 
bg
;

557 
šSŒm
->
	`şo£
();

558 
r
 = 
fsize
/((è+ 
bfsz
);

559 
r
 =„>
row
?row:r;

560 if(
r
 == 0)

562 
cout
<<"No data has been†oaded!\n";

563 
r
 = 
d
 = 0;

564  
NULL
;

566 
veù
 = 
Ãw
 [
d
];

567 
m©
 = (*)
	`ÿÎoc
(
r
, 
d
*());

568 
fveù
 = 
Ãw
 [
d
];

570 
µm©
 = 
m©
;

571 
šSŒm
 = 
Ãw
 
	`if¡»am
(
bvecâ
, 
ios
::
š
|ios::
bš¬y
);

572 if(!
šSŒm
->
	`is_İ’
())

574 
cout
<<"F'"<<
bvecâ
<<"' cannot open for„ead!\n";

575  
NULL
;

577 !
šSŒm
->
	`eof
(è&& 
œ
 < 
r
)

579 
šSŒm
->
	`»ad
((*)&
di
, ());

581 if(
di
 == 0)

584 
bfsz
 = 
di
*();

585 
šSŒm
->
	`»ad
((*)
veù
, 
bfsz
);

586 
i
 = 0; i < 
di
; i++)

588 
fveù
[
i
] = ()
veù
[i];

591 
	`memıy
(
µm©
, 
fveù
, 
di
*());

592 
	`mem£t
(
veù
, 0, 
bfsz
);

593 
µm©
 =…pm© + 
di
;

594 
di
 = 0;

595 
œ
++;

598 
d–‘e
 [] 
veù
;

599 
d–‘e
 [] 
fveù
;

600 
veù
 = 
NULL
;

601 
fveù
 = 
NULL
;

602 
šSŒm
->
	`şo£
();

603  
m©
;

604 
	}
}

607 *
	gIOAg’t
::
	$lßdD©
(cÚ¡ *
â
, &
row
, &
cŞ
)

610 *
m©
 = 
NULL
;

611 
¡ršg
 
¡r
;

612 
id
;

613 
d©a
;

614 cÚ¡ *
loc
 = 
NULL
;

616 
if¡»am
 
	`šSŒm
(
â
);

617 if(!
šSŒm
.
	`is_İ’
())

619 
cout
<<"F'"<<
â
<<"' cannot open for„ead!\n";

620 
	`ex™
(0);

623 
	`g‘lše
(
šSŒm
,
¡r
);

624 
loc
 = 
¡r
.
	`c_¡r
();

625 
row
 = 
	`©oi
(
loc
);

626 
loc
 = 
	`¡r¡r
(loc+1, " ");

627 
cŞ
 = 
	`©oi
(
loc
+1);

628 
m©
 = 
Ãw
 [
row
*
cŞ
];

629 
	`mem£t
(
m©
, 0, 
row
*
cŞ
*());

631 
i
 = 0; i < 
row
; i++)

633 
	`g‘lše
(
šSŒm
,
¡r
);

634 
loc
 = 
¡r
.
	`c_¡r
();

635 
rowid
 = 
i
*
cŞ
;

636 
loc
 !ğ
NULL
)

638 *
loc
 == ' ')

639 
loc
++;

640 
id
 = 
	`©oi
(
loc
) ;

641 
loc
 = 
	`¡r¡r
(loc, " ");

642 if(
loc
 =ğ
NULL
)

644 *
loc
 == ' ')

646 
loc
++;

648 
d©a
 = 
	`©of
(
loc
);

649 
loc
 = 
	`¡r¡r
(loc, " ");

650 
m©
[
rowid
+
id
-1] = 
d©a
;

654 
šSŒm
.
	`şo£
();

655  
m©
;

656 
	}
}

658 *
	gIOAg’t
::
	$lßdItms
(cÚ¡ *
â
, cÚ¡ *
idxKey
, &
row
, &
cŞ
)

660 
m­
<, m­<
¡ršg
, cÚ¡ *>* >::
™”©Ü
 
m™
;

661 
m­
<, m­<
¡ršg
, cÚ¡ *>* > 
™ms
;

662 
™ms
 = 
SütP¬£r
::
	`g‘ItmM­s
(
â
);

663 
m­
<
¡ršg
, cÚ¡ *> *
üÁItm
;

664 
num
 = 0, 
dim
 = 0, 
i
 = 0, 
j
 = 0, 
idim
 = 0, 
loc
 = 0, 
œow
 = 0, 
v®s
[2];

665 
ni
 = 0, 
di
 = 0, 
id
 = 0;

666 
if¡»am
 
šSŒm
;

668 *
m©
 = 
NULL
;

669 *
tmp
 ;

670 
d©a
;

671 
¡ršg
 
¡r
;

672 cÚ¡ *
ch
 = 
NULL
;

673 
boŞ
 
DÚe
 = 
çl£
;

674 if(!
	`¡rcmp
(
idxKey
, "matrixdir"))

676 
m™
 = 
™ms
.
	`begš
(); m™ !ğ™ms.
	`’d
(); mit++)

678 
üÁItm
 = 
m™
->
£cÚd
;

679 if(
üÁItm
->
	`fšd
(
idxKey
è=ğüÁItm->
	`’d
())

683 
veùÜ
<
¡ršg
> 
f’ames
;

684 
IOAg’t
::
	`»adFeName
((*
üÁItm
)[
idxKey
], 
f’ames
);

685 
m©
 = 
IOAg’t
::
	`lßdM©rix
(
f’ames
, 
row
, 
cŞ
);

687 
SütP¬£r
::
	`ş—rItmM­s
(
™ms
);

688  
m©
;

690 if(!
	`¡rcmp
(
idxKey
, "fvecsdir"))

692 
m™
 = 
™ms
.
	`begš
(); m™ !ğ™ms.
	`’d
(); mit++)

694 
üÁItm
 = 
m™
->
£cÚd
;

695 if(
üÁItm
->
	`fšd
(
idxKey
è=ğüÁItm->
	`’d
())

699 
veùÜ
<
¡ršg
> 
f’ames
;

700 
IOAg’t
::
	`»adFeName
((*
üÁItm
)[
idxKey
], 
f’ames
);

701 
m©
 = 
IOAg’t
::
	`lßd_fvecs
(
f’ames
, 
cŞ
, 
row
);

703 
SütP¬£r
::
	`ş—rItmM­s
(
™ms
);

704  
m©
;

706 if(!
	`¡rcmp
(
idxKey
, "matdir"))

708 
m™
 = 
™ms
.
	`begš
(); m™ !ğ™ms.
	`’d
(); mit++)

710 
üÁItm
 = 
m™
->
£cÚd
;

711 if(
üÁItm
->
	`fšd
(
idxKey
è=ğüÁItm->
	`’d
())

715 
veùÜ
<
¡ršg
> 
f’ames
;

716 
IOAg’t
::
	`»adFeName
((*
üÁItm
)[
idxKey
], 
f’ames
);

717 
m©
 = 
IOAg’t
::
	`lßdD©
(
f’ames
, 
row
, 
cŞ
);

719 
SütP¬£r
::
	`ş—rItmM­s
(
™ms
);

720  
m©
;

723 
m™
 = 
™ms
.
	`begš
(); m™ !ğ™ms.
	`’d
(); mit++)

725 
üÁItm
 = 
m™
->
£cÚd
;

726 if(
üÁItm
->
	`fšd
(
idxKey
è=ğüÁItm->
	`’d
())

728 
cout
<<"P¬am‘” '"<<
idxKey
<<"' is missing!\n";

729 
	`ex™
(0);

731 
DÚe
 = 
IOAg’t
::
	`g‘M©rixInfo
((*
üÁItm
)[
idxKey
], 
ni
, 
di
);

732 if(!
DÚe
)

734 
cout
<<"som‘hšg gÛ wrÚg w™h '"<<(*
üÁItm
)[
idxKey
]<<"'"<<
’dl
;

737 
	`as£¹
(
ni
 > 0);

738 if(
dim
 == 0)

740 
dim
 = 
di
;

742 
	`as£¹
(
di
 =ğ
dim
);

743 
num
 +ğ
ni
;

745 
row
 = 
num
;

746 
cŞ
 = 
dim
;

748 
m©
 = 
Ãw
 [
num
*
dim
];

749 
tmp
 = 
Ãw
 [
dim
];

750 
loc
 = 0;

751 
m™
 = 
™ms
.
	`begš
(); m™ !ğ™ms.
	`’d
(); mit++)

753 
üÁItm
 = 
m™
->
£cÚd
;

754 if(
üÁItm
->
	`fšd
(
idxKey
è=ğüÁItm->
	`’d
())

756 
cout
<<"P¬am‘” '"<<
idxKey
<<"' is missing!\n";

757 
	`ex™
(0);

760 
šSŒm
>>
v®s
[0];

761 
šSŒm
>>
v®s
[1];

762 if(
VSŒšg
::
	`’dW™h
((*
üÁItm
)[
idxKey
], ".txt"))

764 
šSŒm
.
	`İ’
((*
üÁItm
)[
idxKey
], 
ios
::
š
);

765 
	`as£¹
(
šSŒm
.
	`is_İ’
());

766 
šSŒm
 >>
v®s
[0];

767 
œow
 = ()
	`round
(
v®s
[0]);

769 
j
 = 0; j < 
œow
; j++)

772 
idim
 = 0; idim < 
dim
; idim++)

774 
šSŒm
 >>
tmp
[
idim
];

776 
idim
 = 0; idim < 
dim
; idim++)

778 
m©
[
loc
 + 
idim
] = 
tmp
[idim];

780 
	`mem£t
(
tmp
, 0, ()*
idim
);

781 
loc
 +ğ
dim
;

784 if(
VSŒšg
::
	`’dW™h
((*
üÁItm
)[
idxKey
], ".fvecs"))

786 
šSŒm
.
	`İ’
((*
üÁItm
)[
idxKey
], 
ios
::
š
|ios::
bš¬y
);

788 
	`as£¹
(
šSŒm
.
	`is_İ’
());

789 
bg
 = 
šSŒm
.
	`‹Îg
();

790 
šSŒm
.
	`»ad
((*)&
dim
, ());

791 
šSŒm
.
	`£ekg
(0, 
ios
::
’d
);

792 
sz
 = 
šSŒm
.
	`‹Îg
();

793 
num
 = (
sz
 - 
bg
)/((è+ 
cŞ
*());

794 
šSŒm
.
	`£ekg
(0, 
ios
::
beg
);

795 
j
 = 0;

796 !
šSŒm
.
	`eof
(è&& 
j
 < 
num
)

798 
šSŒm
.
	`»ad
((*)&
dim
, ());

799 if(
dim
 == 0)

802 
šSŒm
.
	`»ad
((*)
tmp
, 
dim
*());

804 
	`memıy
(
m©
+
loc
, 
tmp
, 
dim
*());

805 
	`mem£t
(
tmp
, 0, 
dim
*());

806 
loc
 +ğ
dim
;

807 
dim
 = 0;

808 
j
++;

811 if(
VSŒšg
::
	`’dW™h
((*
üÁItm
)[
idxKey
], ".mat"))

813 
šSŒm
.
	`İ’
((*
üÁItm
)[
idxKey
], 
ios
::
š
);

814 
	`as£¹
(
šSŒm
.
	`is_İ’
());

815 
	`g‘lše
(
šSŒm
,
¡r
);

816 
ch
 = 
¡r
.
	`c_¡r
();

817 
œow
 +ğ
	`©oi
(
ch
);

819 
i
 = 0; i < 
œow
; i++)

821 
	`g‘lše
(
šSŒm
,
¡r
);

822 
ch
 = 
¡r
.
	`c_¡r
();

823 
ch
 !ğ
NULL
)

825 *
ch
 == ' ')

826 
ch
++;

827 
id
 = 
	`©oi
(
ch
) ;

828 
ch
 = 
	`¡r¡r
(ch, " ");

829 if(
ch
 =ğ
NULL
)

831 *
ch
 == ' ')

832 
ch
++;

833 
d©a
 = 
	`©of
(
ch
);

834 
ch
 = 
	`¡r¡r
(ch, " ");

835 
m©
[
loc
+
id
-1] = 
d©a
;

837 
loc
 +ğ
cŞ
;

841 
šSŒm
.
	`şo£
();

844 
d–‘e
 [] 
tmp
;

845 
tmp
 = 
NULL
;

846 
SütP¬£r
::
	`ş—rItmM­s
(
™ms
);

848  
m©
;

849 
	}
}

851 *
	gIOAg’t
::
	$lßdItms
(cÚ¡ *
â
, cÚ¡ *
idxKey
, cÚ¡ 
lše
, &
row
, &
cŞ
)

853 
m­
<, m­<
¡ršg
, cÚ¡ *>* >::
™”©Ü
 
m™
;

854 
m­
<, m­<
¡ršg
, cÚ¡ *>* > 
™ms
;

855 
™ms
 = 
SütP¬£r
::
	`g‘ItmM­s
(
â
);

856 
m­
<
¡ršg
, cÚ¡ *> *
üÁItm
;

857 
num
 = 0, 
dim
 = 0, 
i
 = 0, 
j
 = 0, 
idim
 = 0, 
loc
 = 0, 
œow
 = 0, 
v®s
[2];

858 
ni
 = 0, 
di
 = 0, 
id
 = 0;

859 
if¡»am
 
šSŒm
;

861 *
m©
 = 
NULL
;

862 *
tmp
 ;

863 
d©a
;

864 
¡ršg
 
¡r
;

865 cÚ¡ *
ch
 = 
NULL
;

866 
boŞ
 
DÚe
 = 
çl£
;

867 if(!
	`¡rcmp
(
idxKey
, "matrixdir"))

869 
m™
 = 
™ms
.
	`begš
(); m™ !ğ™ms.
	`’d
(); mit++)

871 
üÁItm
 = 
m™
->
£cÚd
;

872 if(
üÁItm
->
	`fšd
(
idxKey
è=ğüÁItm->
	`’d
())

876 
veùÜ
<
¡ršg
> 
f’ames
;

877 
IOAg’t
::
	`»adFeName
((*
üÁItm
)[
idxKey
], 
f’ames
);

878 
m©
 = 
IOAg’t
::
	`lßdM©rix
(
f’ames
, 
row
, 
cŞ
);

880 
SütP¬£r
::
	`ş—rItmM­s
(
™ms
);

881  
m©
;

883 if(!
	`¡rcmp
(
idxKey
, "fvecsdir"))

885 
m™
 = 
™ms
.
	`begš
(); m™ !ğ™ms.
	`’d
(); mit++)

887 
üÁItm
 = 
m™
->
£cÚd
;

888 if(
üÁItm
->
	`fšd
(
idxKey
è=ğüÁItm->
	`’d
())

892 
veùÜ
<
¡ršg
> 
f’ames
;

893 
IOAg’t
::
	`»adFeName
((*
üÁItm
)[
idxKey
], 
f’ames
);

894 
m©
 = 
IOAg’t
::
	`lßd_fvecs
(
f’ames
, 
cŞ
, 
row
);

896 
SütP¬£r
::
	`ş—rItmM­s
(
™ms
);

897  
m©
;

899 if(!
	`¡rcmp
(
idxKey
, "matdir"))

901 
m™
 = 
™ms
.
	`begš
(); m™ !ğ™ms.
	`’d
(); mit++)

903 
üÁItm
 = 
m™
->
£cÚd
;

904 if(
üÁItm
->
	`fšd
(
idxKey
è=ğüÁItm->
	`’d
())

908 
veùÜ
<
¡ršg
> 
f’ames
;

909 
IOAg’t
::
	`»adFeName
((*
üÁItm
)[
idxKey
], 
f’ames
);

910 
m©
 = 
IOAg’t
::
	`lßdD©
(
f’ames
, 
row
, 
cŞ
);

912 
SütP¬£r
::
	`ş—rItmM­s
(
™ms
);

913  
m©
;

916 
m™
 = 
™ms
.
	`begš
(); m™ !ğ™ms.
	`’d
(); mit++)

918 
üÁItm
 = 
m™
->
£cÚd
;

919 if(
üÁItm
->
	`fšd
(
idxKey
è=ğüÁItm->
	`’d
())

921 
cout
<<"P¬am‘” '"<<
idxKey
<<"' is missing!\n";

922 
	`ex™
(0);

924 
DÚe
 = 
IOAg’t
::
	`g‘M©rixInfo
((*
üÁItm
)[
idxKey
], 
ni
, 
di
);

925 if(!
DÚe
)

927 
cout
<<"som‘hšg gÛ wrÚg w™h '"<<(*
üÁItm
)[
idxKey
]<<"'"<<
’dl
;

930 
	`as£¹
(
ni
 > 0);

931 if(
dim
 == 0)

933 
dim
 = 
di
;

935 
	`as£¹
(
di
 =ğ
dim
);

936 
num
 +ğ
ni
;

938 
row
 = 
num
;

939 
cŞ
 = 
dim
;

941 if(
row
 < 
lše
)

943 
cout
<<"”rØnÙƒnough†šrow = "<<
row
<<" \n";

944 
	`ex™
(0);

948 
m©
 = 
Ãw
 [
lše
*
dim
];

949 
tmp
 = 
Ãw
 [
dim
];

950 
loc
 = 0;

951 
row
 = 0;

952 
m™
 = 
™ms
.
	`begš
(); m™ !ğ™ms.
	`’d
(); mit++)

954 
üÁItm
 = 
m™
->
£cÚd
;

955 if(
üÁItm
->
	`fšd
(
idxKey
è=ğüÁItm->
	`’d
())

957 
cout
<<"P¬am‘” '"<<
idxKey
<<"' is missing!\n";

958 
	`ex™
(0);

961 
šSŒm
>>
v®s
[0];

962 
šSŒm
>>
v®s
[1];

963 if(
VSŒšg
::
	`’dW™h
((*
üÁItm
)[
idxKey
], ".txt"))

965 
šSŒm
.
	`İ’
((*
üÁItm
)[
idxKey
], 
ios
::
š
);

966 
	`as£¹
(
šSŒm
.
	`is_İ’
());

967 
šSŒm
 >>
v®s
[0];

968 
œow
 = ()
	`round
(
v®s
[0]);

970 
j
 = 0; j < 
œow
; j++)

973 
idim
 = 0; idim < 
dim
; idim++)

975 
šSŒm
 >>
tmp
[
idim
];

977 
idim
 = 0; idim < 
dim
; idim++)

979 
m©
[
loc
 + 
idim
] = 
tmp
[idim];

981 
	`mem£t
(
tmp
, 0, ()*
idim
);

982 
loc
 +ğ
dim
;

983 
row
 ++;

984 if(
row
 =ğ
lše
)

986 
šSŒm
.
	`şo£
();

987 
d–‘e
 [] 
tmp
;

988 
tmp
 = 
NULL
;

989 
SütP¬£r
::
	`ş—rItmM­s
(
™ms
);

990  
m©
;

994 if(
VSŒšg
::
	`’dW™h
((*
üÁItm
)[
idxKey
], ".fvecs"))

996 
šSŒm
.
	`İ’
((*
üÁItm
)[
idxKey
], 
ios
::
š
|ios::
bš¬y
);

998 
	`as£¹
(
šSŒm
.
	`is_İ’
());

999 
bg
 = 
šSŒm
.
	`‹Îg
();

1000 
šSŒm
.
	`»ad
((*)&
dim
, ());

1001 
šSŒm
.
	`£ekg
(0, 
ios
::
’d
);

1002 
sz
 = 
šSŒm
.
	`‹Îg
();

1003 
num
 = (
sz
 - 
bg
)/((è+ 
cŞ
*());

1004 
šSŒm
.
	`£ekg
(0, 
ios
::
beg
);

1005 
j
 = 0;

1006 !
šSŒm
.
	`eof
(è&& 
j
 < 
num
)

1008 
šSŒm
.
	`»ad
((*)&
dim
, ());

1009 if(
dim
 == 0)

1012 
šSŒm
.
	`»ad
((*)
tmp
, 
dim
*());

1014 
	`memıy
(
m©
+
loc
, 
tmp
, 
dim
*());

1015 
	`mem£t
(
tmp
, 0, 
dim
*());

1016 
loc
 +ğ
dim
;

1017 
dim
 = 0;

1018 
j
++;

1019 
row
 ++;

1020 if(
row
 =ğ
lše
)

1022 
šSŒm
.
	`şo£
();

1023 
d–‘e
 [] 
tmp
;

1024 
tmp
 = 
NULL
;

1025 
SütP¬£r
::
	`ş—rItmM­s
(
™ms
);

1026  
m©
;

1030 if(
VSŒšg
::
	`’dW™h
((*
üÁItm
)[
idxKey
], ".mat"))

1032 
šSŒm
.
	`İ’
((*
üÁItm
)[
idxKey
], 
ios
::
š
);

1033 
	`as£¹
(
šSŒm
.
	`is_İ’
());

1034 
	`g‘lše
(
šSŒm
,
¡r
);

1035 
ch
 = 
¡r
.
	`c_¡r
();

1036 
œow
 +ğ
	`©oi
(
ch
);

1038 
i
 = 0; i < 
œow
; i++)

1040 
	`g‘lše
(
šSŒm
,
¡r
);

1041 
ch
 = 
¡r
.
	`c_¡r
();

1042 
ch
 !ğ
NULL
)

1044 *
ch
 == ' ')

1045 
ch
++;

1046 
id
 = 
	`©oi
(
ch
) ;

1047 
ch
 = 
	`¡r¡r
(ch, " ");

1048 if(
ch
 =ğ
NULL
)

1050 *
ch
 == ' ')

1051 
ch
++;

1052 
d©a
 = 
	`©of
(
ch
);

1053 
ch
 = 
	`¡r¡r
(ch, " ");

1054 
m©
[
loc
+
id
-1] = 
d©a
;

1056 
loc
 +ğ
cŞ
;

1057 
row
 ++;

1058 if(
row
 =ğ
lše
)

1060 
šSŒm
.
	`şo£
();

1061 
d–‘e
 [] 
tmp
;

1062 
tmp
 = 
NULL
;

1063 
SütP¬£r
::
	`ş—rItmM­s
(
™ms
);

1064  
m©
;

1069 
šSŒm
.
	`şo£
();

1072 
d–‘e
 [] 
tmp
;

1073 
tmp
 = 
NULL
;

1074 
SütP¬£r
::
	`ş—rItmM­s
(
™ms
);

1076  
m©
;

1077 
	}
}

1080 
S·r£M©rix
 
	gIOAg’t
::
	$lßdBOVW
(cÚ¡ * 
â
, &
row
, &
cŞ
)

1082 
S·r£M©rix
 
sd©a
;

1083 
f¡»am
 
	`is
(
â
);

1087 if(!
is
.
	`is_İ’
())

1089 
cout
<<"f'"<<
â
<<"' can‚ot open for„ead\n";

1090 
	`ex™
(0);

1093 
n
, 
tmp1
, 
tmp2
, 
nozÜe
;

1095 
¡ršg
 
¡r
;

1096 
n
 = 0;

1097 
nozÜe
 = 0;

1098 
is
>>
tmp1
)

1100 
nozÜe
 +ğ
tmp1
;

1101 
n
++;

1102 
	`g‘lše
(
is
, 
¡r
);

1105 
row
 = 
n
;

1107 *
nÜm
;

1109 
nÜm
 = 
Ãw
 [
row
];

1110 
	`mem£t
(
nÜm
, 0, ());

1111 
sd©a
.
d©a
 = 
Ãw
 [
nozÜe
];

1112 
sd©a
.
šdex
 = 
Ãw
 [
nozÜe
];

1113 
sd©a
.
cŞ
 = 
Ãw
 [
row
 + 1];

1114 
	`mem£t
(
sd©a
.
d©a
, 0, 
nozÜe
*());

1115 
	`mem£t
(
sd©a
.
šdex
, 0, 
nozÜe
*());

1116 
	`mem£t
(
sd©a
.
cŞ
, 0, (
row
+1)*());

1118 
is
.
	`ş—r
();

1119 
is
.
	`£ekg
(0, 
ios
::
beg
);

1121 
i
 = 0;

1122 
j
 = 0;

1123 
k
 = 0;

1124 
cŞ
 = 0;

1125 
is
>>
n
)

1127 
sd©a
.
cŞ
[
i
] = 
k
;

1128 
j
 = 0; j < 
n
; j++)

1130 
is
>>
tmp1
>>
tmp2
;

1131 
sd©a
.
d©a
[
k
] = 
tmp2
;

1132 
sd©a
.
šdex
[
k
] = 
tmp1
;

1133 if(
tmp1
 > 
cŞ
)

1134 
cŞ
 = 
tmp1
;

1135 
k
++;

1136 
nÜm
[
i
] +ğ
tmp2
*tmp2;

1138 
i
++;

1140 
cŞ
++;

1141 
sd©a
.
cŞ
[
i
] = 
k
;

1145 
i
 = 0; i < 
row
; i++)

1147 
j
 = 
sd©a
.
cŞ
[
i
]; j < sdata.col[i+1]; j++)

1149 
sd©a
.
d©a
[
j
] /ğ
nÜm
[
i
];

1154 
is
.
	`şo£
();

1155 
d–‘e
 [] 
nÜm
;

1156  
sd©a
;

1157 
	}
}

1159 
	gIOAg’t
::
	$g‘M©rixInfo
(cÚ¡ *
m©â
, &
row
, &
cŞ
)

1161 
if¡»am
 
šSŒm
;

1162 
row
 = 0;

1163 cÚ¡ *
loc
 = 
NULL
;

1164 
¡ršg
 
¡r
;

1165 
tmpDim
 = 0;

1166 if(
VSŒšg
::
	`’dW™h
(
m©â
, ".fvecs"))

1168 
šSŒm
.
	`İ’
(
m©â
, 
ios
::
š
|ios::
bš¬y
);

1169 
bg
 = 
šSŒm
.
	`‹Îg
();

1170 
šSŒm
.
	`»ad
((*)&
tmpDim
, ());

1171 
šSŒm
.
	`£ekg
(0, 
ios
::
’d
);

1172 
sz
 = 
šSŒm
.
	`‹Îg
();

1173 
cŞ
 = 
tmpDim
;

1174 
row
 = (
sz
 - 
bg
)/((è+ 
cŞ
*());

1176 if(
VSŒšg
::
	`’dW™h
(
m©â
, ".txt"))

1178 
šSŒm
.
	`İ’
(
m©â
, 
ios
::
š
);

1179 
šSŒm
>>
row
>>
cŞ
;

1181 if(
VSŒšg
::
	`’dW™h
(
m©â
, ".dat"))

1183 
šSŒm
.
	`İ’
(
m©â
, 
ios
::
š
);

1184 if(!
šSŒm
.
	`is_İ’
())

1186 
cout
<<"F"<<
m©â
<<" cannot open for„ead!\n";

1187 
	`ex™
(0);

1190 
	`g‘lše
(
šSŒm
,
¡r
);

1191 
loc
 = 
¡r
.
	`c_¡r
();

1192 
row
 = 
	`©oi
(
loc
);

1193 
loc
 = 
	`¡r¡r
(loc+1, " ");

1194 
cŞ
 = 
	`©oi
(
loc
+1);

1196 
šSŒm
.
	`şo£
();

1197  
row
;

1198 
	}
}

1200 *
	gIOAg’t
::
lßdM©rix
(
veùÜ
<
¡ršg
> &
f’ames
, &
row
, &
cŞ
)

1202 
	gv®s
[2] = {0};

1203 
	gi
 = 0, 
	gj
 = 0;

1204 
	grow
 = 0;

1205 
	gcŞ
 = 0;

1207 
if¡»am
 *
	gšSŒ
 = 
Ãw
 ifstream();

1209 
	gi
 = 0; i < 
	gf’ames
.
size
(); i++)

1211 
	gšSŒ
->
İ’
(
f’ames
[
i
], 
ios
::
š
);

1212 if(!
	gšSŒ
->
is_İ’
())

1214 
	gcout
<<"FaØ»ad "<<
	gf’ames
[
i
]<<
	g’dl
;

1215 
d–‘e
 
	gšSŒ
;

1216 
ex™
(0);

1218 (*
	gšSŒ
)>>
	gv®s
[0];

1219 (*
	gšSŒ
)>>
	gv®s
[1];

1220 
	gcŞ
 = ()
round
(
v®s
[1]);

1221 
	grow
 +ğ()
round
(
v®s
[0]);

1222 
	gšSŒ
->
şo£
();

1224 *
	gm©
 = 
Ãw
 [
row
*
cŞ
];

1225 
mem£t
(
m©
, 0, ()*
row
*
cŞ
);

1226 *
	gtmp
 = 
Ãw
 [
cŞ
];

1227 
	gœow
, 
	gidim
, 
	gloc
;

1229 
	gloc
 = 0;

1230 
	gi
 = 0; i < 
	gf’ames
.
size
(); i++)

1233 
	gšSŒ
->
İ’
(
f’ames
[
i
], 
ios
::
š
);

1234 if(
	gšSŒ
->
ç
())

1236 
	gcout
<<"FaØ»ad "<<
	gf’ames
[
i
]<<
	g’dl
;

1237 
d–‘e
 
	gšSŒ
;

1238 
ex™
(0);

1241 (*
	gšSŒ
)>>
	gv®s
[0];

1242 (*
	gšSŒ
)>>
	gv®s
[1];

1244 
	gœow
 = ()
round
(
v®s
[0]);

1246 
	gj
 = 0; j < 
	gœow
; j++)

1248 
	gidim
 = 0; idim < 
	gcŞ
; idim++)

1250 (*
	gšSŒ
è>>
	gtmp
[
idim
];

1252 
	gidim
 = 0; idim < 
	gcŞ
; idim++)

1254 
	gm©
[
loc
 + 
idim
] = 
tmp
[idim];

1256 
mem£t
(
tmp
, 0, ()*
idim
);

1257 
	gloc
 +ğ
cŞ
;

1259 
	gšSŒ
->
şo£
();

1260 
as£¹
(
œow
 > 0);

1263 
d–‘e
 
	gšSŒ
;

1264 
	gd–‘e
 [] 
	gtmp
;

1265  
	gm©
;

1268 *
	gIOAg’t
::
lßd_fvecs
(
veùÜ
<
¡ršg
> &
f’ames
, &
r
, &
d
)

1271 *
	gm©
 = 
NULL
, *
	gveù
 = NULL, *
	gµm©
 = NULL;

1272 
	gdi
 = 0, 
	gœ
 = 0, 
	gi
 = 0;

1273 
	gd
 = 0;

1274 
	gbg
 = 0, 
	gfsize
 = 0, 
	gbfsz
 = 0;

1275 *
	gtm´
 = 
NULL
;

1276 
	gtm´
 = 
Ãw
 [
f’ames
.
size
()];

1277 
if¡»am
 *
	gšSŒm
 = 
Ãw
 ifstream();

1279 
	gr
 = 0;

1280 
	gi
 = 0; i < 
	gf’ames
.
size
(); i++)

1283 
	gšSŒm
->
İ’
(
f’ames
[
i
], 
ios
::
š
|ios::
bš¬y
);

1284 if(!
	gšSŒm
->
is_İ’
())

1286 
	gcout
<<"F'"<<
	gf’ames
[
i
]<<"' cannot open for„ead!\n";

1287  
	gNULL
;

1289 
	gbg
 = ()
šSŒm
->
‹Îg
();

1290 
	gšSŒm
->
»ad
((*)&
di
, ());

1291 
	gd
 = 
di
;

1292 
	gbfsz
 = 
d
*();

1293 
	gšSŒm
->
£ekg
(0, 
ios
::
’d
);

1294 
	gfsize
 = ()
šSŒm
->
‹Îg
(è- 
bg
;

1295 
	gšSŒm
->
şo£
();

1296 
	gtm´
[
i
] = 
fsize
/((è+ 
bfsz
);

1297 
	gr
 +ğ
tm´
[
i
];

1299 if(
	gr
 == 0)

1301 
cout
<<"No data has been†oaded!\n";

1302 
	gr
 = 
d
 = 0;

1303  
	gNULL
;

1305 
	gveù
 = 
Ãw
 [
d
];

1306 
	gm©
 = 
Ãw
 [
r
*
d
];

1307 
mem£t
(
m©
, 0, ()*
r
*
d
);

1308 
	gµm©
 = 
m©
;

1309 
	gi
 = 0; i < 
	gf’ames
.
size
(); i++)

1311 
	gšSŒm
->
İ’
(
f’ames
[
i
], 
ios
::
š
|ios::
bš¬y
);

1312 
	gœ
 = 0;

1313 !
	gšSŒm
->
eof
(è&& 
	gœ
 < 
	gtm´
[
i
])

1315 
	gšSŒm
->
»ad
((*)&
di
, ());

1317 if(
	gdi
 == 0)

1320 
	gbfsz
 = 
di
*();

1321 
	gšSŒm
->
»ad
((*)
veù
, 
bfsz
);

1322 
memıy
(
µm©
, 
veù
, 
bfsz
);

1323 
mem£t
(
veù
, 0, 
bfsz
);

1324 
	gµm©
 = 
µm©
 + 
d
;

1325 
	gdi
 = 0;

1326 
	gœ
++;

1328 
	gšSŒm
->
şo£
();

1330 
	gd–‘e
 [] 
	gveù
;

1331 
	gveù
 = 
NULL
;

1332  
	gm©
;

1335 *
	gIOAg’t
::
lßdD©
(
veùÜ
<
¡ršg
> &
f’ames
, &
row
, &
cŞ
)

1338 *
	gm©
 = 
NULL
;

1339 
¡ršg
 
	g¡r
;

1340 
	gid
, 
	gj
, 
	gi
, 
	growid
, 
	gœow
;

1341 
	gd©a
;

1342 cÚ¡ *
	gloc
 = 
NULL
;

1344 
if¡»am
 
	gšSŒm
;

1345 
	gi
 = 0; i < 
	gf’ames
.
size
(); i++)

1347 
	gšSŒm
.
İ’
(
f’ames
[
i
], 
ios
::
š
);

1348 if(!
	gšSŒm
.
is_İ’
())

1350 
	gcout
<<"F"<<
	gf’ames
[
i
]<<" cannot open for„ead!\n";

1351 
ex™
(0);

1354 
g‘lše
(
šSŒm
,
¡r
);

1355 
	gloc
 = 
¡r
.
c_¡r
();

1356 
	grow
 +ğ
©oi
(
loc
);

1357 
	gloc
 = 
¡r¡r
(
loc
+1, " ");

1358 
	gcŞ
 = 
©oi
(
loc
+1);

1359 
	gšSŒm
.
şo£
();

1361 
	gm©
 = 
Ãw
 [
row
*
cŞ
];

1362 
mem£t
(
m©
, 0, 
row
*
cŞ
*());

1364 
	growid
 = 0;

1365 
	gj
 = 0; j < 
	gf’ames
.
size
(); j++)

1367 
	gšSŒm
.
İ’
(
f’ames
[
i
], 
ios
::
š
);

1368 
g‘lše
(
šSŒm
,
¡r
);

1369 
	gloc
 = 
¡r
.
c_¡r
();

1370 
	gœow
 +ğ
©oi
(
loc
);

1372 
g‘lše
(
šSŒm
,
¡r
);

1373 
	gloc
 = 
¡r
.
c_¡r
();

1374 
	gloc
 !ğ
NULL
)

1376 *
loc
 == ' ')

1377 
loc
++;

1378 
	gid
 = 
©oi
(
loc
) ;

1379 
	gloc
 = 
¡r¡r
(
loc
, " ");

1380 *
	gloc
 == ' ')

1381 
loc
++;

1382 
	gd©a
 = 
©of
(
loc
);

1383 
	gloc
 = 
¡r¡r
(
loc
, " ");

1384 
	gm©
[
rowid
+
id
-1] = 
d©a
;

1386 
	growid
 +ğ
cŞ
;

1388 
	gšSŒm
.
şo£
();

1390 
	gšSŒm
.
şo£
();

1391  
	gm©
;

1395 
	gIOAg’t
::
	$§veD©
(cÚ¡ * 
â
, cÚ¡ & 
row
, cÚ¡ &
cŞ
, *
D©
)

1397 
i
, 
j
;

1398 
of¡»am
 
	`ofSŒm
(
â
);

1399 if(!
ofSŒm
.
	`is_İ’
())

1401 
cout
<<"F"<<
â
<<" cannot open for write!\n";

1402 
	`ex™
(0);

1405 
couÁ”
 = 0;

1406 
i
 = 0; i < 
row
; i++)

1408 
j
 = 0; j < 
cŞ
; j++)

1410 if(
D©
[
i
*
cŞ
 + 
j
] != 0)

1411 
couÁ”
++;

1415 
ofSŒm
<<
row
<<" "<<
cŞ
<<" "<<
couÁ”
<<"\n";

1417 
i
 = 0; i < 
row
; i++)

1419 
j
 = 0; j < 
cŞ
; j++)

1421 if(
D©
[
i
*
cŞ
 + 
j
] != 0)

1423 
ofSŒm
<<" "<<(
j
+1)<<" "<<
D©
[
i
*
cŞ
 + j];

1426 
ofSŒm
<<"\n";

1429 
ofSŒm
.
	`şo£
();

1430 
	}
}

1432 
	gIOAg’t
::
	$§veD©
(cÚ¡ * 
â
, cÚ¡ & 
row
, cÚ¡ &
cŞ
, *
D©
)

1434 
i
, 
j
;

1435 
of¡»am
 
	`ofSŒm
(
â
);

1436 if(!
ofSŒm
.
	`is_İ’
())

1438 
cout
<<"F"<<
â
<<" cannot open for write!\n";

1439 
	`ex™
(0);

1441 
ofSŒm
<<
row
<<" "<<
cŞ
<<" "<<"\n";

1443 
i
 = 0; i < 
row
; i++)

1445 
j
 = 0; j < 
cŞ
; j++)

1448 
ofSŒm
<<(
D©
[
i
*
cŞ
 + 
j
])<<" ";

1450 if(
i
%1000 == 0)

1451 
cout
<<
i
<<" "<<(
D©
[i*
cŞ
])<<
’dl
;

1452 
ofSŒm
<<"\n";

1455 
ofSŒm
.
	`şo£
();

1456 
	}
}

1458 
boŞ
 
	gIOAg’t
::
»adFeName
(cÚ¡ *
¤cdœ
,
veùÜ
< 
¡ršg
 > &
f’ame
)

1460 
DIR
 *
	g¤cdp
 = 
NULL
;

1461 
dœ’t
 *
	g»suÉ
 = 
NULL
, 
	g’Œy
;

1462 if((
	g¤cdp
 = 
İ’dœ
(
¤cdœ
)è=ğ
NULL
)

1464 
cout
<<"Sourû dœeùÜy '"<<
¤cdœ
<<"' do‚otƒxist!\n";

1465  
	gçl£
;

1467 
»addœ_r
(
¤cdp
, &
’Œy
, &
»suÉ
è=ğ0 &&„esuÉ !ğ
NULL
)

1470 if(!
¡rcmp
(
’Œy
.
d_Çme
, ".") || !strcmp(entry.d_name, ".."))

1472 
	gf’ame
.
push_back
(
’Œy
.
d_Çme
);

1475  
	gŒue
;

1477 
	gIOAg’t
::
§veEx
(
veùÜ
<
¡ršg
> &
f’ames
, *
e
, *
p
, cÚ¡ *
exfe
)

1479 
of¡»am
 
oSŒ
(
exfe
);

1480 if(!
	goSŒ
.
is_İ’
())

1482 
	gcout
<<"\nÿÁ‚Ù o³Àf"<<
	gexfe
<<" fÜ wr™e"<<
	g’dl
;

1483 
ex™
(0);

1485 
	goSŒ
<<
£tw
(8)<<"dataset"<<"\t"<<setw(8)<<"k=5"<<"\t"<<setw(8)<<"k=10"<<"\t"<<setw(8)<<"k=15"<<"\t"<<setw(8)<<"k=20"<<"\t";

1486 
	goSŒ
<<
£tw
(8)<<"p=5"<<"\t"<<£tw(8)<<"p=10"<<"\t"<<£tw(8)<<"p=15"<<"\t"<<£tw(8)<<"p=20"<<"\t"<<
	g’dl
;

1488 
	gs
 =
f’ames
.
size
();

1489 
	gid
 = 0;

1490 
	gi
 = 0; i < 
	gs
; i++)

1492 
	goSŒ
<<
£tw
(8)<<
	gf’ames
[
i
]<<"\t"<<£tw(8)<<
	ge
[
id
+0]<<"\t"<<setw(8)<<e[id+1]<<"\t"<<setw(8)<<e[id+2]<<"\t"<<setw(8)<<e[id+3]<<"\t";

1493 
	goSŒ
<<
£tw
(8)<<
	gp
[
id
+0]<<"\t"<<£tw(8)<<p[id+1]<<"\t"<<£tw(8)<<p[id+2]<<"\t"<<£tw(8)<<p[id+3]<<
	g’dl
;

1494 
	gid
 += 4;

1497 
	goSŒ
.
şo£
();

1500 
S·r£M©rix
 
	gIOAg’t
::
	$lßdS·r£
(cÚ¡ *
â
, &
row
, &
cŞ
)

1502 
S·r£M©rix
 
sd©a
;

1503 
¡ršg
 
¡r
;

1504 
id
, 
i
, 
nozÜe
, 
j
;

1505 
d©a
;

1506 cÚ¡ *
loc
 = 
NULL
;

1508 
if¡»am
 
	`šSŒm
(
â
);

1509 if(!
šSŒm
.
	`is_İ’
())

1511 
cout
<<"F'"<<
â
<<"' cannot open for„ead!\n";

1512 
	`ex™
(0);

1515 
	`g‘lše
(
šSŒm
,
¡r
);

1516 
loc
 = 
¡r
.
	`c_¡r
();

1517 
row
 = 
	`©oi
(
loc
);

1518 
loc
 = 
	`¡r¡r
(loc+1, " ");

1519 
cŞ
 = 
	`©oi
(
loc
+1);

1520 
loc
 = 
	`¡r¡r
(loc+1, " ");

1521 
nozÜe
 = 
	`©oi
(
loc
+1);

1522 
sd©a
.
d©a
 = 
Ãw
 [
nozÜe
];

1523 
sd©a
.
šdex
 = 
Ãw
 [
nozÜe
];

1524 
sd©a
.
cŞ
 = 
Ãw
 [
row
 + 1];

1525 
	`mem£t
(
sd©a
.
d©a
, 0, 
nozÜe
*());

1526 
	`mem£t
(
sd©a
.
šdex
, 0, 
nozÜe
*());

1527 
	`mem£t
(
sd©a
.
cŞ
, 0, (
row
+1)*());

1529 
cout
<<"row\t"<<
row
<<"\tcŞ\t"<<
cŞ
<<"\n";

1531 
j
 = 0;

1532 
i
 = 0; i < 
row
; i++)

1534 
	`g‘lše
(
šSŒm
,
¡r
);

1535 
loc
 = 
¡r
.
	`c_¡r
();

1536 
sd©a
.
cŞ
[
i
] = 
j
;

1537 
loc
 !ğ
NULL
)

1539 *
loc
 == ' ')

1540 
loc
++;

1541 
id
 = 
	`©oi
(
loc
) ;

1542 
loc
 = 
	`¡r¡r
(loc, " ");

1543 *
loc
 == ' ')

1544 
loc
++;

1545 
d©a
 = 
	`©of
(
loc
);

1546 
loc
 = 
	`¡r¡r
(loc, " ");

1547 
sd©a
.
d©a
[
j
] = data;

1548 
sd©a
.
šdex
[
j
] = 
id
 - 1;

1549 
j
++;

1552 if(
i
 =ğ
row
 -1)

1553 
sd©a
.
cŞ
[
row
] = 
j
;

1556 
šSŒm
.
	`şo£
();

1557  
sd©a
;

1558 
	}
}

1559 
	gIOAg’t
::
	$addR¦t
(cÚ¡ *
f’ame
, *
e
, *
p
, cÚ¡ *
»suÉ
)

1561 
of¡»am
 
	`oSŒ
(
»suÉ
, 
ios
::
out
 | ios::
­p
);

1562 if(!
oSŒ
.
	`is_İ’
())

1564 
cout
<<"\nÿÁ‚Ù o³Àf"<<
»suÉ
<<" fÜ wr™e"<<
’dl
;

1565 
	`ex™
(0);

1567 
oSŒ
<<
	`£tw
(8)<<
f’ame
<<"\t"<<£tw(8)<<
e
[0]<<"\t"<<setw(8)<<e[1]<<"\t"<<setw(8)<<e[2]<<"\t"<<setw(8)<<e[3]<<"\t";

1568 
oSŒ
<<
	`£tw
(8)<<
p
[0]<<"\t"<<£tw(8)<<p[1]<<"\t"<<£tw(8)<<p[2]<<"\t"<<£tw(8)<<p[3]<<
’dl
;

1569 
oSŒ
.
	`şo£
();

1570 
	}
}

1572 
	gIOAg’t
::
	$§veAsFuÎM©
(cÚ¡ * 
d©
, &
row
, &
cŞ
, cÚ¡ *
fe
)

1574 
of¡»am
 
	`oSŒ
(
fe
);

1575 if(!
oSŒ
.
	`is_İ’
())

1577 
cout
<<"f"<<
fe
<<" can‚ot open for write full mat\n";

1578 
	`ex™
(0);

1580 
loc
 = 0, 
i
 = 0, 
j
 = 0;

1581 
i
 = 0; i < 
row
; i++)

1583 
j
 = 0; j < 
cŞ
; j++)

1585 
oSŒ
<<
d©
[
loc
 + 
j
]<<" ";

1587 
loc
 +ğ
cŞ
;

1588 
oSŒ
<<"\n";

1590 
oSŒ
.
	`şo£
();

1591 
	}
}

1592 
	gIOAg’t
::
	$§veS·r£
(cÚ¡ * 
â
, cÚ¡ & 
row
, cÚ¡ &
cŞ
, cÚ¡ 
S·r£M©rix
 &
sd©a
)

1594 
of¡»am
 
	`ofSŒm
(
â
);

1595 if(!
ofSŒm
.
	`is_İ’
())

1597 
cout
<<"F'"<<
â
<<"' cannot open for write!\n";

1598 
	`ex™
(0);

1601 
couÁ”
 = 
sd©a
.
cŞ
[
row
];

1604 
ofSŒm
<<
row
<<" "<<
cŞ
<<" "<<
couÁ”
<<"\n";

1606 
i
 = 0; i < 
row
; i++)

1608 
j
 = 
sd©a
.
cŞ
[
i
]; j < sdata.col[i+1]; j++)

1610 
ofSŒm
<<" "<<
sd©a
.
šdex
[
j
]+1<<" "<<sd©a.
d©a
[j];

1612 
ofSŒm
<<"\n";

1615 
ofSŒm
.
	`şo£
();

1616 
	}
}

1618 
	gIOAg’t
::
lßdClu¡
(cÚ¡ *
â
, 
m­
<, 
£t
<> *> &
şu¡”
)

1622 
if¡»am
 
is
(
â
);

1623 if(!
	gis
.
is_İ’
())

1625 
	gcout
<<"f"<<
	gâ
<<" can‚ot opened for„ead"<<"\n";

1626 
ex™
(0);

1629 
	gtmp
, 
	gtmp1
, 
	gi
, 
	gj
;

1630 
	g£t
<> *
	gtmp£t
;

1632 
	gj
 = 0;

1633 
	gis
>>
	gtmp
)

1635 
	gj
++;

1636 
	gtmp£t
 = 
Ãw
 
£t
<>;

1637 
	gi
 = 0; i < 
	gtmp
; i++)

1639 
	gis
>>
	gtmp1
;

1640 
	gtmp£t
->
š£¹
(
tmp1
);

1643 
	gşu¡”
.
š£¹
(
·œ
<, 
£t
<>* >(
j
, 
tmp£t
));

1646 
	gis
.
şo£
();

1649 
	gIOAg’t
::
lßdmClu¡
(cÚ¡ *
¤cFn
, 
m­
<, 
£t
<> *> &
şu¡s
)

1657 
¡ršg
 
	gtmp
;

1658 
	gveùÜ
<
	g¡ršg
> 
	gşu¡
;

1659 
	g£t
<
	g¡ršg
> 
	g‹mp
;

1660 
	g£t
<
	g¡ršg
>::
™”©Ü
 
™
;

1661 
	gm­
<
	g¡ršg
, > 
	gmp
;

1662 
	gi
;

1664 if(
	gşu¡s
.
size
())

1666 
	gcout
<<"ş—¸şu¡ *******"<<
	g’dl
;

1667 
	gCËª”
::
ş—rClu¡
(
şu¡s
);

1670 
if¡»am
 
šSŒ
(
¤cFn
);

1672 if(!
	gšSŒ
.
is_İ’
())

1674 
	gcout
<<"Ev®u©Ü::lßdClu¡ o³Àf"<<
	g¤cFn
<<" fa"<<
	g’dl
;

1675 
ex™
(0);

1677 
	gšSŒ
>>
	gtmp
)

1679 
	gşu¡
.
push_back
(
tmp
);

1682 
	gšSŒ
.
şo£
();

1685 
	gs
 = 
şu¡
.
size
();

1686 
	gi
 = 0; i < 
	gs
; i++)

1688 
	g‹mp
.
š£¹
(
şu¡
[
i
]);

1691 
	gi
 = 0;

1692 
	g™
 = 
‹mp
.
begš
(); iˆ!ğ‹mp.
’d
(); it++)

1694 
	g£t
<> * 
	gtmpşu¡
 = 
Ãw
 
£t
<>;

1695 
	gmp
.
š£¹
(
·œ
<
¡ršg
,>(*
™
, 
i
));

1696 
	gşu¡s
.
š£¹
(
·œ
<, 
£t
<> *>(
i
, 
tmpşu¡
));

1697 
	gi
++;

1701 
	gi
 = 0; i < 
	gs
; i++)

1703 
	gşu¡s
[
mp
[
şu¡
[
i
]]]->
š£¹
(i);

1706 
	gşu¡
.
ş—r
();

1711 
	gIOAg’t
::
§vekÂG¿ph
(cÚ¡ *
kÂG¿ph
, 
row
, 
dim
,

1712 
m­
<, > &
idM­
, cÚ¡ *
d¡Fn
)

1714 
of¡»am
 *
	goutSŒm
 = 
Ãw
 of¡»am(
d¡Fn
, 
ios
::
out
);

1715 
	gidx
 = 0, 
	gi
 = 0, 
	gj
 = 0, 
	gid1
 = 0, 
	gid2
 = 0;

1717 (*
	goutSŒm
)<<
	grow
<<" "<<
	gdim
<<
	g’dl
;

1718 
	gi
 = 0; i < 
	grow
; i++)

1720 
	gid1
 = 
idM­
[
i
];

1721 (*
	goutSŒm
)<<
	gid1
;

1722 
	gj
 = 0; j < 
	gdim
; j++)

1724 
	gidx
 = 
kÂG¿ph
[
i
*
dim
+
j
];

1725 
	gid2
 = 
idM­
[
idx
];

1726 (*
	goutSŒm
)<<" "<<
	gid2
;

1728 (*
	goutSŒm
)<<
	g’dl
;

1731 
	goutSŒm
->
şo£
();

1734 
	gIOAg’t
::
§veClu¡
(cÚ¡ *
â
, 
m­
<, 
£t
<> *> &
şu¡”
)

1736 
of¡»am
 
os
(
â
);

1737 if(!
	gos
.
is_İ’
())

1739 
	gcout
<<"f"<<
	gâ
<<" can‚ot opened for write"<<"\n";

1740 
ex™
(0);

1743 
	gi
, 
	gn
, 
	gs
;

1744 
	g£t
<>::
™”©Ü
 
™
;

1745 
	g£t
<> *
	gp£t
;

1746 
	gn
 = 
şu¡”
.
size
();

1747 
	gi
 = 0; i < 
	gn
; i++)

1749 
	gp£t
 = 
şu¡”
[
i
];

1750 
	gs
 = 
p£t
->
size
();

1751 
	gos
<<
	gs
<<"\t";

1752 
	g™
 = 
p£t
->
begš
(); iˆ!ğp£t->
’d
(); it++)

1754 
	gos
<<*
	g™
<<"\t";

1756 
	gos
<<"\n";

1759 
	gos
.
şo£
();

1762 
	gIOAg’t
::
	$‹¡
()

1764 cÚ¡ *
·th
 ="/home/pclin/nns_benchmark-master/data/glove1m/grd/glove1m_gold_knn40.txt";

1765 
row
,
dim
;

1766 
IOAg’t
 *
io
 = 
Ãw
 
	`IOAg’t
();

1767 
io
->
	`lßdgroundŒuth
(
·th
,
row
,
dim
);

1768 
	}
}

	@/home/pclin/cpp/gkmeans/ioagent.h

1 #iâdeà
IOAGENT_H


2 
	#IOAGENT_H


	)

4 
	~"¥¬£m©rix.h
"

6 
	~<¡ršg
>

7 
	~<veùÜ
>

8 
	~<m­
>

9 
	~<£t
>

11 
usšg
 
	g¡d
::
£t
;

12 
usšg
 
	g¡d
::
m­
;

13 
usšg
 
	g¡d
::
veùÜ
;

14 
usšg
 
	g¡d
::
¡ršg
;

16 şas 
	cIOAg’t


18 
	mpublic
:

19 
	$IOAg’t
() {}

20 
vœtu®
 ~
	$IOAg’t
(è{
	}
}

21 *
lßd_fvecs
(cÚ¡ *
fvecâ
, &
r
, &
d
);

22 *
lßd_fvecs
(
veùÜ
<
¡ršg
> &
f’ames
, &
r
, &
d
);

23 *
lßd_bvecs
(cÚ¡ *
bvecâ
, &
r
, &
d
);

24 *
lßd_bvecs
(cÚ¡ *
bvecâ
, &
r
, &
d
, 
row
);

26 *
lßdKNNG
(cÚ¡ *
¤cFn
, &
row
, &
dim
);

27 *
lßdKNNG1
(cÚ¡ *
¤cFn
, &
row
, &
dim
);

28 
m”gKNNG
(cÚ¡ *
kÂgFn1
, cÚ¡ *
kÂgFn2
, cÚ¡ *
d¡KÂg
);

30 *
lßdM©rix
(cÚ¡ *
â
, &
row
, &
cŞ
);

31 *
lßdM©rix
(
veùÜ
<
¡ršg
> &
f’ames
, &
row
, &
cŞ
);

32 *
lßdIM©
(cÚ¡ *
¤câ
, &
row
, &
cŞ
);

33 *
lßdD©
(cÚ¡ *
¤câ
, &
row
, &
cŞ
);

34 *
lßdD©
(
veùÜ
<
¡ršg
> &
f’ames
, &
row
, &
cŞ
);

35 *
lßdPQ
(cÚ¡ *
¤câ
, &
row
, &
cŞ
);

36 * 
lßdPQInfo
(cÚ¡ *
¤câ
, &
pqn
, &
pql
, &
pqm
);

37 *
lßdNN
(cÚ¡ *
Ââ
, &
row
, &
cŞ
);

39 *
lßdgroundŒuth
(cÚ¡ *
gtd¡
,&
row
,&
dim
);

41 *
lßdItms
(cÚ¡ *
â
, cÚ¡ *
idxKey
, &
row
, &
cŞ
);

42 *
lßdItms
(cÚ¡ *
â
, cÚ¡ *
idxKey
, cÚ¡ 
lše
, &
row
, &
cŞ
);

43 
S·r£M©rix
 
lßdBOVW
(cÚ¡ *
â
, &
row
, &
cŞ
);

44 
S·r£M©rix
 
lßdS·r£
(cÚ¡ *
â
, &
row
, &
cŞ
);

46 
g‘M©rixInfo
(cÚ¡ *
m©â
, &
cŞ
, &
row
);

48 
§veD©
(cÚ¡ *
â
, cÚ¡ &
row
, cÚ¡ &
cŞ
,*
D©
);

49 
§veD©
(cÚ¡ * 
â
, cÚ¡ & 
row
, cÚ¡ &
cŞ
, *
D©
);

50 
§veS·r£
(cÚ¡ * 
â
, cÚ¡ & 
row
, cÚ¡ &
cŞ
, cÚ¡ 
S·r£M©rix
 &
sd©a
);

51 *
lßdTruncM©
(cÚ¡ *
¤cFn
, &
row
, &
dim
, 
veùÜ
<> &
ids
);

52 
§veTruncM©
(cÚ¡ *
d¡Fn
, cÚ¡ 
dim
, *
m©
, 
£t
<> &
ids
);

53 
boŞ
 
»adFeName
(cÚ¡ * 
¤cdœ
, 
veùÜ
<
¡ršg
 >& 
f’ame
);

54 
§veEx
(
veùÜ
<
¡ršg
> &
f’ames
, *
e
, *
p
, cÚ¡ *
»suÉ
);

55 
addR¦t
(cÚ¡ *
f’ame
, *
e
, *
p
, cÚ¡ *
»suÉ
);

56 
§veAsFuÎM©
(cÚ¡ *
d©
, &
row
, &
cŞ
, cÚ¡ *
fe
);

57 
§vekÂG¿ph
(cÚ¡ *
kÂG¿ph
, 
row
, 
dim
,

58 
m­
<, > &
idM­
, cÚ¡ *
d¡Fn
);

60 
lßdClu¡
(cÚ¡ *
â
, 
m­
<, 
£t
<> *> &
şu¡”
);

62 
lßdmClu¡
(cÚ¡ *
¤cFn
, 
m­
<, 
£t
<> *> &
şu¡s
);

63 
§veClu¡
(cÚ¡ * 
â
, 
m­
<, 
£t
<> *>&
şu¡”
);

65 
‹¡
();

	@/home/pclin/cpp/gkmeans/main.cpp

1 
	~<io¡»am
>

2 
	~<f¡»am
>

4 
	~"missiÚag’t.h
"

5 
	~"Âgkm—ns.h
"

6 
	~"ev®u©Ü.h
"

8 
usšg
 
Çme¥aû
 
	g¡d
;

10 
	$‹¡
( )

15 
NNGKM—ns
::
	`PC‹¡
();

17 
	}
}

19 
	$siá100k
()

21 
i
;

22 
runs
 = 128;

23 
NNGKM—ns
 *
Âk
 = 
Ãw
 
	`NNGKM—ns
();

24 
Âk
->
»s
 = (*)
	`ÿÎoc
(
runs
*40,());

25 
i
=0;i<
runs
;i++)

28 
Âk
->
	`ä“O³¿tiÚ
();

29 
cout
<<"thruns="<<
i
+1<<
’dl
;

30 
Âk
->
num
 = 
i
;

31 
Âk
->
	`PC‹¡
();

33 
k
,
j
;

34 *
td
 = (*)
	`ÿÎoc
(
runs
,());

35 *
â
 = (*)
	`ÿÎoc
(40*4,());

36 
k
=0;k<40;k++)

38 
j
=0;j<
runs
;j++)

40 
td
[
j
] = 
Âk
->
»s
[j*40+
k
];

44 
	`sÜt
(
td
,td+
runs
);

46 
sum
 = 0;

47 
ave
 = 0;

48 
mš_v
 = 0;

49 
max_v
 = 0;

50 
med
 = 0;

51 
j
=0;j<
runs
;j++)

53 
sum
+=
td
[
j
];

55 
ave
 = 
sum
/
runs
;

56 
mš_v
 = 
td
[0];

57 
max_v
 = 
td
[
runs
-1];

58 
med
 = (
td
[
runs
/2-1]+td[runs/2])/2;

59 
â
[
k
*4+0]=
ave
;

60 
â
[
k
*4+1]=
mš_v
;

61 
â
[
k
*4+2]=
max_v
;

62 
â
[
k
*4+3]=
med
;

64 cÚ¡ *
d¡
 ="/home/pclin/nns_benchmark-master/data/sift/sift_100k/iter/res.txt";

65 
of¡»am
 *
outSŒm
 = 
Ãw
 
	`of¡»am
(
d¡
, 
ios
::
out
);

66 
k
=0;k<40;k++)

68 (*
outSŒm
)<<
k
+1<<"\t";

69 
j
=0;j<4;j++)

71 (*
outSŒm
)<<
â
[
k
*4+
j
]<<"\t";

73 (*
outSŒm
)<<
’dl
;

75 
	`ä“
(
Âk
->
»s
);

76 
	`ä“
(
td
);

77 
	`ä“
(
â
);

78 
Âk
->
»s
 =
NULL
;

79 
td
=
NULL
;

80 
â
=
NULL
;

81 
outSŒm
->
	`şo£
();

82 
	}
}

84 
	$maš
(
¬gc
, * 
¬gv
[])

86 
m­
<
¡ršg
, cÚ¡ *> 
¬gum’ts
;

87 
	`¤ªd
(
	`time
(0));

88 
	`‹¡
();

91 if(
¬gc
 < 7)

93 
cout
<<"gkmeans -i inputFn -d dstFn -k clustNum.\n";

96 
i
 = 0;

97 
skTy³
 = -1;

99 
i
 = 1; i < 
¬gc
; i += 2)

101 
¬gum’ts
.
	`š£¹
(
·œ
<
¡ršg
, cÚ¡ *>(
¬gv
[
i
],‡rgv[i+1]));

103 
MissiÚAg’t
::
	`budClu¡
(
¬gum’ts
);

105 
	}
}

	@/home/pclin/cpp/gkmeans/missionagent.cpp

1 
	~"missiÚag’t.h
"

3 
	~"ab¡¿ùkm—ns.h
"

4 
	~"Âgkm—ns.h
"

5 
	~"ev®u©Ü.h
"

6 
	~"ißg’t.h
"

7 
	~"ş—Ãr.h
"

8 
	~"v¡ršg.h
"

10 
	~<c¡ršg
>

11 
	~<¡ršg
>

12 
	~<io¡»am
>

14 
usšg
 
Çme¥aû
 
	g¡d
;

16 
boŞ
 
	gMissiÚAg’t
::
budClu¡
(
m­
<
¡ršg
, cÚ¡ *> &
¬gum’ts
)

18 cÚ¡ *
	g·¿s
[] = {"-i", "-d", "-k", "-m"};

19 
	g£ed
[16], 
	güt
[16], 
	g´r
[16];

20 
	gi
 = 0;

21 
boŞ
 
	g_»fše_
 = 
çl£
;

22 
	gi
 = 0; i < 3; i++)

24 if(
	g¬gum’ts
.
fšd
(
·¿s
[
i
]è=ğ
¬gum’ts
.
’d
())

26 
cout
<<"Requœed…¬am‘” '"<<
·¿s
[
i
]<<"' is missing!\n";

27  
	gçl£
;

30 
Ab¡¿ùKM—ns
 *
	gmykmn
 = 
NULL
;

31 
	gmykmn
 = 
Ãw
 
NNGKM—ns
();

38 if(
	g¬gum’ts
.
fšd
("-s"è!ğ
¬gum’ts
.
’d
())

40 
¡rıy
(
£ed
, 
¬gum’ts
["-s"]);

44 
¡rıy
(
£ed
, "non");

46 
¡rıy
(
£ed
, "non");

48 if(
	g¬gum’ts
.
fšd
("-r"è!ğ
¬gum’ts
.
’d
())

50 
_»fše_
 = 
Œue
;

54 if(!
¡rcmp
(
£ed
, "rnd") != 0 && !strcmp(seed, "kpp")!= 0 && strcmp(seed, "non") != 0)

56 
cout
<<" UnknowÀ£edšg o±iÚ '"<<
£ed
<<"'!\n";

57 
	gcout
<<" Valid options‡re 'rnd', 'kpp' or 'non'!\n";

58 
ex™
(0);

61 if(
	g¬gum’ts
.
fšd
("-p"è!ğ
¬gum’ts
.
’d
())

63 
¡rıy
(
´r
, 
¬gum’ts
["-p"]);

67 
¡rıy
(
´r
, "large");

70 
¡rıy
(
´r
, "large");

72 if(
¡rcmp
(
´r
, "large") != 0 && strcmp(prr, "best") != 0)

74 
cout
<<" UnknowÀ·¹™iÚ o±iÚ '"<<
´r
<<"'!\n";

75 
	gcout
<<" Valid options‡re 'large' or 'best'!\n";

76 
ex™
(0);

79 if(
	g¬gum’ts
.
fšd
("-c"è!ğ
¬gum’ts
.
’d
())

81 
¡rıy
(
üt
, 
¬gum’ts
["-c"]);

85 
¡rıy
(
üt
, "i2");

87 
¡rıy
(
üt
, "i2");

89 
	gşu¡Num
 = 
©oi
(
¬gum’ts
["-k"]);

91 if(
	gşu¡Num
 < 0 || clustNum > 2147483648)

93 
	gcout
<<" Invalid cluster‚umber!\n";

94 
	gcout
<<" Suggested„ange of cluster‚umber: 1 < k < matrix size\n";

95 
ex™
(0);

98 
	gmykmn
->
budşu¡”
(
¬gum’ts
["-i"], "", 
£ed
, 
´r
, 
üt
, 
şu¡Num
, 
çl£
);

99 
	gmykmn
->
§ve_şu¡
(
¬gum’ts
["-d"]);

101 
d–‘e
 
	gmykmn
;

103  
	gŒue
;

106 
boŞ
 
	gMissiÚAg’t
::
budKNNG
(
m­
<
¡ršg
, cÚ¡ *> &
¬gum’ts
)

108  
	gŒue
;

	@/home/pclin/cpp/gkmeans/missionagent.h

1 #iâdeà
MISSIONAGENT_H


2 
	#MISSIONAGENT_H


	)

14 
	~<c¡ršg
>

15 
	~<¡ršg
>

16 
	~<m­
>

18 
usšg
 
Çme¥aû
 
	g¡d
;

20 şas 
	cMissiÚAg’t


22 
	mpublic
:

23 
	$MissiÚAg’t
(){}

24 
vœtu®
 ~
	$MissiÚAg’t
(){
	}
}

25 
boŞ
 
budClu¡
(
m­
<
¡ršg
, cÚ¡ *> &
¬gum’ts
);

26 
boŞ
 
budKNNG
(
m­
<
¡ršg
, cÚ¡ *> &
¬gum’ts
);

	@/home/pclin/cpp/gkmeans/nn.h

1 #iâdeà
NN_H


2 
	#NN_H


	)

4 
šlše
 
In£¹IÁoKÂ
(
veùÜ
<
·œ
<, > > &
tİm­
, 
L
, 
id
, 
di¡
, &
¿dius
)

6 if(
	gtİm­
.
size
(è< 
	gL
 && 
	gdi¡
 > 
	g¿dius
)

8 
	gtİm­
.
push_back
(
·œ
<, >(
di¡
, 
id
));

9 
	g¿dius
 = 
di¡
;

12 if(
	gdi¡
 > 
	g¿dius
)

18 
	gj
;

19 
	gK
 = 
tİm­
.
size
()-1;

21 
	gi
 = 
K
;

22 
	gi
 > 0)

24 
	gj
 = 
i
 - 1;

25 ià(
	gtİm­
[
j
].
	gfœ¡
 <ğ
di¡
) ;

26 
	gi
 = 
j
;

29 
	gl
 = 
i
 + 1;

30 
	gl
 > 0)

32 
	gj
 = 
l
 - 1;

33 ià(
	gtİm­
[
j
].
	gfœ¡
 < 
	gdi¡
) ;

34 ià(
	gtİm­
[
j
].
	g£cÚd
 =ğ
id
è 
K
 + 1;

35 
	gl
 = 
j
;

38 if(
	gtİm­
.
size
(è< 
	gL
)

40 
	gtİm­
.
push_back
(
·œ
<, >(
tİm­
[
K
].
fœ¡
,İm­[K].
£cÚd
));

43 
	gj
 = 
K
;

44 
	gj
 > 
	gi
)

46 
	gtİm­
[
j
].
	gfœ¡
 = 
tİm­
[j-1].
fœ¡
;

47 
	gtİm­
[
j
].
	g£cÚd
 = 
tİm­
[j-1].
£cÚd
;

48 --
	gj
;

50 
	gtİm­
[
i
].
	gfœ¡
 = 
di¡
;

51 
	gtİm­
[
i
].
	g£cÚd
 = 
id
;

52 
	g¿dius
 = 
tİm­
[tİm­.
size
()-1].
fœ¡
;

56 
šlše
 
In£¹IÁoKÂ
 (
veùÜ
<> &
tİm­
, 
id
)

59 
	gi
, 
	gj
;

60 
	gK
 = 
tİm­
.
size
() - 1;

61 
	gl
;

63 if(
	gtİm­
.
size
(è=ğ0 || 
tİm­
[
K
] < 
id
)

65 
tİm­
.
push_back
(
id
);

68 if(
	gtİm­
[
K
] =ğ
id
)

71 
	gi
 = 
K
;

73 
	gi
 > 0)

75 
	gj
 = 
i
 - 1;

76 if(
	gtİm­
[
j
] <ğ
id
) ;

77 
	gi
 = 
j
;

81 
	gl
 = 
i
;

82 
	gl
 > 0)

84 
	gj
 = 
l
 - 1;

85 if(
	gtİm­
[
j
] =ğ
id
)  1;

86 
	gl
 = 
j
;

89 
	gtİm­
.
push_back
(
tİm­
[
K
]);

91 
	gj
 = 
K
;

92 
	gj
 > 
	gi
)

94 
	gtİm­
[
j
] = 
tİm­
[j-1];

95 --
	gj
;

97 
	gtİm­
[
i
] = 
id
;

102 
šlše
 
In£¹IÁoKÂ
 (
veùÜ
<
·œ
<, > > &
tİm­
, 
id
, 
di¡
, &
¿dius
)

105 
	gj
;

106 
	gK
 = 
tİm­
.
size
()-1;

108 
	gi
 = 
K
;

109 
	gi
 > 0)

111 
	gj
 = 
i
 - 1;

112 ià(
	gtİm­
[
j
].
	gfœ¡
 <ğ
di¡
) ;

113 
	gi
 = 
j
;

116 
	gl
 = 
i
;

117 
	gl
 > 0)

119 
	gj
 = 
l
 - 1;

120 ià(
	gtİm­
[
j
].
	gfœ¡
 < 
	gdi¡
) ;

121 ià(
	gtİm­
[
j
].
	g£cÚd
 =ğ
id
è 
K
 + 1;

122 
	gl
 = 
j
;

126 
	gj
 = 
K
;

127 
	gj
 > 
	gi
)

129 
	gtİm­
[
j
].
	gfœ¡
 = 
tİm­
[j-1].
fœ¡
;

130 
	gtİm­
[
j
].
	g£cÚd
 = 
tİm­
[j-1].
£cÚd
;

131 --
	gj
;

133 
	gtİm­
[
i
].
	gfœ¡
 = 
di¡
;

134 
	gtİm­
[
i
].
	g£cÚd
 = 
id
;

135 
	g¿dius
 = 
tİm­
[
K
].
fœ¡
;

140 
šlše
 
	$In£¹IÁoKÂ
 (*
NNG
, *
tİ
, 
tİK
, 
di¡
, 
id
, &
¿dius
)

143 
j
 = 0;

144 
K
 = 
tİK
;

145 
i
 = 
K
;

147 
i
 > 0)

149 
j
 = 
i
 - 1;

150 ià(
NNG
[
j
] =ğ
id
è 
K
 + 1;

151 
i
 = 
j
;

154 
i
 = 
tİK
;

155 
i
 > 0)

157 
j
 = 
i
 - 1;

158 ià(
tİ
[
j
] =ğ
¿dius
) ;

159 
i
 = 
j
;

163 
tİ
[
j
] = 
di¡
;

164 
NNG
[
j
] = 
id
;

166 
i
 = 
K
;

167 
¿dius
 = 0;

168 
i
 > 0)

170 
j
 = 
i
 - 1;

171 ià(
tİ
[
j
] > 
¿dius
)

172 
¿dius
 = 
tİ
[
j
];

173 
i
 = 
j
;

175  
i
;

176 
	}
}

179 
šlše
 
	$In£¹IÁoKÂ
 (*
NNG
, *
tİDi¡
, 
tİK
, 
id
, 
di¡
, &
¿dius
)

182 
j
;

183 
K
 = 
tİK
-1;

184 
i
 = 
K
;

185 
i
 > 0)

187 
j
 = 
i
 - 1;

188 ià(
tİDi¡
[
j
] <ğ
di¡
) ;

189 
i
 = 
j
;

192 
l
 = 
i
;

193 
l
 > 0)

195 
j
 = 
l
 - 1;

196 ià(
tİDi¡
[
j
] < 
di¡
) ;

197 ià(
NNG
[
j
] =ğ
id
è 
K
 + 1;

198 
l
 = 
j
;

201 
j
 = 
K
;

202 
j
 > 
i
)

204 
tİDi¡
[
j
] =opDist[j-1];

205 
NNG
[
j
] = NNG[j-1];

206 --
j
;

208 
tİDi¡
[
i
] = 
di¡
;

209 
NNG
[
i
] = 
id
;

210 
¿dius
 = 
tİDi¡
[
K
-1];

211  
i
;

212 
	}
}

214 şas 
	cNN


216 
	mk
;

217 *
	md©a
;

218 
	mrow
;

219 
	mcŞ
;

220 *
	mtİLi¡
;

221 
	m»ÿÎ
;

223 
	mpublic
:

224 
NN
();

225 
	mvœtu®
 ~
NN
();

226 
vœtu®
 
š™
() = 0;

227 
vœtu®
 
budNN
(cÚ¡ *
¤câ
, cÚ¡ *
d¡â
, &
tİk
) = 0;

228 
vœtu®
 
budNN
(*, &
row
, &
cŞ
, &
tİk
) = 0;

234 
boŞ
 
§veNN
(cÚ¡ *
d¡â
);

235 
g‘ReÿÎ
(cÚ¡ *
grdâ
);

238 
g‘ReÿÎ
(cÚ¡ *
grdâ
, cÚ¡ *
Ââ
, 
tİk
);

239 
g‘TİLi¡
(*
tİLi¡
);

240 
‹¡
();

	@/home/pclin/cpp/gkmeans/nngkmeans.cpp

1 
	~"¿ndom·¹™iÚ.h
"

2 
	~"Âgkm—ns.h
"

3 
	~"ißg’t.h
"

4 
	~"v¡ršg.h
"

5 
	~"tim”.h
"

6 
	~"Â.h
"

8 
	~<unÜd”ed_m­
>

9 
	~<®gÜ™hm
>

10 
	~<io¡»am
>

11 
	~<f¡»am
>

12 
	~<c¡ršg
>

13 
	~<iomª
>

14 
	~<ÿs£¹
>

15 
	~<c¡dlib
>

16 
	~<veùÜ
>

17 
	~<ùime
>

18 
	~<m­
>

21 
	~<time.h
>

23 
usšg
 
Çme¥aû
 
	g¡d
;

25 
	gmx
 = 50;

28 
	gtİRªge
 = 0;

29 
	gp
 = 50;

31 
	#SIFT


	)

33 cÚ¡ 
	gNNGKM—ns
::
RªgeFœ¡
 = 
mx
+
p
;

34 cÚ¡ 
	gNNGKM—ns
::
RªgeSecÚd
 = 
tİRªge
+
p
;

36 cÚ¡ 
	gNNGKM—ns
::
NI‹r
 = 30;

38 cÚ¡ 
	gNNGKM—ns
::
T»eNum
 = 16;

40 cÚ¡ 
	gNNGKM—ns
::
E¼0
 = 0;

41 cÚ¡ 
	gNNGKM—ns
::
T»esize
 = 50;

42 cÚ¡ 
	gNNGKM—ns
::
TİK
 = 40;

43 cÚ¡ 
	gNNGKM—ns
::
NNTİ
 = 20;

45 cÚ¡ 
	gNNGKM—ns
::
NBI‹r
 = 1;

49 
	gt1
 = 0, 
	gt2
 = 0, 
	gt3
 = 0, 
	gt4
 = 0, 
	gt5
 = 0, 
	gt6
 = 0, 
	gt7
 = 0, 
	gt8
 = 0, 
	gt™”
 = 0, 
	gt™”0
 = 0;

50 
	grc
;

52 
boŞ
 
šlše
 
fuLs
(cÚ¡ 
·œ
<, > &
a
, cÚ¡…aœ<, > &
b
)

54 if(
	ga
.
	gfœ¡
 =ğ
b
.
fœ¡
)

55  
a
.
£cÚd
 < 
b
.second;

56  
	ga
.
	gfœ¡
 < 
	gb
.first;

59 
	gNNGKM—ns
::
	$NNGKM—ns
()

61 
_INIT_
 = 
çl£
;

62 
this
->
d©a
 = 
NULL
;

63 
this
->
Ds
 = 
NULL
;

64 
this
->
Ns
 = 
NULL
;

65 
this
->
Es
 = 
NULL
;

66 
this
->
¬¿yD
 = 
NULL
;

67 
this
->
šfoM­
 = 
NULL
;

68 
this
->
vis™Li¡
 = 
NULL
;

69 
this
->
¿dius
 = 
NULL
;

70 
this
->
tİDi¡
 = 
NULL
;

71 
this
->
tİLi¡
 = 
NULL
;

72 
this
->
´Upd©ed
 = 
NULL
;

73 
this
->
üUpd©ed
 = 
NULL
;

74 
kmMtd
 = 
_xtkmn_
;

76 
this
->
tmLogs
 = 
NULL
;

77 
this
->
d¡Logs
 = 
NULL
;

79 
	`¡rıy
(
mthSŒ
, "_gkmeans_");

80 
cout
<<"Method ........................... GK-means\n";

81 
	}
}

83 
boŞ
 
	gNNGKM—ns
::
	$£tLogOn
(cÚ¡ 
logSize
)

85 
	`as£¹
(
logSize
 > 0);

87 
nLogs
 = 
logSize
;

88 if(
this
->
tmLogs
 !ğ
NULL
)

90 
d–‘e
 [] 
this
->
tmLogs
;

91 
this
->
tmLogs
 = 
Ãw
 [
logSize
];

93 if(
this
->
d¡Logs
 !ğ
NULL
)

95 
d–‘e
 [] 
d¡Logs
;

96 
d¡Logs
 = 
Ãw
 [
logSize
];

99 
	}
}

101 
boŞ
 
	gNNGKM—ns
::
	$š™
(cÚ¡ *
¤câ
)

103 
cout
<<"Loading matrix ................... ";

104 
	`as£¹
(
¤câ
);

105 
	`¡rıy
(
¤cm©â
, 
¤câ
);

106 
ù
 = 0, 
nd
 = 0, 
i
 = 0;

108 if(
VSŒšg
::
	`’dW™h
(
¤câ
, ".txt"))

111 
this
->
d©a
 = 
IOAg’t
::
	`lßdM©rix
(
¤câ
, 
ù
, 
nd
);

112 
this
->
couÁ
 = 
ù
;

113 
this
->
ndim
 = 
nd
;

114 
this
->
d©aTy³
 = 0;

115 
i
 = 0; i < 
ù
; i++)

117 
idx2ids
.
	`push_back
(
i
);

120 if(
VSŒšg
::
	`’dW™h
(
¤câ
, ".fvecs"))

122 
this
->
d©a
 = 
IOAg’t
::
	`lßd_fvecs
(
¤câ
, 
ù
, 
nd
);

123 
this
->
couÁ
 = 
ù
;

124 
this
->
ndim
 = 
nd
;

125 
this
->
d©aTy³
 = 0;

126 
i
 = 0; i < 
ù
; i++)

128 
idx2ids
.
	`push_back
(
i
);

131 if(
VSŒšg
::
	`’dW™h
(
¤câ
, ".bvecs"))

133 
this
->
d©a
 = 
IOAg’t
::
	`lßd_bvecs
(
¤câ
, 
ù
, 
nd
);

134 
this
->
couÁ
 = 
ù
;

135 
this
->
ndim
 = 
nd
;

136 
this
->
d©aTy³
 = 0;

137 
i
 = 0; i < 
ù
; i++)

139 
idx2ids
.
	`push_back
(
i
);

142 if(
VSŒšg
::
	`’dW™h
(
¤câ
, ".mat"))

144 
this
->
d©a
 = 
IOAg’t
::
	`lßdD©
(
¤câ
, 
ù
, 
nd
);

145 
this
->
couÁ
 = 
ù
;

146 
this
->
ndim
 = 
nd
;

147 
i
 = 0; i < 
ù
; i++)

149 
idx2ids
.
	`push_back
(
i
);

152 if(
VSŒšg
::
	`’dW™h
(
¤câ
, ".tvecs"))

154 
veùÜ
<> 
ids
;

155 
this
->
d©a
 = 
IOAg’t
::
	`lßdTruncM©
(
¤câ
, 
ù
, 
nd
, 
idx2ids
);

156 
this
->
couÁ
 = 
ù
;

157 
this
->
ndim
 = 
nd
;

158 }if(
VSŒšg
::
	`’dW™h
(
¤câ
, ".imat"))

160 
this
->
d©a
 = 
IOAg’t
::
	`lßdIM©
(
¤câ
, 
ù
, 
nd
);

161 
this
->
couÁ
 = 
ù
;

162 
this
->
ndim
 = 
nd
;

163 
i
 = 0; i < 
ù
; i++)

165 
idx2ids
.
	`push_back
(
i
);

170 
this
->
d©a
 = 
IOAg’t
::
	`lßdItms
(
¤câ
, "fsvb",his->
num
, 
ù
, 
nd
);

171 
this
->
couÁ
 = 
ù
;

172 
this
->
ndim
 = 
nd
;

173 
i
 = 0; i < 
ù
; i++)

175 
idx2ids
.
	`push_back
(
i
);

179 if(
this
->
d©a
 =ğ
NULL
)

181 
cout
<<"Exceptions ....................... Loading matrix failed!\n";

182 
	`ex™
(0);

185 
cout
<<
this
->
couÁ
<<"x"<<this->
ndim
<<
’dl
;

188 
this
->
_INIT_
 = 
Œue
;

189 
this
->
_REFER_
 = 
çl£
;

192 
cout
<<"şu¡” Num. ..................... "<<
this
->
şnumb
<<
’dl
;

193  
Œue
;

194 
	}
}

196 
boŞ
 
	gNNGKM—ns
::
	$š™
(*
m©
, cÚ¡ 
row
, cÚ¡ 
dim
)

198 
	`as£¹
(
m©
);

199 if(
this
->
d©a
 !ğ
NULL
)

201 
cout
<<"warning :„euse data before\n";

204 
this
->
d©a
 = 
m©
;

205 
this
->
couÁ
 = 
row
;

206 
this
->
ndim
 = 
dim
;

208 
cout
<<
row
<<"x"<<
dim
<<
’dl
;

210 
this
->
_INIT_
 = 
Œue
;

213  
Œue
;

214 
	}
}

216 
boŞ
 
	gNNGKM—ns
::
	$cÚfig
(cÚ¡ *
_£ed_
, cÚ¡ *
lg_fœ¡
, cÚ¡ *
üŒn
, 
v”bo£
)

218 if(
v”bo£
)

219 
cout
<<"Distance function ................†2\n";

221 if(
v”bo£
)

222 
cout
<<"Seeds ............................ ";

223 if(!
	`¡rcmp
(
_£ed_
, "rnd"))

225 if(
v”bo£
)

226 
cout
<<"rand\n";

227 
£ed
 = 
_ºd_
;

229 if(!
	`¡rcmp
(
_£ed_
, "kpp"))

232 if(
v”bo£
)

233 
cout
<<"kpp\n";

234 
£ed
 = 
_kµ_
;

238 if(
v”bo£
)

239 
cout
<<"non\n";

240 
£ed
 = 
_nÚ_
;

243 if(
v”bo£
)

244 
cout
<<"Optimization function ............ ";

245 if(!
	`¡rcmp
(
üŒn
, "i1"))

247 
myİtz
 = 
_I1_
;

248 if(
v”bo£
)

249 
cout
<<"I1\n";

251 if(!
	`¡rcmp
(
üŒn
, "i2"))

253 
myİtz
 = 
_I2_
;

254 if(
v”bo£
)

255 
cout
<<"I2\n";

257 if(!
	`¡rcmp
(
üŒn
, "i3"))

259 
myİtz
 = 
_I3_
;

260 if(
v”bo£
)

261 
cout
<<"I3\n";

263 if(!
	`¡rcmp
(
üŒn
, "i4") )

265 
myİtz
 = 
_I4_
;

266 if(
v”bo£
)

267 
cout
<<"e1\n";

269 if(!
	`¡rcmp
(
üŒn
, "e1") )

271 
myİtz
 = 
_E1_
;

272 if(
v”bo£
)

273 
cout
<<"e1\n";

275 if(!
	`¡rcmp
(
üŒn
, "e2") )

277 
myİtz
 = 
_E2_
;

278 if(
v”bo£
)

279 
cout
<<"e2\n";

281 if(!
	`¡rcmp
(
üŒn
, "t1"))

283 
myİtz
 = 
_T1_
;

284 if(
v”bo£
)

285 
cout
<<"t1\n";

287 if(!
	`¡rcmp
(
üŒn
, "i4"))

289 
myİtz
 = 
_I4_
;

290 if(
v”bo£
)

291 
cout
<<"i4\n";

295 
cout
<<"UnkowÀİtimizİtiÚ '"<<
üŒn
<<"'!\n";

296 
	`ex™
(0);

299  
Œue
;

300 
	}
}

302 
	gNNGKM—ns
::
	$upd©eNNG¿ph
()

304 
sz
 = 0;

305 
veùÜ
<> *
şu¡”s
 = 
NULL
;

306 
şu¡”s
 = 
Ãw
 
veùÜ
<>[
this
->
şnumb
];

307 
i
 = 0, 
j
 = 0, 
k
 = 0, 
id
, 
r
, 
cŞ
, 
r1
 = 0, 
r2
 = 0;

308 *
cd¡
 = 
NULL
;

309 
d¡
 = 0;

311 
this
->
	`Ïb–2şu¡”
(
şu¡”s
);

313 
mxsize
 = 0;

314 
i
 = 0; i < 
this
->
şnumb
; i++)

316 if(
şu¡”s
[
i
].
	`size
(è> 
mxsize
)

317 
mxsize
 = 
şu¡”s
[
i
].
	`size
();

320 
cd¡
 = 
Ãw
 [
mxsize
*mxsize];

322 
i
 = 0; i < 
this
->
şnumb
; i++)

325 
sz
 = 
şu¡”s
[
i
].
	`size
();

326 
j
 = 0; j < 
sz
; j++)

328 
id
 = 
şu¡”s
[
i
][
j
];

329 
k
 = 
j
 + 1; k < 
sz
; k++)

331 
r
 = 
şu¡”s
[
i
][
k
];

332 
d¡
 = 0;

333 
r1
 = 
r
*
ndim
;

334 
r2
 = 
id
*
ndim
;

335 
cŞ
 = 0; cŞ < 
ndim
; col++)

337 
d¡
 +ğ(
d©a
[
r2
+
cŞ
] - d©a[
r1
+col])*(data[r2+col] - data[r1+col]);

339 
cd¡
[
j
*
sz
+
k
] = 
d¡
;

343 
j
 = 0; j < 
sz
; j++)

345 
id
 = 
şu¡”s
[
i
][
j
];

346 
k
 = 
j
 + 1; k < 
sz
; k++)

348 
r
 = 
şu¡”s
[
i
][
k
];

349 
d¡
 = 
cd¡
[
j
*
sz
+
k
];

350 if(
d¡
 <ğ
¿dius
[
id
])

351 
	`In£¹IÁoKÂ
(
tİLi¡
+
id
*
TİK
, 
tİDi¡
+id*TİK, TİK, 
d¡
, 
r
, 
¿dius
[id]);

352 if(
d¡
 <ğ
¿dius
[
r
])

353 
	`In£¹IÁoKÂ
(
tİLi¡
+
r
*
TİK
, 
tİDi¡
+r*TİK, TİK, 
d¡
, 
id
, 
¿dius
[r]);

356 
şu¡”s
[
i
].
	`ş—r
();

358 
this
->
	`adju¡NN
();

359 
d–‘e
 [] 
cd¡
;

360 
cd¡
 = 
NULL
;

361 
d–‘e
 [] 
şu¡”s
;

362 
şu¡”s
 = 
NULL
;

365 
	}
}

367 
	gNNGKM—ns
::
	$adju¡NN
()

369 
i
, 
j
;

370 
veùÜ
<
·œ
<, > > 
tİm­
;

371 
tİm­
.
	`»size
(
TİK
);

372 
i
 = 0; i < 
this
->
couÁ
; i++)

374 
j
 = 0; j < 
this
->
TİK
; j++)

376 
tİm­
[
j
].
£cÚd
 = 
tİLi¡
[
i
*
TİK
+j];

377 
tİm­
[
j
].
fœ¡
 = 
tİDi¡
[
i
*
TİK
+j];

379 
	`sÜt
(
tİm­
.
	`begš
(),İm­.
	`’d
(), 
fuLs
);

380 
j
 = 0; j < 
this
->
TİK
; j++)

382 
tİLi¡
[
i
*
TİK
+
j
] = 
tİm­
[j].
£cÚd
;

383 
tİDi¡
[
i
*
TİK
+
j
] = 
tİm­
[j].
fœ¡
;

387 
	}
}

389 
	gNNGKM—ns
::
	$š™NNG¿ph
()

391 
i
, 
j
, 
k
, 
id
, 
rid
, 
r1
 = 0, 
r2
 = 0;

392 
d¡
 = 0, 
mxd¡
 = 0;

393 *
¾
 = 
Ãw
 [
this
->
couÁ
];

395 
i
 = 0; i < 
this
->
couÁ
; i++)

397 
¾
[
i
] = i;

400 
	`¿ndom_shufæe
(
¾
,„l+
this
->
couÁ
);

402 
i
 = 0; i < 
this
->
couÁ
; i++)

404 
rid
 = 
	`¿nd
()%
this
->
couÁ
;

405 
mxd¡
 = 0;

406 
j
 = 0; j < 
TİK
; j++)

409 
id
 = 
¾
[(
j
+
rid
)%
this
->
couÁ
];

411 if(
id
 =ğ
i
)

413 
id
 = 
¾
[(
rid
+
TİK
+1)%
this
->
couÁ
];

416 
tİLi¡
[
i
*
TİK
+
j
] = 
id
;

417 
d¡
 = 0;

418 
r1
 = 
i
*
this
->
ndim
;

419 
r2
 = 
id
*
this
->
ndim
;

420 
k
 = 0; k < 
this
->
ndim
; k++)

422 
d¡
 +ğ(
d©a
[
r1
 + 
k
]-d©a[
r2
+k])*(data[r1+k]-data[r2+k]);

424 
tİDi¡
[
i
*
TİK
+
j
] = 
d¡
;

425 if(
d¡
 > 
mxd¡
)

426 
mxd¡
 = 
d¡
;

428 
¿dius
[
i
] = 
mxd¡
;

431 
d–‘e
 [] 
¾
;

432 
¾
 = 
NULL
;

434 
	}
}

436 
	gNNGKM—ns
::
	$budNNG¿phBy2Mn
(
v”bo£
)

438 
şu¡Num
 = 0, 
i
 = 0;

439 
RªdomP¬t™iÚ
 *
½T»e
 = 
NULL
;

440 
Tim”
 *
™m
 = 
NULL
;

442 
şu¡Num
 = 
this
->
şnumb
;

443 
this
->
şnumb
 =his->
couÁ
/
T»esize
;

444 
this
->
şnumb
 = 
	`pow
(2, 
	`æoÜ
(
	`log
(this->clnumb)/log(2)));

446 if(
this
->
Ds
 !ğ
NULL
)

448 
	`ä“
(
this
->
Ds
);

449 
this
->
Ds
 = 
NULL
;

451 if(
this
->
Ns
 !ğ
NULL
)

453 
	`ä“
(
this
->
Ns
);

454 
this
->
Ns
 = 
NULL
;

456 if(
this
->
¬¿yD
 !ğ
NULL
)

458 
	`ä“
(
this
->
¬¿yD
);

459 
this
->
¬¿yD
 = 
NULL
;

461 if(
this
->
Es
 !ğ
NULL
)

463 
	`ä“
(
this
->
Es
);

464 
this
->
Es
 = 
NULL
;

467 
i
 = 0; i < 
T»eNum
; i++)

469 
½T»e
 = 
Ãw
 
RªdomP¬t™iÚ
;

470 
½T»e
->
	`budşu¡”
(
this
->
d©a
,his->
couÁ
,his->
ndim
, "tmpfe.txt", "ºd", "Ïrge", "i2",his->
şnumb
, 0);

471 
½T»e
->
	`g‘Lab–
(
this
->
Ïb–s
);

472 
d–‘e
 
½T»e
;

473 
½T»e
 = 
NULL
;

475 if(
v”bo£
)

477 
™m
 = 
Ãw
 
Tim”
;

478 
™m
->
	`¡¬t
();

480 if(
i
 > 0)

482 
this
->
Es
 = (*)
	`ÿÎoc
Ñhis->
şnumb
, ());

483 
this
->
¬¿yD
 = (*)
	`ÿÎoc
Ñhis->
şnumb
,his->
ndim
*());

484 
this
->
Ds
 = (*)
	`ÿÎoc
Ñhis->
şnumb
,his->
ndim
*());

485 
this
->
Ns
 = (*)
	`ÿÎoc
Ñhis->
şnumb
, ());

489 
this
->
	`İtzI2
(0, 
NNTİ
, 
NBI‹r
);

492 
	`ä“
(
this
->
Ds
);

493 
this
->
Ds
 = 
NULL
;

494 
	`ä“
(
this
->
Ns
);

495 
this
->
Ns
 = 
NULL
;

496 
	`ä“
(
this
->
¬¿yD
);

497 
this
->
¬¿yD
 = 
NULL
;

498 
	`ä“
(
this
->
Es
);

499 
this
->
Es
 = 
NULL
;

503 if(
v”bo£
)

505 
™m
->
	`’d
(
Œue
);

507 
	`upd©eNNG¿ph
();

512 
this
->
şnumb
 = 
şu¡Num
;

513  
Œue
;

514 
	}
}

516 
	gNNGKM—ns
::
	$»ÿÎ
()

518 
i
 = 0, 
j
 = 0, 
id
 = 0;

520 
tmpid
[200];

521 *
¹İ
 = 
Ãw
 [200*
this
->
couÁ
];

522 
if¡»am
 
is
;

523 if(
this
->
couÁ
 =ğ1000000 &&his->
ndim
 == 128)

524 
is
.
	`İ’
("sift_base200nn.txt");

525 if(
this
->
couÁ
 =ğ100000 &&his->
ndim
 == 128)

526 
is
.
	`İ’
("nn.txt");

527 if(
this
->
couÁ
 >ğ5000 &&his->couÁ <ğ6000 &&his->
ndim
 == 2048)

528 
is
.
	`İ’
("ox5k200nn.txt");

529 if(
this
->
couÁ
 =ğ50000 &&his->
ndim
 == 2048)

530 
is
.
	`İ’
("ox50k200nn.txt");

531 if(
this
->
couÁ
 >ğ100000 &&his->couÁ <ğ100000+1000 &&his->
ndim
 == 2048)

532 
is
.
	`İ’
("ox100k200nn.txt");

533 if(
this
->
couÁ
 =ğ500000 &&his->
ndim
 == 960)

534 
is
.
	`İ’
("gist_learn200nn.txt");

535 if(
this
->
couÁ
 =ğ1000000 &&his->
ndim
 == 960)

536 
is
.
	`İ’
("gist_200nn.txt");

539 
cout
<<"”rØnØgroundruth fÜ couÁ "<<
this
->
couÁ
<<
’dl
;

542 if(!
is
.
	`is_İ’
())

544 
cout
<<"cant‚ot open groundturth \n";

548 
i
 = 0; i < 
this
->
couÁ
; i++)

550 
j
 = 0; j < 200; j++)

552 
is
>>
id
;

553 
tmpid
[
j
] = 
id
;

555 
j
 = 0; j < 200; j++)

556 
¹İ
[
i
*200+
j
] = 
tmpid
[j];

558 
is
.
	`şo£
();

559 
r
[4] = {0};

560 
unÜd”ed_£t
<> 
tmp£t
;

561 
b
[4] = {1,3,5,10};

562 
a
 = 0;

563 
i
 = 0; i < 
this
->
couÁ
; i++)

565 
id
 = 0; id < 4; id++)

567 
a
 = 
b
[
id
];

568 
tmp£t
.
	`ş—r
();

569 
j
 = 0; j < 
TİK
; j++)

571 if(
j
 >ğ
a
)

573 
tmp£t
.
	`š£¹
(
tİLi¡
[
i
*
TİK
+
j
]);

575 
j
 = 0; j < 1; j++)

577 
tmp£t
.
	`š£¹
(
¹İ
[
i
*200+
j
]);

579 if(
tmp£t
.
	`size
(è< 1+
a
)

581 
r
[
id
]++;

583 if(
a
 == 0)

584 
cout
<<
a
<<
’dl
;

587 
ü
[5] = {0};

588 
c
[5] = {5,10,25,50,100};

589 
i
 = 0; i < 
this
->
couÁ
; i++)

591 
id
 = 0; id < 5; id++)

593 
a
 = 
c
[
id
];

594 
tmp£t
.
	`ş—r
();

595 
j
 = 0; j < 
TİK
; j++)

597 if(
j
 >=
a
)

599 
tmp£t
.
	`š£¹
(
tİLi¡
[
i
*
TİK
+
j
]);

601 
j
 = 0; j < 
a
; j++)

603 
tmp£t
.
	`š£¹
(
¹İ
[
i
*200+
j
]);

605 
ü
[
id
] +ğ2*
a
 - 
tmp£t
.
	`size
();

608 
ùİ5
 = (
ü
[0]+0.0)/
this
->
couÁ
/5;

609 
ùİ10
 = (
ü
[1]+0.0)/
this
->
couÁ
/10;

610 
ùİ15
 = (
ü
[2]+0.0)/
this
->
couÁ
/25;

611 
ùİ20
 = (
ü
[3]+0.0)/
this
->
couÁ
/50;

612 
ùİ25
 = (
ü
[4]+0.0)/
this
->
couÁ
/100;

614 
tİ1
 = (
r
[0]+0.0)/
this
->
couÁ
;

615 
tİ10
 = (
r
[1]+0.0)/
this
->
couÁ
;

616 
tİ50
 = (
r
[2]+0.0)/
this
->
couÁ
;

617 
tİ100
 = (
r
[3]+0.0)/
this
->
couÁ
;

618 
cout
<<"»ÿÎ 1 "<<
tİ1
<<" 3 "<<
tİ10
<<" 5 "<<
tİ50
<<" 10 "<<
tİ100
<<
’dl
;

619 
cout
<<"cov” 5 "<<
ùİ5
<<" 10 "<<
ùİ10
<<" 25 "<<
ùİ15
<<" 50 "<<
ùİ20
<<" 100 "<<
ùİ25
<<
’dl
;

623 
d–‘e
 [] 
¹İ
;

624 
rc
 = 
tİ1
;

626 
	}
}

628 
	gNNGKM—ns
::
	$budNNG¿ph4şu¡
()

630 
Ttime
 = 0;

631 
şock_t
 
¡¬t
 = 0, 
fšish
 = 0;

632 
¡¬t
 = 
	`şock
();

633 
this
->
tİLi¡
 = (*)
	`ÿÎoc
Ñhis->
couÁ
, 
TİK
*());

634 
this
->
tİDi¡
 = (*)
	`ÿÎoc
Ñhis->
couÁ
, 
TİK
*());

635 
this
->
¿dius
 = (*)
	`ÿÎoc
Ñhis->
couÁ
, ());

637 
cout
<<"Bud k-NN g¿ph by GK-m—n .....‚T»ğ"<<
T»eNum
<<
’dl
;

638 
	`š™NNG¿ph
();

639 
	`budNNG¿phBy2Mn
(0);

640 
fšish
 = 
	`şock
();

641 
Ttime
 = ()(
fšish
-
¡¬t
)/
CLOCKS_PER_SEC
;

642 
this
->
tm±ime
 = 
Ttime
;

644 
	`ä“
(
tİDi¡
);

645 
	`ä“
(
¿dius
);

646 
this
->
tİDi¡
 = 
NULL
;

647 
this
->
¿dius
 = 
NULL
;

650 
	}
}

652 
	gNNGKM—ns
::
	$şu¡
(cÚ¡ 
şu¡_num
, cÚ¡ *
d¡â
, cÚ¡ 
v”bo£
)

654 
şu¡Num
 = 0, 
i
 = 0;

655 
RªdomP¬t™iÚ
 *
xbk
 = 
NULL
;

656 
t™”0
 = 
	`şock
();

658 
	`budNNG¿ph4şu¡
();

660 
this
->
Es
 = (*)
	`ÿÎoc
Ñhis->
şnumb
, ());

661 
this
->
¬¿yD
 = (*)
	`ÿÎoc
Ñhis->
şnumb
,his->
ndim
*());

662 
this
->
Ds
 = (*)
	`ÿÎoc
Ñhis->
şnumb
,his->
ndim
*());

663 
this
->
Ns
 = (*)
	`ÿÎoc
Ñhis->
şnumb
, ());

665 
i
 = 0; i < 
this
->
şnumb
; i++)

667 
	`mem£t
(
Ds
+
i
*
this
->
ndim
, 0, ()*this->ndim);

668 
	`mem£t
(
Ns
+
i
, 0, ());

671 
cout
<<"Initialize cluster by 2-Means .... ";

672 
xbk
 = 
Ãw
 
RªdomP¬t™iÚ
;

673 
xbk
->
	`budşu¡”
(
this
->
d©a
,his->
couÁ
,his->
ndim
, "tmpfe.txt", "ºd", "Ïrge", "i2",his->
şnumb
, 0);

674 
xbk
->
	`g‘Lab–
(
this
->
Ïb–s
);

675 
d–‘e
 
xbk
;

676 
cout
<<"done\n";

677 
this
->
	`İtzI2
(0,his->
TİK
, 
NI‹r
);

678 
this
->
	`ÿlAVGDi¡
Ñhis->
¬¿yD
,his->
Ns
, 
şu¡_num
,his->
šfoM­
);

679 
this
->
	`§ve_şu¡
(
d¡â
);

681 
	`ä“
(
¬¿yD
);

682 
	`ä“
(
Es
);

683 
	`ä“
(
Ds
);

684 
	`ä“
(
Ns
);

685 
¬¿yD
 = 
NULL
;

686 
Es
 = 
NULL
;

687 
Ds
 = 
NULL
;

688 
Ns
 = 
NULL
;

689  
şu¡Num
;

690 
	}
}

692 
	gNNGKM—ns
::
	$NNI2
(
boŞ
 
v”bo£
, cÚ¡ 
™”0
)

694 if(
™”0
 < 1)

697 
d–
, 
d–0
, 
İtEg
, 
tmpEg
 = 0, 
tmpEg1
 = 0, 
tmpEg2
 = 0, 
Ën
, 
®lEg
;

698 
i
 = 0, 
j
 = 0, 
k
 = 0, 
™”
 = 0, 
id
 = 0, 
row
 = 0;

699 
Ïb–
, 
Æab–
 = 0;

700 *
tmpD©a
 = 
NULL
;

701 
boŞ
 
UPDATE
 = 
çl£
;

702 
unÜd”ed_£t
<> 
tm±İ
;

703 
®lEg
 = 0;

704 
i
 = 0; i < 
this
->
couÁ
; i++)

707 
®lEg
 +ğ
Ëns
[
i
];

708 
Ïb–
 = 
this
->
Ïb–s
[
i
];

709 
Ns
[
Ïb–
]++;

710 
row
 = 
i
*
this
->
ndim
;

711 
j
 = 0; j < 
this
->
ndim
; j++)

713 
Ds
[
Ïb–
*
this
->
ndim
+
j
] +ğ
d©a
[
row
+j];

716 
i
 = 0; i < 
this
->
şnumb
; i++)

718 
Es
[
i
] = 0;

719 
row
 = 
i
*
this
->
ndim
;

720 
j
 = 0; j < 
this
->
ndim
; j++)

723 
Es
[
i
] +ğ
this
->
Ds
[
row
+
j
]*this->Ds[row+j];

727 
İtEg
 = 
	`g‘I2
(
this
->
Ds
,his->
şnumb
,his->
ndim
, 
Ns
);

728 
™”
 = 0;

732 
UPDATE
 = 
çl£
;

733 
i
 = 0; i < 
this
->
couÁ
; i++)

736 
id
 = 
i
;

737 
Ïb–
 = 
Ïb–s
[
id
];

738 
Æab–
 = 
Ïb–
;

739 
tm±İ
.
	`ş—r
();

741 autØ
™
 = 
vis™Li¡
[
i
].
	`begš
(); iˆ!ğvis™Li¡[i].
	`’d
(); it++)

743 if(
Ïb–
 !ğ
Ïb–s
[*
™
])

744 
tm±İ
.
	`š£¹
(
Ïb–s
[*
™
]);

747 if(
tm±İ
.
	`em±y
())

750 if(
Ns
[
Ïb–
] <= 1)

754 
Ën
 = 
this
->
Ëns
[
id
];

755 
tmpD©a
 = 
this
->
d©a
 + 
id
*this->
ndim
;

757 
d–0
 = 0;

758 
tmpEg1
 = 0;

759 
j
 = 0; j < 
ndim
; j++)

761 
tmpEg1
 +ğ
Ds
[
Ïb–
*
this
->
ndim
+
j
]*
tmpD©a
[j];

763 
tmpEg1
 = 
Es
[
Ïb–
] - 2*tmpEg1 + 
Ën
;

764 autØ
™
 = 
tm±İ
.
	`begš
(); iˆ!ğtm±İ.
	`’d
(); it++)

766 
k
 = *
™
;

767 if(
k
 =ğ
Ïb–
)

769 
tmpEg2
 = 0;

770 
j
 = 0; j < 
ndim
; j++)

772 
tmpEg2
 +ğ
Ds
[
k
*
this
->
ndim
+
j
]*
tmpD©a
[j];

774 
tmpEg2
 = 
Es
[
k
] + 2*tmpEg2 + 
Ën
;

775 
d–
 = 
tmpEg2
/(
Ns
[
k
]+1è- 
Es
[k]/Ns[k] + 
tmpEg1
/(Ns[
Ïb–
]-1) - Es[label]/Ns[label];

776 if(
d–
 > 
d–0
)

778 
d–0
 = 
d–
;

779 
Æab–
 = 
k
;

780 
tmpEg
 = 
tmpEg2
;

783 if(
d–0
 > 0)

785 
UPDATE
 = 
Œue
;

787 
Ns
[
Ïb–
]--;

788 
Ns
[
Æab–
]++;

789 
j
 = 0; j < 
this
->
ndim
; j++)

791 
Ds
[
Ïb–
*
this
->
ndim
+
j
] -ğ
tmpD©a
[j];

792 
Ds
[
Æab–
*
this
->
ndim
+
j
] +ğ
tmpD©a
[j];

794 
Es
[
Ïb–
] = 
tmpEg1
;

795 
Es
[
Æab–
] = 
tmpEg
;

796 
Ïb–s
[
id
] = 
Æab–
;

800 
™”
++;

801 
İtEg
 = 
	`g‘I2
(
this
->
Ds
,his->
şnumb
,his->
ndim
, 
Ns
);

802 }
™”
 < 
™”0
 && 
UPDATE
);

804 
i
 = 0; i < 
this
->
şnumb
; i++)

806 
	`memıy
(
this
->
¬¿yD
+
i
*this->
ndim
, 
Ds
 + i*this->ndim, ()*this->ndim);

809  
şnumb
;

810 
	}
}

812 
	gNNGKM—ns
::
	$İtzI2
(
boŞ
 
v”bo£
, cÚ¡ 
NNTİ
, cÚ¡ 
™”0
)

814 if(
™”0
 < 1)

817 
d–
, 
d–0
, 
İtEg
, 
tmpEg
 = 0, 
tmpEg1
 = 0, 
tmpEg2
 = 0, 
Ën
, 
®lEg
;

818 
i
 = 0, 
j
 = 0, 
k
 = 0, 
™”
 = 0, 
id
 = 0, 
row
 = 0;

819 
¡©us
 = 0, 
nIgrs
 = 0, 
nDups
 = 0;

820 
Ïb–
 = 0, 
Æab–
 = 0;

821 *
tmpD©a
 = 
NULL
;

822 
boŞ
 
UPDATE
 = 
çl£
;

823 
unÜd”ed_£t
<> 
tm±İ
;

824 
®lEg
 = 0;

826 
this
->
´Upd©ed
 = 
Ãw
 [this->
şnumb
];

827 
this
->
üUpd©ed
 = 
Ãw
 [this->
şnumb
];

828 
	`mem£t
(
this
->
´Upd©ed
, 0,his->
şnumb
);

829 
	`mem£t
(
this
->
üUpd©ed
, 0,his->
şnumb
);

832 
i
 = 0; i < 
this
->
couÁ
; i++)

834 
®lEg
 +ğ
Ëns
[
i
];

835 
Ïb–
 = 
this
->
Ïb–s
[
i
];

836 
Ns
[
Ïb–
]++;

837 
row
 = 
i
*
this
->
ndim
;

838 
j
 = 0; j < 
this
->
ndim
; j++)

840 
Ds
[
Ïb–
*
this
->
ndim
+
j
] +ğ
d©a
[
row
+j];

843 
i
 = 0; i < 
this
->
şnumb
; i++)

845 
Es
[
i
] = 0;

846 
row
 = 
i
*
this
->
ndim
;

847 
j
 = 0; j < 
this
->
ndim
; j++)

849 
Es
[
i
] +ğ
this
->
Ds
[
row
+
j
]*this->Ds[row+j];

853 
İtEg
 = 
	`g‘I2
(
this
->
Ds
,his->
şnumb
,his->
ndim
, 
Ns
);

854 
™”
 = 0;

855 if(
v”bo£
)

856 
cout
<<"™” "<<
™”
<<"\tİtEg "<<
İtEg
<<"\vgdi¡ÜtiÚ "<<(
®lEg
 -İtEg)/
this
->
couÁ
<<
’dl
;

858 
	`mem£t
(
this
->
üUpd©ed
, 1,his->
şnumb
);

862 
UPDATE
 = 
çl£
;

863 
	`memıy
(
this
->
´Upd©ed
,his->
üUpd©ed
,his->
şnumb
);

864 
	`mem£t
(
this
->
üUpd©ed
, 0,his->
şnumb
);

865 
i
 = 0; i < 
this
->
couÁ
; i++)

868 
id
 = 
i
;

869 
Ïb–
 = 
Ïb–s
[
id
];

870 
Æab–
 = 
Ïb–
;

871 
tm±İ
.
	`ş—r
();

873 
j
 = 0; j < 
NNTİ
; j++)

875 if(
Ïb–
 !ğ
Ïb–s
[
tİLi¡
[
id
*
TİK
+
j
]])

876 
tm±İ
.
	`š£¹
(
Ïb–s
[
tİLi¡
[
id
*
TİK
+
j
]]);

879 if(
tm±İ
.
	`em±y
())

881 
nDups
++;

885 if(
Ns
[
Ïb–
] <= 1)

889 
Ën
 = 
this
->
Ëns
[
id
];

890 
tmpD©a
 = 
this
->
d©a
 + 
id
*this->
ndim
;

892 
d–0
 = 0;

893 
tmpEg1
 = 0;

894 
j
 = 0; j < 
ndim
; j++)

896 
tmpEg1
 +ğ
Ds
[
Ïb–
*
this
->
ndim
+
j
]*
tmpD©a
[j];

898 
tmpEg1
 = 
Es
[
Ïb–
] - 2*tmpEg1 + 
Ën
;

899 
¡©us
 = 0;

900 autØ
™
 = 
tm±İ
.
	`begš
(); iˆ!ğtm±İ.
	`’d
(); it++)

902 
¡©us
 +ğ
this
->
´Upd©ed
[*
™
];

905 if(
¡©us
 < 1)

907 
nIgrs
++;

911 autØ
™
 = 
tm±İ
.
	`begš
(); iˆ!ğtm±İ.
	`’d
(); it++)

913 
k
 = *
™
;

914 
tmpEg2
 = 0;

915 
j
 = 0; j < 
ndim
; j++)

917 
tmpEg2
 +ğ
Ds
[
k
*
this
->
ndim
+
j
]*
tmpD©a
[j];

919 
tmpEg2
 = 
Es
[
k
] + 2*tmpEg2 + 
Ën
;

920 
d–
 = 
tmpEg2
/(
Ns
[
k
]+1è- 
Es
[k]/Ns[k] + 
tmpEg1
/(Ns[
Ïb–
]-1) - Es[label]/Ns[label];

921 if(
d–
 > 
d–0
)

923 
d–0
 = 
d–
;

924 
Æab–
 = 
k
;

925 
tmpEg
 = 
tmpEg2
;

929 if(
d–0
 > 0)

931 
UPDATE
 = 
Œue
;

933 
Ns
[
Ïb–
]--;

934 
Ns
[
Æab–
]++;

935 
j
 = 0; j < 
this
->
ndim
; j++)

937 
Ds
[
Ïb–
*
this
->
ndim
+
j
] -ğ
tmpD©a
[j];

938 
Ds
[
Æab–
*
this
->
ndim
+
j
] +ğ
tmpD©a
[j];

940 
Es
[
Ïb–
] = 
tmpEg1
;

941 
Es
[
Æab–
] = 
tmpEg
;

942 
Ïb–s
[
id
] = 
Æab–
;

943 
this
->
üUpd©ed
[
Ïb–
] = 1;

944 
this
->
üUpd©ed
[
Æab–
] = 1;

948 
™”
++;

949 
İtEg
 = 
	`g‘I2
(
this
->
Ds
,his->
şnumb
,his->
ndim
, 
Ns
);

952 if(
v”bo£
)

953 
cout
<<"™” "<<
™”
<<"\tİtEg "<<
İtEg
<<"\vgdi¡ÜtiÚ "<<(
®lEg
 -İtEg)/
this
->
couÁ
<<"\tIgnÜes: "<<
nIgrs
<<"\tdups: "<<
nDups
<<
’dl
;

955 }
™”
 < 
™”0
 && 
UPDATE
);

957 
i
 = 0; i < 
this
->
şnumb
; i++)

959 
	`memıy
(
this
->
¬¿yD
+
i
*this->
ndim
, 
Ds
 + i*this->ndim, ()*this->ndim);

962 
d–‘e
 [] 
´Upd©ed
;

963 
´Upd©ed
 = 
NULL
;

964 
d–‘e
 [] 
üUpd©ed
;

965 
üUpd©ed
 = 
NULL
;

967  
şnumb
;

968 
	}
}

970 
	gNNGKM—ns
::
	$budKNNG¿ph
(cÚ¡ * 
¤câ
, cÚ¡ * 
d¡â
, cÚ¡ 
dpg
)

972 
this
->
	`š™
(
¤câ
);

973 
this
->
	`š™Memry
Ñhis->
couÁ
, 0);

974 
this
->
	`budNNG¿ph4şu¡
();

977 
this
->
	`§veKNNG¿ph
(
d¡â
,his->
TİK
);

978 
	`as£¹
(
dpg
 < 
TİK
);

979 if(
dpg
 > 0)

981 
this
->
	`div”sify_by_cut
(
tİLi¡
,his->
couÁ
, 
TİK
, 
dpg
);

982 
this
->
	`augRvsKNN
(
tİLi¡
,his->
couÁ
, 
TİK
, 
dpg
);

988 
	}
}

990 
	gNNGKM—ns
::
	$augRvsKNN
(*
kNNG¿ph
, 
N
, 
D
,

991 
L
)

993 
i
 = 0, 
j
 = 0, 
kÂ
, 
¡•
 = 
N
/1000;

994 
loc
 = 0;

995 *
Ï¡MaxSZ
 = 
NULL
;

996 *
tmpLi¡
 = 
NULL
;

997 
addSZ
 = 25;

998 
boŞ
 
DUP
 = 
çl£
;

999 
rkNNNum
 = 
Ãw
 [
N
];

1000 
	`mem£t
(
rkNNNum
, 0, 
N
*());

1001 
Ï¡MaxSZ
 = 
Ãw
 [
N
];

1002 
rkNNG¿ph
 = (**è
	`m®loc
(
N
*(*));

1003 
i
 = 0; i < 
N
; i++)

1005 
Ï¡MaxSZ
[
i
] = 25;

1006 
rkNNG¿ph
[
i
] = (*è
	`m®loc
(25 * ());

1009 
i
 = 0; i < 
N
; i++)

1011 
loc
 = 
i
*
D
;

1012 if((
i
è% 
¡•
 == 0)

1014 
cout
 << "\r\r\r\r\t" << 
loc
;

1017 
j
 = 0; j < 
L
; j++)

1019 
kÂ
 = 
kNNG¿ph
[
loc
+
j
];

1020 
rkNNG¿ph
[
kÂ
][
rkNNNum
[kÂ]] = 
i
;

1021 
rkNNNum
[
kÂ
]++;

1022 if(
rkNNNum
[
kÂ
] >ğ
Ï¡MaxSZ
[knn])

1024 
tmpLi¡
 = (*è
	`»®loc
 (
rkNNG¿ph
[
kÂ
], (
addSZ
 + 
Ï¡MaxSZ
[knn]) * ());

1025 
rkNNG¿ph
[
kÂ
] = 
tmpLi¡
;

1026 
Ï¡MaxSZ
[
kÂ
] = 
addSZ
 +†astMaxSZ[knn];

1031 
i
 = 0; i < 
N
; i++)

1033 
loc
 = 
i
*
D
;

1034 
j
 = 0; j < 
L
; j++)

1036 
kÂ
 = 
kNNG¿ph
[
loc
+
j
];

1037 
DUP
 = 
çl£
;

1038 
k
 = 0; k < 
rkNNNum
[
i
]; k++)

1040 if(
rkNNG¿ph
[
i
][
k
] =ğ
kÂ
)

1042 
DUP
 = 
Œue
;

1046 if(
DUP
)

1049 
rkNNG¿ph
[
i
][
rkNNNum
[i]] = 
kÂ
;

1050 
rkNNNum
[
i
]++;

1051 if(
rkNNNum
[
i
] >ğ
Ï¡MaxSZ
[i])

1053 
tmpLi¡
 = (*è
	`»®loc
 (
rkNNG¿ph
[
i
], (
addSZ
 + 
Ï¡MaxSZ
[i]) * ());

1054 
rkNNG¿ph
[
i
] = 
tmpLi¡
;

1055 
Ï¡MaxSZ
[
i
] =†a¡MaxSZ[i] + 
addSZ
;

1060 
	`§veKNNG¿phDPG
("nusw_gkm—ns_l2.txt", 
N
, 
D
, 
rkNNG¿ph
, 
rkNNNum
);

1063 
	}
}

1065 
	gNNGKM—ns
::
	$budClu¡”
(* 
NN
, * 
d©a
, 
row
, 
ndim
, 
şu¡numb
)

1067 
i
 = 0;

1068 
this
->
	`š™
(
d©a
, 
row
, 
ndim
);

1069 
this
->
şnumb
 = 
şu¡numb
;

1070 
this
->
	`š™Memry
(
row
, 
şu¡numb
);

1071 
this
->
	`cİyFromTİLi¡
(
NN
, 25);

1073 
this
->
Es
 = (*)
	`ÿÎoc
Ñhis->
şnumb
, ());

1074 
this
->
¬¿yD
 = (*)
	`ÿÎoc
Ñhis->
şnumb
,his->
ndim
*());

1075 
this
->
Ds
 = (*)
	`ÿÎoc
Ñhis->
şnumb
,his->
ndim
*());

1076 
this
->
Ns
 = (*)
	`ÿÎoc
Ñhis->
şnumb
, ());

1078 
i
 = 0; i < 
this
->
şnumb
; i++)

1080 
	`mem£t
(
Ds
+
i
*
this
->
ndim
, 0, ()*this->ndim);

1081 
	`mem£t
(
Ns
+
i
, 0, ());

1083 
cout
<<"Initialize cluster begin .......\n";

1084 
RªdomP¬t™iÚ
 *
xbk
 = 
Ãw
 RandomPartition;

1085 
xbk
->
	`budşu¡”
(
this
->
d©a
,his->
couÁ
,his->
ndim
, "tmpfe.txt", "ºd", "Ïrge", "i2",his->
şnumb
, 0);

1086 
xbk
->
	`g‘Lab–
(
this
->
Ïb–s
);

1087 
d–‘e
 
xbk
;

1089 
Tim”
 *
mytm2
 = 
Ãw
 
	`Tim”
();

1090 
mytm2
->
	`¡¬t
();

1091 
this
->
	`İtzI2
(0,his->
TİK
, 
NI‹r
);

1092 
mytm2
->
	`’d
(
Œue
);

1093 
this
->
	`ÿlAVGDi¡
Ñhis->
¬¿yD
,his->
Ns
, 
şnumb
,his->
šfoM­
);

1095 
	`ä“
(
Es
);

1096 
	`ä“
(
¬¿yD
);

1097 
	`ä“
(
Ds
);

1098 
	`ä“
(
Ns
);

1099 
Es
 = 
NULL
;

1100 
¬¿yD
 = 
NULL
;

1101 
Ds
 = 
NULL
;

1102 
Ns
 = 
NULL
;

1105 
	}
}

1107 
	gNNGKM—ns
::
	$budClu¡”
(cÚ¡ *
¤câ
, cÚ¡ *
Ââ
, cÚ¡ *
d¡â
, 
şu¡numb
)

1109 
şock_t
 
¡¬t_i
,
fšish_i
;

1110 
row
 = 0, 
dim
 = 0, 
i
 = 0;

1111 
this
->
	`š™
(
¤câ
);

1112 
¡¬t_i
 = 
	`şock
();

1114 
this
->
şnumb
 = 
şu¡numb
;

1115 
this
->
	`š™Memry
Ñhis->
couÁ
, 
şu¡numb
);

1117 
this
->
Es
 = (*)
	`ÿÎoc
Ñhis->
şnumb
, ());

1118 
this
->
¬¿yD
 = (*)
	`ÿÎoc
Ñhis->
şnumb
,his->
ndim
*());

1119 
this
->
Ds
 = (*)
	`ÿÎoc
Ñhis->
şnumb
,his->
ndim
*());

1120 
this
->
Ns
 = (*)
	`ÿÎoc
Ñhis->
şnumb
, ());

1122 
fšish_i
 = 
	`şock
();

1123 
Time
 = (
fšish_i
-
¡¬t_i
)/
CLOCKS_PER_SEC
;

1124 
this
->
tm±ime
 +ğ
Time
;

1126 
this
->
tİLi¡
 = 
IOAg’t
::
	`lßdNN
(
Ââ
, 
row
, 
dim
);

1127 
¡¬t_i
 = 
	`şock
();

1129 if(
row
 !ğ
this
->
couÁ
 || 
dim
 !ğthis->
TİK
)

1131 
cout
<<"”rØ,‚Ù m©ch : couÁ = "<<
this
->
couÁ
<<" ,„ow = "<<
row
<<" dim = "<<
dim
<<"İk = "<<this->
TİK
<<
’dl
;

1135 
i
 = 0; i < 
this
->
şnumb
; i++)

1137 
	`mem£t
(
Ds
+
i
*
this
->
ndim
, 0, ()*this->ndim);

1138 
	`mem£t
(
Ns
+
i
, 0, ());

1140 
RªdomP¬t™iÚ
 *
xbk
 = 
Ãw
 RandomPartition;

1141 
xbk
->
	`budşu¡”
(
this
->
d©a
,his->
couÁ
,his->
ndim
, "tmpfe.txt", "ºd", "Ïrge", "i2",his->
şnumb
, 0);

1142 
xbk
->
	`g‘Lab–
(
this
->
Ïb–s
);

1143 
d–‘e
 
xbk
;

1144 
Tim”
 *
mytm2
 = 
Ãw
 
	`Tim”
();

1145 
mytm2
->
	`¡¬t
();

1147 
this
->
	`İtzI2
(0,his->
TİK
,his->
NI‹r
);

1148 
mytm2
->
	`’d
(
Œue
);

1149 
this
->
	`ÿlAVGDi¡
Ñhis->
¬¿yD
,his->
Ns
, 
şnumb
,his->
šfoM­
);

1152 
fšish_i
 = 
	`şock
();

1153 
Time
 = (
fšish_i
-
¡¬t_i
)/
CLOCKS_PER_SEC
;

1154 
this
->
tm±ime
 +ğ
Time
;

1155 
	`ä“
(
¬¿yD
);

1156 
	`ä“
(
Es
);

1157 
	`ä“
(
Ds
);

1158 
	`ä“
(
Ns
);

1159 
¬¿yD
 = 
NULL
;

1160 
Es
 = 
NULL
;

1161 
Ds
 = 
NULL
;

1162 
Ns
 = 
NULL
;

1164 
	}
}

1166 
	gNNGKM—ns
::
	$cİy2TİLi¡
(*
tİ
)

1168 
i
 = 0; i < 
this
->
couÁ
; i++)

1170 
	`memıy
(
tİ
+
i
*
TİK
, 
this
->
tİLi¡
+i*TopK, ()*TopK);

1173 
	}
}

1175 
	gNNGKM—ns
::
	$cİyFromTİLi¡
(*
tİ
, 
tİNum
)

1177 
this
->
tİLi¡
 = (*)
	`ÿÎoc
Ñhis->
couÁ
, 
TİK
*());

1178 
i
 = 0; i < 
this
->
couÁ
; i++)

1180 
	`memıy
(
this
->
tİLi¡
+
i
*
TİK
, 
tİ
+i*TopK, ()*TopK);

1183 
	}
}

1185 
	gNNGKM—ns
::
	$§veC’‹rs
(cÚ¡ *
d¡â
, 
boŞ
 
­³nd
)

1187 
şab–
 = 0, 
i
, 
j
, 
loc
, 
rCNum
 = 0;

1188 
boŞ
 
isNULL
 = 
çl£
;

1189 
of¡»am
 *
outSŒm
 = 
NULL
;

1191 if(
this
->
¬¿yD
 =ğ
NULL
)

1193 
isNULL
 = 
Œue
;

1194 
this
->
¬¿yD
 = (*)
	`ÿÎoc
Ñhis->
şnumb
,his->
ndim
*());

1197 
i
 = 0; i < 
couÁ
; i++)

1199 
şab–
 = 
Ïb–s
[
i
];

1200 
j
 = 0; j < 
ndim
; j++)

1202 
¬¿yD
[
şab–
*
ndim
+
j
] +ğ
d©a
[
i
*ndim+j];

1206 
şab–
 = 0; cÏb– < 
this
->
şnumb
; clabel++)

1208 if(
this
->
šfoM­
[
şab–
].
n
 > 0)

1210 
rCNum
++;

1214 if(!
this
->
_INIT_
||
rCNum
 == 0)

1219 if(
­³nd
)

1221 
outSŒm
 = 
Ãw
 
	`of¡»am
(
d¡â
, 
ios
::
­p
);

1225 
outSŒm
 = 
Ãw
 
	`of¡»am
(
d¡â
, 
ios
::
out
);

1226 (*
outSŒm
)<<
rCNum
<<" "<<
this
->
ndim
<<
’dl
;;

1228 
şab–
 = 0; cÏb– < 
this
->
şnumb
; clabel++)

1230 
loc
 = 
şab–
*
this
->
ndim
;

1232 if(
this
->
šfoM­
[
şab–
].
n
 <= 0)

1234 
j
 = 0; j < 
this
->
ndim
; j++)

1236 (*
outSŒm
)<<
this
->
¬¿yD
[
loc
+
j
]/this->
šfoM­
[
şab–
].
n
<<" ";

1238 (*
outSŒm
)<<
’dl
;

1241 
outSŒm
->
	`şo£
();

1243 if(
isNULL
)

1245 
	`ä“
(
¬¿yD
);

1246 
this
->
¬¿yD
 = 
NULL
;

1249 
cout
<<"done\n";

1251 
	}
}

1253 
	gNNGKM—ns
::
	$l2
(cÚ¡ 
i
, cÚ¡ 
j
)

1255 
d¡
 = 0, 
diff
 = 0;

1256 
k
 = 0, 
loc1
 = 
i
*
ndim
, 
loc2
 = 
j
*ndim;

1257 
k
 = 0; k < 
this
->
ndim
; k++)

1259 
diff
 = 
this
->
d©a
[
loc1
+
k
] -his->d©a[
loc2
+k];

1260 
d¡
 +ğ
diff
*diff;

1262  
d¡
;

1263 
	}
}

1265 
	gNNGKM—ns
::
	$div”sify_by_cut
(*
kNNG¿ph
, cÚ¡ 
N
, cÚ¡ 
K
, cÚ¡ 
edge_num
)

1267 *
d¡s
 = 
Ãw
 [2*
edge_num
], 
di¡
 = 0, 
cut
 = 0;

1268 *
tmp
 = 
Ãw
 [2*
edge_num
];

1269 * 
b_h™
 = 
Ãw
 [2*
edge_num
];

1270 * 
h™
 = 
Ãw
 [2*
edge_num
];

1271 
út
 = 0, 
i
 = 0, 
j
 = 0;

1272 
Ën
 = 
K
;

1274 
¡•
 = 
N
 / 100, 
k
 = 0, 
n_b
, 
n_k
;

1275 
row
 = 0;

1276 
û¼
 << 
’dl
 << "Progress : ";

1277 
k
 = 0; k < 
N
; k++)

1279 
row
 = 
k
*
K
;

1280 ià(
k
 % 
¡•
 == 0 )

1281 
û¼
 << "*";

1283 if(
Ën
 > 2*
edge_num
)

1285 
Ën
 = 2*
edge_num
;

1289 
i
 = 0; i < 
Ën
; i++)

1291 
d¡s
[
i
] = 
	`l2
(
k
, 
kNNG¿ph
[
row
+i]);

1292 
h™
[
i
] = 0;

1295 
i
 = 0; i < 
Ën
-1; i++ )

1297 
j
 = 
i
+1; j < 
Ën
; j++)

1300 ià(
i
 =ğ
j
) ;

1302 
n_b
 = 
kNNG¿ph
[
row
+
i
];

1303 
n_k
 = 
kNNG¿ph
[
row
+
j
];

1305 
di¡
 = 
	`l2
(
n_b
, 
n_k
);

1306 ià(
di¡
 < 
d¡s
[
j
])

1308 
h™
[
j
]++;

1314 
i
 = 0; i < 
Ën
; i++ )

1315 
b_h™
[
i
] = 
h™
[i];

1317 
	`sÜt
(
b_h™
, b_h™ + 
Ën
 );

1318 
cut
 = 
b_h™
[
edge_num
];

1320 
i
 = 0; i < 
Ën
; i++)

1321 
tmp
[
i
] = 
kNNG¿ph
[
row
+i];

1324 
út
 = 0;

1325 
i
 = 0; i < 
Ën
; i++)

1327 if(
h™
[
i
] <ğ
cut
 )

1329 
kNNG¿ph
[
row
+
út
++] = 
tmp
[
i
];

1334 
d–‘e
 [] 
h™
;

1335 
d–‘e
 [] 
b_h™
;

1336 
d–‘e
 [] 
tmp
;

1337 
d–‘e
 [] 
d¡s
;

1338 
d¡s
 = 
NULL
;

1339 
h™
 = 
b_h™
 = 
NULL
;

1340 
tmp
 = 
NULL
;

1342 
û¼
 << 
’dl
;

1343 
	}
}

1360 
	gNNGKM—ns
::
	$§veKNNG¿ph
(cÚ¡ *
d¡â
, 
k0
)

1362 
of¡»am
 *
outSŒm
 = 
NULL
;

1363 
i
 = 0, 
j
 = 0;

1364 
outSŒm
 = 
Ãw
 
	`of¡»am
(
d¡â
, 
ios
::
out
);

1365 
n
 = 
this
->
couÁ
, 
kÂ
 = 0;

1366 if(
k0
 > 
this
->
TİK
)

1367 
k0
 = 
this
->
TİK
;

1368 (*
outSŒm
)<<
n
<<" "<<
k0
<<
’dl
;

1369 
i
 = 0; i < 
n
; i++)

1371 (*
outSŒm
)<<
idx2ids
[
i
]<<" "<<
k0
<<" ";

1372 
j
 = 0; j < 
k0
; j++)

1374 
kÂ
 = 
tİLi¡
[
i
*
TİK
+
j
];

1375 (*
outSŒm
)<<" "<<
idx2ids
[
kÂ
];

1377 (*
outSŒm
)<<
’dl
;

1379 
outSŒm
->
	`şo£
();

1380 
cout
<<"Done\n";

1381 
	}
}

1384 
	gNNGKM—ns
::
	$§veKG¿ph
(cÚ¡ *
d¡â
,
k
)

1386 
of¡»am
 *
OutSŒm
 = 
Ãw
 
	`of¡»am
(
d¡â
,
ios
::
out
);

1387 
Trow
 = 
this
->
couÁ
;

1388 
œow
 = 0, 
idim
 = 0;

1389 if(
k
 >
this
->
TİK
)

1391 
k
 = 
this
->
TİK
;

1393 (*
OutSŒm
)<<
Trow
<<" ";

1394 (*
OutSŒm
)<<
k
<<
’dl
;

1395 
œow
 = 0; irow <
Trow
 ;irow++)

1397 (*
OutSŒm
)<<
œow
<<" "<<
k
<<" ";

1398 
idim
=0;idim <
k
;idim++)

1400 
kÂ
 = 
tİLi¡
[
œow
*
TİK
+
idim
];

1401 (*
OutSŒm
)<<
idx2ids
[
kÂ
]<<" ";

1403 (*
OutSŒm
)<<
’dl
;

1405 
OutSŒm
->
	`şo£
();

1406 
cout
<<"savekgraph done!\n";

1407 
	}
}

1409 *
	gNNGKM—ns
::
	$lßdKNNG¿ph
(cÚ¡ *
¤câ
)

1411 
if¡»am
 
	`šSŒm
(
¤câ
, 
ios
::
š
);

1412 
N
, 
tmp
, 
k0
;

1413 *
tİLi¡
;

1415 
šSŒm
 >> 
N
;

1416 
šSŒm
 >> 
k0
;

1417 
cout
 << "kNN g¿ph SZ = " << 
N
 << "x" << 
k0
 << 
’dl
;

1418 
tİLi¡
 = (*)
	`ÿÎoc
(
N
, 
k0
*());

1419 
i
 = 0; i < 
N
; i++)

1421 
šSŒm
 >> 
tmp
;

1422 
j
 = 0; j < 
k0
; j++)

1424 
šSŒm
 >> 
tİLi¡
[
i
*
k0
 + 
j
];

1428  
tİLi¡
;

1429 
	}
}

1431 
	gNNGKM—ns
::
	$§veKNNG¿phDPG
(cÚ¡ *
d¡â
, 
k0
)

1433 
of¡»am
 *
outSŒm
 = 
NULL
;

1434 
i
 = 0, 
j
 = 0, 
majÜ
 = 2, 
mšÜ
 = 0, 
k
 = 0;

1435 
kÂ
 = 0;

1436 
magic
[9] = "KNNGRAPH";

1437 
outSŒm
 = 
Ãw
 
	`of¡»am
(
d¡â
, 
ios
::
out
|ios::
bš¬y
);

1438 
n
 = 
this
->
couÁ
;

1439 
outSŒm
->
	`wr™e
((*)&
magic
, 8);

1440 
outSŒm
->
	`wr™e
((*)&
majÜ
, (major));

1441 
outSŒm
->
	`wr™e
((*)&
mšÜ
, (minor));

1442 
outSŒm
->
	`wr™e
((*)&
n
, (n));

1444 if(
k0
 > 
this
->
TİK
)

1445 
k0
 = 
this
->
TİK
;

1447 
i
 = 0; i < 
n
; i++)

1449 
k
 = 
k0
;

1450 
kÂ
 = 
idx2ids
[
i
];

1451 
outSŒm
->
	`wr™e
((*)&
kÂ
, ());

1452 
outSŒm
->
	`wr™e
((*)&
k
, ());

1453 
j
 = 0; j < 
k0
; j++)

1455 
kÂ
 = 
tİLi¡
[
i
*
TİK
+
j
];

1456 
kÂ
 = 
idx2ids
[knn];

1457 
outSŒm
->
	`wr™e
((*)&
kÂ
, ());

1461 
outSŒm
->
	`şo£
();

1462 
cout
<<"done\n";

1463 
	}
}

1465 
	gNNGKM—ns
::
	$§veKNNG¿phDPG
(cÚ¡ *
d¡â
, cÚ¡ 
N
,

1466 cÚ¡ 
D
, **
kÂG¿ph
, *
kÂNumb
)

1468 
i
, 
j
 = 0, 
kÂ
;

1469 
of¡»am
 *
outSŒm
 = 
Ãw
 
	`of¡»am
(
d¡â
, 
ios
::
out
);

1470 (*
outSŒm
)<<
N
<<
’dl
;

1471 
i
 = 0; i < 
N
; i++)

1473 (*
outSŒm
)<<
idx2ids
[
i
]<<" "<<
kÂNumb
[i];

1474 
j
 = 0; j < 
kÂNumb
[
i
]; j++)

1476 
kÂ
 = 
kÂG¿ph
[
i
][
j
];

1477 (*
outSŒm
)<<" "<<
idx2ids
[
kÂ
];

1479 (*
outSŒm
)<<
’dl
;

1481 
outSŒm
->
	`şo£
();

1483 
	}
}

1485 
	gNNGKM—ns
::
§veKNNG¿ph
(cÚ¡ *
d¡â
, cÚ¡ 
n
, cÚ¡ 
k0
, 
veùÜ
<> &
ids
)

1487 
of¡»am
 *
	goutSŒm
 = 
NULL
;

1488 
	gi
 = 0, 
	gj
 = 0, 
	gid
;

1489 
	goutSŒm
 = 
Ãw
 
of¡»am
(
d¡â
, 
ios
::
out
);

1490 (*
	goutSŒm
)<<
	gn
<<"\t"<<
	gk0
<<
	g’dl
;

1491 
	gi
 = 0; i < 
	gn
; i++)

1493 (*
	goutSŒm
)<<
	gids
[
i
];

1494 
	gj
 = 0; j < 
	gk0
; j++)

1496 
	gid
 = 
tİLi¡
[
i
*
TİK
+
j
];

1497 (*
	goutSŒm
)<<" "<<
	gids
[
id
];

1499 (*
	goutSŒm
)<<
	g’dl
;

1501 
	goutSŒm
->
şo£
();

1502 
	gcout
<<"done\n";

1505 
	gNNGKM—ns
::
	$ãtchC’‹rs
(*
ûÁ”s
)

1507 
şab–
 = 0, 
j
 = 0, 
loc
 = 0, 
idxi
 = 0, 
rCNum
 = 0;

1508 
	`as£¹
(
ûÁ”s
);

1510 
şab–
 = 0; cÏb– < 
this
->
şnumb
; clabel++)

1512 if(
this
->
šfoM­
[
şab–
].
n
 > 0)

1514 
rCNum
++;

1518 if(!
this
->
_INIT_
||
rCNum
 == 0)

1520 
	`mem£t
(
ûÁ”s
, 0, 
this
->
şnumb
*this->
ndim
*());

1524 
şab–
 = 0; cÏb– < 
this
->
şnumb
; clabel++)

1526 
loc
 = 
şab–
*
this
->
ndim
;

1528 if(
this
->
šfoM­
[
şab–
].
n
 <= 0)

1531 
j
 = 0; j < 
this
->
ndim
; j++)

1533 
ûÁ”s
[
idxi
 + 
j
] = 
this
->
¬¿yD
[
loc
+j]/this->
šfoM­
[
şab–
].
n
;

1535 
idxi
 +ğ
this
->
ndim
;

1537  
rCNum
;

1538 
	}
}

1540 
	gNNGKM—ns
::~
	$NNGKM—ns
()

1542 if(
this
->
¬¿yD
 !ğ
NULL
)

1544 
	`ä“
(
¬¿yD
);

1545 
this
->
¬¿yD
 = 
NULL
;

1547 if(
this
->
Ds
 !ğ
NULL
)

1549 
	`ä“
(
Ds
);

1550 
Ds
 = 
NULL
;

1552 if(
this
->
Ns
 !ğ
NULL
)

1554 
	`ä“
(
this
->
Ns
);

1555 
this
->
Ns
 = 
NULL
;

1557 if(
this
->
Es
 !ğ
NULL
)

1559 
	`ä“
(
this
->
Es
);

1560 
this
->
Es
 = 
NULL
;

1562 if(
this
->
tİDi¡
 !ğ
NULL
)

1564 
	`ä“
(
tİDi¡
);

1565 
tİDi¡
 = 
NULL
;

1567 if(!
this
->
outNN
&&this->
tİLi¡
 !ğ
NULL
)

1569 
	`ä“
(
tİLi¡
);

1570 
tİLi¡
 = 
NULL
;

1573 
idx2ids
.
	`ş—r
();

1574 
	}
}

1576 
	gNNGKM—ns
::
	$§veLogs
(cÚ¡ *
d¡Fn
)

1578 
of¡»am
 *
outSŒm
 = 
Ãw
 
	`of¡»am
(
d¡Fn
, 
ios
::
out
);

1580 
i
 = 0;

1581 
i
 = 0 ; i < 
nLogs
; i++)

1583 (*
outSŒm
)<<
i
<<"\t\t"<<
tmLogs
[i]<<"\t\t"<<
d¡Logs
[i]<<
’dl
;

1586 
outSŒm
->
	`şo£
();

1587 
	}
}

1589 
	gNNGKM—ns
::
	$ä“O³¿tiÚ
()

1591 if(
this
->
¬¿yD
 !ğ
NULL
)

1593 
	`ä“
(
¬¿yD
);

1594 
this
->
¬¿yD
 = 
NULL
;

1596 if(
this
->
Ds
 !ğ
NULL
)

1598 
	`ä“
(
Ds
);

1599 
Ds
 = 
NULL
;

1601 if(
this
->
Ns
 !ğ
NULL
)

1603 
	`ä“
(
this
->
Ns
);

1604 
this
->
Ns
 = 
NULL
;

1606 if(
this
->
Es
 !ğ
NULL
)

1608 
	`ä“
(
this
->
Es
);

1609 
this
->
Es
 = 
NULL
;

1611 if(
this
->
tİDi¡
 !ğ
NULL
)

1613 
	`ä“
(
tİDi¡
);

1614 
tİDi¡
 = 
NULL
;

1616 if(!
this
->
outNN
&&this->
tİLi¡
 !ğ
NULL
)

1618 
	`ä“
(
tİLi¡
);

1619 
tİLi¡
 = 
NULL
;

1622 if(
this
->
tmLogs
 !ğ
NULL
)

1624 
d–‘e
 [] 
tmLogs
;

1625 
tmLogs
 = 
NULL
;

1628 if(
this
->
d¡Logs
 !ğ
NULL
)

1630 
d–‘e
 [] 
d¡Logs
;

1631 
d¡Logs
 = 
NULL
;

1634 
idx2ids
.
	`ş—r
();

1635 
	}
}

1636 
	gNNGKM—ns
::
	$‹¡
()

1638 cÚ¡ *
¤cM©Fn1
 = "/home/chenghaod/datasets/bignn/mat/sift1m/sift_base.txt";

1639 cÚ¡ *
¤cM©Fn2
 = "/home/chenghaod/datasets/bignn/mat/sift_learn.txt";

1640 cÚ¡ *
¤cM©Fn3
 = "itm_vlad_hesaff_flickr10m.itm";

1641 cÚ¡ *
d¡â
 = "/home/chenghaod/sift_learn_test.out";

1645 cÚ¡ *
¤câ
 = "/home/chenghaod/data/sift/raw/sift_base.fvecs";

1654 
NNGKM—ns
 *
mykm
 = 
Ãw
 
	`NNGKM—ns
();

1655 
mykm
->
	`budşu¡”
(
¤câ
, 
d¡â
, "nÚ", "Ïrge", "i2", 10000, 
çl£
);

1656 
d–‘e
 
mykm
;

1657 
cout
<<"time\n";

1658 
cout
<<"t2 "<<
t2
<<"3 "<<
t3
<<"4 "<<
t4
<<"5 "<<
t5
<<"6 "<<
t6
<<"7 "<<
t7
<<"8 "<<
t8
<<
’dl
;

1660 
	}
}

1662 
	gNNGKM—ns
::
	$YJ‹¡
()

1664 cÚ¡ *
¤cFn
 = "/home/jyang/datasets/BIGANN/sift/sift_base.fvecs";

1665 cÚ¡ *
d¡Fn
 = "/home/jyang/src/cpp/pq/data/sift1M_lg_knn40.txt";

1667 cÚ¡ *
¤cFn1
 = "/home/jyang/datasets/BIGANN/sift1B/bigann_base.bvecs";

1668 cÚ¡ *
d¡Fn1
 = "/home/jyang/src/cpp/pq/data/sift10M_dpg_knn40.txt";

1670 cÚ¡ *
¤cFn2
 = "/home/jyang/datasets/nuswide/nusw_26k.txt";

1671 cÚ¡ *
d¡Fn2
 = "/home/jyang/src/cpp/pq/data/nusw_nng_dpg.txt";

1673 cÚ¡ *
¤cFn3
 = "/home/jyang/datasets/BIGANN/sift1B/bigann_base.bvecs";

1674 cÚ¡ *
d¡Fn3
 = "/home/jyang/src/cpp/pq/data/sift100M_dpg_knn40.txt";

1676 cÚ¡ *
¤cFn4
 = "/home/jyang/bigann/sift1b/bigann_base.bvecs";

1677 cÚ¡ *
d¡Fn4
 = "/home/jyang/bigann/sift1b/sift10m_knn40.txt";

1678 cÚ¡ *
¤cFn5
 = "./sift_1b20tree25nn.txt";

1680 
şock_t
 
t1
 = 
	`şock
();

1681 
NNGKM—ns
 *
mykm
 = 
Ãw
 
	`NNGKM—ns
();

1682 
mykm
->
	`budKNNG¿ph
(
¤cFn3
, 
d¡Fn4
, 
TİK
/2);

1683 
cout
 << "®Ètimğ" << (
	`şock
(è- 
t1
)/(
CLOCKS_PER_SEC
 + 0.0fè<< 
’dl
;

1684 
	}
}

1687 
	gNNGKM—ns
::
	$PC‹¡
()

1690 cÚ¡ *
¤cM©Fn1
 = "nusw_26k.txt";

1691 cÚ¡ *
d¡Fn1
 = "nusw_gkmeans_40.txt";

1692 cÚ¡ *
d¡
 = "";

1738 
NNGKM—ns
 *
mykm
 = 
Ãw
 
	`NNGKM—ns
();

1739 
mykm
->
	`budKNNG¿ph
(
¤cM©Fn1
, 
d¡Fn1
, 
TİK
/2);

1757 
	}
}

1759 
	gNNGKM—ns
::
	$WL‹¡
()

1761 
d¡â
[512];

1762 cÚ¡ *
¤cM©Fn1
 = "/home/wlzhao/src/prj/pq/data/sift10k_rnd_truc_mat.tvecs";

1763 cÚ¡ *
¤cM©Fn2
 = "/home/wlzhao/src/prj/pq/data/sift100k_rnd_truc_mat.tvecs";

1764 cÚ¡ *
¤cM©Fn3
 = "/home/wlzhao/datasets/bignn/sift1m/sift_base.txt";

1765 cÚ¡ *
¤cM©Fn4
 = "/home/wlzhao/datasets/bignn/glove/glove1m_base.txt";

1766 cÚ¡ *
¤cM©Fn5
 = "/home/wlzhao/datasets/bignn/glove/glove300k_rand.tvecs";

1767 cÚ¡ *
¤cM©Fn6
 = "/home/wlzhao/datasets/bignn/yfcc1m/yfcc1m_ref.txt";

1768 cÚ¡ *
¤cM©Fn7
 = "/home/wlzhao/datasets/clustering/social/Email-Enron_v11_1008.imat";

1769 cÚ¡ *
¤cM©Fn8
 = "/home/wlzhao/datasets/bignn/mat/sift_learn.txt";

1771 cÚ¡ *
d¡Fn1
 = "/home/wlzhao/src/prj/pq/data/sift10k_dpg_knn20.txt";

1772 cÚ¡ *
d¡Fn2
 = "/home/wlzhao/src/prj/pq/data/sift100k_dpg_knn20.txt";

1773 cÚ¡ *
d¡Fn3
 = "/home/wlzhao/src/prj/pq/data/sift1m_dpg_knn20.txt";

1774 cÚ¡ *
d¡Fn4
 = "/home/wlzhao/src/prj/pq/data/glove1m_dpg_knn40_x.txt";

1775 cÚ¡ *
d¡Fn5
 = "/home/wlzhao/src/prj/pq/data/glove300k_dpg_knn20.txt";

1776 cÚ¡ *
d¡Fn6
 = "/home/wlzhao/datasets/bignn/yfcc1m/yfcc1m_dgp_knn40.txt";

1777 cÚ¡ *
d¡Fn7
 = "/home/wlzhao/datasets/clustering/social/enron/Email-Enron_v11_1008_8192_label.txt";

1778 cÚ¡ *
d¡Fn8
 = "/home/wlzhao/datasets/bignn/mat/sift_learn_1k.txt";

1780 
row
 = 0, 
dim
 = 0, 
úum
 = 1024, 
i
 = 0;

1782 
NNGKM—ns
 *
mykm
 = 
Ãw
 
	`NNGKM—ns
();

1783 
mykm
->
	`budşu¡”
(
¤cM©Fn8
, "", "nÚ", "Ïrge", "i2", 
úum
, 
çl£
);

1784 
mykm
->
	`§ve_şu¡
(
d¡Fn8
);

1785 
	}
}

1787 
	gNNGKM—ns
::
	$CH‹¡
()

1789 cÚ¡ *
¤cM©Fn1
 = "/home/chenghaod/datasets/bignn/mat/sift1m/sift_base.txt";

1790 cÚ¡ *
¤cM©Fn2
 = "/home/chenghaod/datasets/bignn/mat/sift_learn.txt";

1791 cÚ¡ *
¤cM©Fn3
 = "itm_vlad_hesaff_flickr10m.itm";

1792 cÚ¡ *
d¡â
 = "/home/chenghaod/sift_learn_test.out";

1796 cÚ¡ *
¤câ
 = "/home/chenghaod/data/sift/raw/sift_base.fvecs";

1797 cÚ¡ *
Ââ
 = "sift1m25.txt";

1819 
NNGKM—ns
 *
mykm
 = 
Ãw
 
	`NNGKM—ns
();

1820 #ifdeà
SIFT


1824 
d–‘e
 
mykm
;

1825 
mykm
 = 
Ãw
 
NNGKM—ns
;

1827 
mykm
->
	`§veC’‹rs
("tmpcenter", 0);

1830 
mykm
->
	`budşu¡”
(
¤cM©Fn3
, 
d¡â
, "nÚ", "Ïrge", "i2", 1000000, 
çl£
);

1832 
d–‘e
 
mykm
;

1833 
cout
<<"time\n";

1834 
cout
<<"t2 "<<
t2
<<"3 "<<
t3
<<"4 "<<
t4
<<"5 "<<
t5
<<"6 "<<
t6
<<"7 "<<
t7
<<"8 "<<
t8
<<
’dl
;

1837 
	}
}

	@/home/pclin/cpp/gkmeans/nngkmeans.h

10 #iâdeà
NNGKM—ns_H


11 
	#NNGKM—ns_H


	)

13 
	~"ab¡¿ùkm—ns.h
"

14 
	~<£t
>

15 
	~<unÜd”ed_£t
>

17 
	~"ev®u©Ü.h
"

19 şas 
	cNNGKM—ns
: 
public
 
Ab¡¿ùKM—ns


21 cÚ¡ 
NBI‹r
, 
	mT»eNum
;

22 cÚ¡ 
	mNI‹r
;

23 cÚ¡ 
	mRªgeFœ¡
;

24 cÚ¡ 
	mRªgeSecÚd
;

25 cÚ¡ 
	mE¼0
;

27 
boŞ
 
	moutNN
 = 
çl£
;

29 
	mlÚgloc
;

31 *
	mEs
, *
	m¬¿yD
;

32 *
	mNs
;

33 *
	mDs
;

34 *
	mtİLi¡
;

36 *
	mrkNNNum
 = 
NULL
;

37 **
	mrkNNG¿ph
 = 
NULL
;

38 *
	mdi¡li¡
 = (*)
ÿÎoc
(40,());

40 *
	mtİDi¡
;

42 
	munÜd”ed_£t
<> *
	mvis™Li¡
;

43 
	mveùÜ
<> 
	midx2ids
;

45 *
	m¿dius
;

46 *
	m´Upd©ed
, *
	müUpd©ed
;

48 cÚ¡ 
	mT»esize
;

49 cÚ¡ 
	mTİK
;

50 cÚ¡ 
	mNNTİ
;

52 
adju¡NN
();

53 
İtzI2
(
boŞ
 
v”bo£
, cÚ¡ 
NNTİ
, cÚ¡ 
n™”0
);

54 
NewO±zI2
(
boŞ
 
v”bo£
, cÚ¡ 
NNTİ
, cÚ¡ 
n™”0
);

55 
š™NNG¿ph
();

56 
budNNG¿phBy2Mn
(
v”bo£
);

57 
upd©eNNG¿ph
();

58 
budNNG¿ph4şu¡
();

60 
	mpublic
 :

62 *
»s
;

63 
	mnum
;

64 
	mtm±ime
;

65 *
	mtmLogs
;

66 *
	md¡Logs
;

67 
	mnLogs
;

69 
NNGKM—ns
();

70 
	mvœtu®
 ~
NNGKM—ns
();

71 
ä“O³¿tiÚ
();

72 
boŞ
 
š™
(cÚ¡ *
¤câ
);

73 
boŞ
 
š™
(*
m©
, cÚ¡ 
row
, cÚ¡ 
dim
);

74 
boŞ
 
š™
(*
m©
, cÚ¡ 
row
, cÚ¡ 
dim
);

75 
boŞ
 
£tLogOn
(cÚ¡ 
logSize
);

77 
»ÿÎ
();

78 
NNI2
(
boŞ
 
v”bo£
, cÚ¡ 
n™”0
);

79 
budClu¡”
(* 
NN
, * 
d©a
, 
row
, 
ndim
, 
şu¡numb
);

80 
budClu¡”
(cÚ¡ *
¤câ
, cÚ¡ *
Ââ
, cÚ¡ *
d¡â
, 
şu¡numb
);

82 
cİy2TİLi¡
(*
tİ
);

83 
cİyFromTİLi¡
(*
tİ
, 
tİNum
);

84 
boŞ
 
cÚfig
(cÚ¡ *
_£ed_
, cÚ¡ *
lg_fœ¡
, cÚ¡ *
üŒn
, 
v”bo£
);

85 
l2
(cÚ¡ 
i
, cÚ¡ 
j
);

87 
şu¡
(cÚ¡ 
şu¡_num
, cÚ¡ *
d¡â
, cÚ¡ 
v”bo£
);

89 
budKNNG¿ph
(cÚ¡ *
¤câ
, cÚ¡ *
d¡â
, cÚ¡ 
dpg
);

90 
div”sify_by_cut
(*
kNNG¿ph
, cÚ¡ 
N
, cÚ¡ 
K
, cÚ¡ 
edge_num
);

91 
augRvsKNN
(*
kNNG¿ph
, 
N
, 
D
,
L
);

94 
boŞ
 
ºdS“ds
(cÚ¡ 
k
, 
r£eds
[], cÚ¡ 
bound
);

95 
boŞ
 
kµS“ds
(cÚ¡ 
k
, 
r£eds
[], cÚ¡ 
bound
);

97 
§veC’‹rs
(cÚ¡ *
d¡â
, 
boŞ
 
­³nd
);

98 
§veKNNG¿ph
(cÚ¡ *
d¡â
, 
k0
);

99 *
lßdKNNG¿ph
(cÚ¡ *
¤câ
);

100 
§veKNNG¿ph
(cÚ¡ *
d¡â
, cÚ¡ 
n
, cÚ¡ 
k0
, 
veùÜ
<> &
ids
);

101 
§veKNNG¿phDPG
(cÚ¡ *
d¡â
, 
k0
);

102 
§veKNNG¿phDPG
(cÚ¡ *
d¡â
, cÚ¡ 
N
, cÚ¡ 
D
,

103 **
kÂG¿ph
, *
kÂNumb
);

104 
ãtchC’‹rs
(*
ûÁ”s
);

106 
§veKG¿ph
(cÚ¡ *
d¡â
,
k
);

107 
§veLogs
(cÚ¡ *
d¡Fn
);

109 
‹¡
();

110 
CH‹¡
();

111 
YJ‹¡
();

112 
WL‹¡
();

113 
PC‹¡
();

	@/home/pclin/cpp/gkmeans/nnitem.h

1 #iâdeà
NNITEM_H


2 
	#NNITEM_H


	)

4 
	~<®gÜ™hm
>

5 
	~<veùÜ
>

6 
	~<li¡
>

7 
	~<m­
>

9 
usšg
 
Çme¥aû
 
	g¡d
;

11 
	sV®Id


13 
	mpublic
 :

14 
idx
;

15 
	mv®
;

16 
LLcom·»r
(cÚ¡ 
V®Id
 &
a
, cÚ¡ V®Id &
b
)

18  (
	ma
.
	mv®
 < 
	mb
.val);

20 
LGcom·»r
(cÚ¡ 
V®Id
 &
a
, cÚ¡ V®Id &
b
)

22  (
	ma
.
	mv®
 > 
	mb
.val);

26 
	sMšiNN


28 
	mpublic
:

29 
idx
;

30 
	mv®
;

33 
LLcom·»r
(cÚ¡ 
MšiNN
 *
a
, cÚ¡ MšiNN *
b
)

35  (
	ma
->
	mv®
 < 
	mb
->val);

41 
LGcom·»r
(cÚ¡ 
MšiNN
 *
a
, cÚ¡ MšiNN *
b
)

43  (
	ma
->
	mv®
 > 
	mb
->val);

49 şas 
	cNNI‹m


51 
	mpublic
:

52 
	$NNI‹m
(cÚ¡ 
šdex
, cÚ¡ 
di¡
)

54 
this
->
šdex
 = index;

55 
this
->
v®
 = 
di¡
;

56 
this
->
size
 = 0;

57 
this
->
dvd
 = 
Œue
;

59 
	$NNI‹m
(cÚ¡ 
šdex
, cÚ¡ 
di¡
, cÚ¡ 
sz
)

61 
this
->
šdex
 = index;

62 
this
->
v®
 = 
di¡
;

63 
this
->
size
 = 
sz
;

64 
this
->
dvd
 = 
Œue
;

65 
	}
}

66 
	gšdex
;

67 
	gv®
;

68 
	gsize
;

69 
boŞ
 
	gdvd
;

72 
	$LLcom·»r
(cÚ¡ 
NNI‹m
 *
a
,cÚ¡ NNI‹m *
b
)

74  (
a
->
v®
 < 
b
->val);

75 
	}
}

78 
	$LGcom·»r
(cÚ¡ 
NNI‹m
 *
a
, cÚ¡ NNI‹m *
b
)

80  (
a
->
v®
 > 
b
->val);

81 
	}
}

84 
	$LLIDXcom·»r
(cÚ¡ 
NNI‹m
 *
a
, cÚ¡ NNI‹m *
b
)

87  (
a
->
šdex
 < 
b
->index);

88 
	}
}

91 
	$LLVALcom·»r
(cÚ¡ 
NNI‹m
 *
a
, cÚ¡ NNI‹m *
b
)

93 if((
a
->
dvd
 =ğ
çl£
è&& (
b
->dvd == false))

95  
çl£
;

97 if((
a
->
dvd
 =ğ
çl£
è&& 
b
->dvd)

99  
çl£
;

101 if(
a
->
dvd
 && (
b
->dvd =ğ
çl£
))

103  
Œue
;

107 if(
a
->
v®
 < 
b
->val)

109  
Œue
;

111 if(
a
->
v®
 =ğ
b
->val)

113 if(
a
->
size
 > 
b
->size)

115  
Œue
;

119  
çl£
;

124  
çl£
;

127 
	}
}

130 
	$LGVALcom·»r
(cÚ¡ 
NNI‹m
 *
a
, cÚ¡ NNI‹m *
b
)

132 if((
a
->
dvd
 =ğ
çl£
è&& (
b
->dvd == false))

134  
Œue
;

136 if((
a
->
dvd
 =ğ
çl£
è&& 
b
->dvd)

138  
çl£
;

140 if(
a
->
dvd
 && (
b
->dvd =ğ
çl£
))

142  
Œue
;

146 if(
a
->
v®
 > 
b
->val)

148  
Œue
;

150 if(
a
->
v®
 =ğ
b
->val)

152 if(
a
->
size
 > 
b
->size)

154  
Œue
;

158  
çl£
;

163  
çl£
;

166 
	}
}

169 
	$LGSZcom·»r
(cÚ¡ 
NNI‹m
 *
a
, cÚ¡ NNI‹m *
b
)

171 if((
a
->
dvd
 =ğ
çl£
è&& (
b
->dvd == false))

173  
Œue
;

175 if((
a
->
dvd
 =ğ
çl£
è&& 
b
->dvd)

177  
çl£
;

179 if(
a
->
dvd
 && (
b
->dvd =ğ
çl£
))

181  
Œue
;

185 if(
a
->
size
 > 
b
->size)

187  
Œue
;

189 if(
a
->
size
 =ğ
b
->size)

191 if(
a
->
v®
 > 
b
->val)

193  
Œue
;

197  
çl£
;

202  
çl£
;

205 
	}
}

	@/home/pclin/cpp/gkmeans/pqmath.cpp

1 
	~"pqm©h.h
"

3 
	~<unÜd”ed_m­
>

4 
	~<io¡»am
>

5 
	~<ÿs£¹
>

6 
	~<c¡ršg
>

7 
	~<cm©h
>

8 
	~<m­
>

10 
usšg
 
Çme¥aû
 
	g¡d
;

12 cÚ¡ 
	gPQM©h
::
sm®lV®0
 = 0.000001f;

14 
	gPQM©h
::
	$cos
(cÚ¡ 
v1
[], cÚ¡ 
s1
,

15 cÚ¡ 
v2
[], cÚ¡ 
s2
, cÚ¡ 
d0
)

17 
w1
 = 0.0f, 
w2
 = 0.0f, 
v®
 = 0.0f;

18 
loc1
 = 
d0
 * 
s1
;

19 
loc2
 = 
d0
 * 
s2
;

21 
i
 = 0; i < 
d0
; i++)

23 
w1
 = w1 + 
v1
[
loc1
+
i
]*v1[loc1+i];

24 
w2
 = w2 + 
v2
[
loc2
+
i
]*v2[loc2+i];

25 
v®
 = v® + 
v1
[
loc1
+
i
]*
v2
[
loc2
+i];

28 
w1
 = 
	`sq¹
(w1);

29 
w2
 = 
	`sq¹
(w2);

31 if(
w1
 =ğ0 && 
w2
 == 0)

36 if(
w1
 == 0)

38  
	`çbs
(1-
w2
/2);

40 if(
w2
 == 0)

42  
	`çbs
(1-
w1
/2);

46 
v®
 = v®/(
w1
*
w2
);

47  
v®
;

49  
v®
;

50 
	}
}

52 
	gPQM©h
::
	$l2f
(cÚ¡ 
v1
[], cÚ¡ 
s1
,

53 cÚ¡ 
v2
[], cÚ¡ 
s2
, cÚ¡ 
d0
)

55 
w1
 = 0.0f, 
w2
 = 0.0f;

56 
loc1
 = 
d0
 * 
s1
;

57 
loc2
 = 
d0
 * 
s2
;

59 
i
 = 0; i < 
d0
; i++)

61 
w1
 = 
v1
[
loc1
+
i
] - 
v2
[
loc2
+i];

62 
w2
 +ğ
w1
*w1;

65 
w2
 = 
	`sq¹
(w2);

67  
w2
;

68 
	}
}

70 
	gPQM©h
::
	$l2f
(cÚ¡ 
S·r£M©rix
 &
v1
, cÚ¡ 
s1
,

71 cÚ¡ 
S·r£M©rix
 &
v2
, cÚ¡ 
s2
,

72 cÚ¡ 
d0
)

74 
w1
 = 0.0f, 
w2
 = 0.0f;

75 
i
 = 0;

78 *
muÉ
 = 
NULL
;

79 
unÜd”ed_m­
<, > 
s
;

80 
unÜd”ed_m­
<, >::
™”©Ü
 
™
;

82 if((
v1
.
cŞ
[
s1
+1] - 
v2
.cŞ[
s2
+1] - v1.col[s1] + v2.col[s2]) > 0)

85 
muÉ
 = 
Ãw
 [
v1
.
cŞ
[
s1
+1] - v1.col[s1]];

86 
	`mem£t
(
muÉ
, 0, (
v1
.
cŞ
[
s1
+1] - v1.col[s1])*());

88 
i
 = 
v1
.
cŞ
[
s1
]; i < v1.col[s1+1]; i++)

90 
s
.
	`š£¹
(
	`make_·œ
(
v1
.
šdex
[
i
],i));

93 
i
 = 
v2
.
cŞ
[
s2
]; i < v2.col[s2+1]; i++)

95 
™
 = 
s
.
	`fšd
(
v2
.
šdex
[
i
]);

96 if(
™
 !ğ
s
.
	`’d
())

98 
w1
 = 
v1
.
d©a
[
™
->
£cÚd
] - 
v2
.d©a[
i
];

99 
muÉ
[
™
->
£cÚd
 - 
v1
.
cŞ
[
s1
]] = 1;

102 
w1
 = 
v2
.
d©a
[
i
];

103 
w2
 +ğ
w1
*w1;

105 
i
 = 
v1
.
cŞ
[
s1
]; i < v1.col[s1+1]; i++)

107 if(!
muÉ
[
i
 - 
v1
.
cŞ
[
s1
]])

109 
w1
 = 
v1
.
d©a
[
i
];

110 
w2
 +ğ
w1
*w1;

116 
muÉ
 = 
Ãw
 [
v2
.
cŞ
[
s2
+1] - v2.col[s2]];

117 
	`mem£t
(
muÉ
, 0, (
v2
.
cŞ
[
s2
+1] - v2.col[s2])*());

119 
i
 = 
v2
.
cŞ
[
s2
]; i < v2.col[s2+1]; i++)

121 
s
.
	`š£¹
(
	`make_·œ
(
v2
.
šdex
[
i
],i));

124 
i
 = 
v1
.
cŞ
[
s1
]; i < v1.col[s1+1]; i++)

126 
™
 = 
s
.
	`fšd
(
v1
.
šdex
[
i
]);

127 if(
™
 !ğ
s
.
	`’d
())

129 
w1
 = 
v2
.
d©a
[
™
->
£cÚd
] - 
v1
.d©a[
i
];

130 
muÉ
[
™
->
£cÚd
 - 
v2
.
cŞ
[
s2
]] = 1;

133 
w1
 = 
v1
.
d©a
[
i
];

134 
w2
 +ğ
w1
*w1;

136 
i
 = 
v2
.
cŞ
[
s2
]; i < v2.col[s2+1]; i++)

138 if(!
muÉ
[
i
 - 
v2
.
cŞ
[
s2
]])

140 
w1
 = 
v2
.
d©a
[
i
];

141 
w2
 +ğ
w1
*w1;

145 if(
muÉ
 !ğ
NULL
)

147 
d–‘e
 [] 
muÉ
;

148 
muÉ
 = 
NULL
;

151 
w2
 = 
	`sq¹
(w2);

152  
w2
;

190 
	}
}

193 
boŞ
 
	gPQM©h
::
¿ndS“ds
(cÚ¡ 
bound
, 
£t
<> &
£eds
, cÚ¡ 
numb
)

195 
	gi
 = 0, 
	gcouÁs
 = 0, 
	gr
 = 0;

198 
	gr
 = 
¿nd
()%
bound
;

199 
	g£eds
.
š£¹
(
r
);

200 
	gcouÁs
++;

201 if(
	gcouÁs
 >ğ2*
bound
)

203 }
	g£eds
.
size
(è< 
	gnumb
);

205 if(
	g£eds
.
size
(è< 
	gnumb
)

206  
	gçl£
;

208  
	gŒue
;

211 
	gPQM©h
::
	$l2d
(cÚ¡ 
v1
[], cÚ¡ 
s1
,

212 cÚ¡ 
v2
[], cÚ¡ 
s2
, cÚ¡ 
d0
)

214 
w1
 = 0.0f, 
w2
 = 0.0f;

215 
loc1
 = 
d0
*
s1
;

216 
loc2
 = 
d0
*
s2
;

217 
i
 = 0; i < 
d0
; i++)

219 
w1
 = 
v1
[
loc1
+
i
] - ()
v2
[
loc2
+i];

220 
w2
 +ğ
w1
*w1;

223 
w2
 = 
	`sq¹
(w2);

225  
w2
;

226 
	}
}

229 
	gPQM©h
::
	$l2d
(cÚ¡ 
v1
[], cÚ¡ 
s1
,

230 cÚ¡ 
v2
[], cÚ¡ 
s2
, cÚ¡ 
d0
)

232 
w1
 = 0.0f, 
w2
 = 0.0f;

233 
loc1
 = 
d0
*
s1
;

234 
loc2
 = 
d0
*
s2
;

236 
i
 = 0; i < 
d0
; i++)

238 
w1
 = 
v1
[
loc1
+
i
] - 
v2
[
loc2
+i];

239 
w2
 +ğ
w1
*w1;

242 
w2
 = 
	`sq¹
(w2);

244  
w2
;

245 
	}
}

248 
	gPQM©h
::
	$l2d
(cÚ¡ 
v1
[], cÚ¡ 
s1
,

249 cÚ¡ 
S·r£M©rix
 &
b
, cÚ¡ 
s2
, cÚ¡ 
d0
)

251 
w1
 = 0.0f, 
w2
 = 0.0f;

252 
loc1
 = 
d0
*
s1
;

253 *
id
 = 
Ãw
 [
d0
];

254 
	`mem£t
(
id
, 0, 
d0
*());

255 
i
 = 
b
.
cŞ
[
s2
]; i < b.col[s2+1]; i++)

257 
w1
 = 
v1
[
loc1
+
b
.
šdex
[
i
]] - ()b.
d©a
[i];

258 
w2
 +ğ
w1
*w1;

259 
id
[
b
.
šdex
[
i
]] = 1;

261 
i
 = 0; i < 
d0
; i++)

263 if(!
id
[
i
])

264 
w2
 +ğ
v1
[
i
]*v1[i];

267 
w2
 = 
	`sq¹
(w2);

269 
d–‘e
 
id
;

270  
w2
;

271 
	}
}

273 
	gPQM©h
::
	$g‘I2
(cÚ¡ *
Ds
, cÚ¡ 
k
, cÚ¡ 
dim
, cÚ¡ *
tm²s
)

275 
sumD¡
 = 0, 
tmpE
 = 0;

276 
i
 = 0, 
j
 = 0, 
loc
 = 0;

278 
j
 = 0; j < 
k
; j++)

280 if(
tm²s
[
j
] <= 0)

283 
loc
 = 
dim
*
j
;

284 
tmpE
 = 0;

286 
i
 = 0; i < 
dim
; i++)

288 
tmpE
 +ğ
Ds
[
loc
+
i
]*Ds[loc+i];

290 
sumD¡
 +ğ
tmpE
/
tm²s
[
j
];

292  
sumD¡
;

293 
	}
}

295 
	gPQM©h
::
	$g‘E2
(cÚ¡ *
Ds
, cÚ¡ 
k
, cÚ¡ 
dim
, cÚ¡ *
tm²s
)

297 
sumD¡
 = 0, 
tmpE
 = 0;

298 
i
 = 0, 
j
 = 0, 
loc
 = 0, 
loc1
 = 0;

300 
j
 = 0; j < 
k
; j++)

302 if(
tm²s
[
j
] <= 0)

305 
loc1
 = 
dim
*
j
;

306 
j2
 = 
j
 + 1; j2 < 
k
; j2++)

308 
tmpE
 = 0;

309 if(
tm²s
[
j2
] <= 0)

311 
loc
 = 
dim
*
j2
;

312 
i
 = 0; i < 
dim
; i++)

314 
tmpE
 +ğ(
Ds
[
loc
+
i
]/
tm²s
[
j2
] - Ds[
loc1
+i]/tm²s[
j
])*(Ds[loc+i]*tmpns[j] - Ds[loc1+i]*tmpns[j2]);

316 
sumD¡
 +ğ
tmpE
;

319  
sumD¡
;

320 
	}
}

322 
	gPQM©h
::
	$g‘E1
(cÚ¡ *
Ds
, cÚ¡ 
k
, cÚ¡ 
dim
, cÚ¡ *
tm²s
)

324  
	`g‘E2
(
Ds
, 
k
, 
dim
, 
tm²s
);

325 
	}
}

327 
	gPQM©h
::
	$g‘I1
(cÚ¡ *
Ds
, cÚ¡ 
k
, cÚ¡ 
dim
, cÚ¡ *
tm²s
)

329  
	`g‘I2
(
Ds
, 
k
, 
dim
, 
tm²s
);

330 
	}
}

333 
boŞ
 
	gPQM©h
::
	$l2_nÜm
(*
veù1
, cÚ¡ 
dim
)

335 
sz
 = 0;

336 
i
 = 0; i < 
dim
; i++)

338 
sz
 +ğ
veù1
[
i
]*vect1[i];

341 if(
sz
 == 0.0f)

343  
çl£
;

345 
sz
 = 
	`sq¹
(sz);

346 
i
 = 0; i < 
dim
; i++)

348 
veù1
[
i
] = veù1[i]/
sz
;

351  
Œue
;

352 
	}
}

355 
boŞ
 
	gPQM©h
::
	$l2_nÜm
(*
veù1
, cÚ¡ 
dim
)

357 
sz
 = 0;

358 
i
 = 0; i < 
dim
; i++)

360 
sz
 +ğ
veù1
[
i
]*vect1[i];

363 if(
sz
 == 0.0f)

365  
çl£
;

367 
sz
 = 
	`sq¹
(sz);

368 
i
 = 0; i < 
dim
; i++)

370 
veù1
[
i
] = veù1[i]/
sz
;

373  
Œue
;

374 
	}
}

377 
boŞ
 
	gPQM©h
::
	$is_l2NÜm
(cÚ¡ *
veù1
, cÚ¡ 
dim
)

379 
sz
 = 0;

380 
i
 = 0; i < 
dim
; i++)

382 
sz
 +ğ
veù1
[
i
]*vect1[i];

385 if(
sz
 == 0.0f)

387  
Œue
;

390 if(
sz
 < 1.0001 && sz > 0.9998)

392  
Œue
;

394  
çl£
;

396 
	}
}

398 
	gPQM©h
::
	$pow”Law
(*
veù
, cÚ¡ 
®pha
, cÚ¡ 
d0
)

400 
i
 = 0;

401 
tmpV®
;

402 
i
 = 0; i < 
d0
; i++)

404 
tmpV®
 = 
	`çbs
(
veù
[
i
]);

405 
veù
[
i
] = 
PQM©h
::
	`sign
(veù[i])*
	`pow
(
tmpV®
, 
®pha
);

407 
	}
}

409 
	gPQM©h
::
	$nÜmVeùs
(*
veùs
, cÚ¡ 
d0
,

410 cÚ¡ 
n0
, *
Ëns
)

412 
	`as£¹
(
veùs
);

413 
	`as£¹
(
Ëns
);

414 
i
 = 0, 
j
 = 0, 
loc
 = 0;

415 
Ën
 = 0;

416 
i
 = 0; i < 
n0
; i++)

418 
Ën
 = 0;

419 
j
 = 0; j < 
d0
; j++)

421 
Ën
 +ğ
veùs
[
loc
+
j
]*vects[loc+j];

423 
Ën
 = 
	`sq¹
(len);

424 
Ëns
[
i
] = 
Ën
;

425 if(
Ën
 > 
PQM©h
::
sm®lV®0
)

427 
j
 = 0; j < 
d0
; j++)

429 
veùs
[
loc
+
j
] = veùs[loc+j]/
Ën
;

434 
Ëns
[
i
] = 0;

436 
loc
 +ğ
d0
;

439 
	}
}

442 
	gPQM©h
::
	$nÜmVeùs
(*
veùs
, cÚ¡ 
d0
,

443 cÚ¡ 
n0
)

445 
	`as£¹
(
veùs
);

446 
i
 = 0, 
j
 = 0, 
loc
 = 0;

447 
Ën
 = 0;

449 
i
 = 0; i < 
n0
; i++)

451 
Ën
 = 0;

452 
j
 = 0; j < 
d0
; j++)

454 
Ën
 +ğ
veùs
[
loc
+
j
]*vects[loc+j];

456 
Ën
 = 
	`sq¹
(len);

457 if(
Ën
 > 
PQM©h
::
sm®lV®0
)

459 
j
 = 0; j < 
d0
; j++)

461 
veùs
[
loc
+
j
] = veùs[loc+j]/
Ën
;

464 
loc
 +ğ
d0
;

467 
	}
}

469 
	gPQM©h
::
	$sq¹_SIFT
(*
ã©s
, cÚ¡ 
dim
, cÚ¡ 
numb
)

471 
	`as£¹
(
ã©s
);

472 
i
, 
j
, 
loc
;

473 
i
 = 0; i < 
numb
; i++)

475 
loc
 = 
i
*
dim
;

476 
j
 = 0; j < 
dim
; j++)

478 
ã©s
[
loc
+
j
] = 
	`sq¹
(feats[loc+j]);

482 
	}
}

484 
	gPQM©h
::
	$fvec_nÜm
(cÚ¡ *
v
, cÚ¡ 
n
, cÚ¡ 
nÜm
)

486 if(
nÜm
 == 0)

487  
n
;

489 
i
;

490 
s
 = 0;

492 if(
nÜm
 == 1)

494 
i
 = 0 ; i < 
n
 ; i++)

495 
s
 +ğ
	`çbs
(
v
[
i
]);

496  
s
;

499 if(
nÜm
 == 2)

501 
i
 = 0 ; i < 
n
 ; i++)

503 
s
 +ğ
v
[
i
]*v[i];

505  
	`sq¹
(
s
);

508 if(
nÜm
 == -1)

510 
i
 = 0 ; i < 
n
 ; i++)

511 if(
	`çbs
(
v
[
i
]è> 
s
)

512 
s
 = 
	`çbs
(
v
[
i
]);

513  
s
;

516 
i
 = 0 ; i < 
n
 ; i++)

518 
s
 +ğ
	`pow
 (
v
[
i
], 
nÜm
);

521  
	`pow
 (
s
, 1 / 
nÜm
);

522 
	}
}

525 
	gPQM©h
::
	$dvec_nÜm
(cÚ¡ *
v
, cÚ¡ 
n
, cÚ¡ 
nÜm
)

527 if(
nÜm
 == 0)

528  
n
;

530 
i
;

531 
s
 = 0;

533 if(
nÜm
 == 1)

535 
i
 = 0 ; i < 
n
 ; i++)

536 
s
 +ğ
	`çbs
(
v
[
i
]);

537  
s
;

540 if(
nÜm
 == 2)

542 
i
 = 0 ; i < 
n
 ; i++)

544 
s
 +ğ
v
[
i
]*v[i];

546  
	`sq¹
(
s
);

549 if(
nÜm
 == -1)

551 
i
 = 0 ; i < 
n
 ; i++)

552 if(
	`çbs
(
v
[
i
]è> 
s
)

553 
s
 = 
	`çbs
(
v
[
i
]);

554  
s
;

557 
i
 = 0 ; i < 
n
 ; i++)

559 
s
 +ğ
	`pow
 (
v
[
i
], 
nÜm
);

562  
	`pow
 (
s
, 1 / 
nÜm
);

563 
	}
}

565 
	gPQM©h
::
	$šÃrProduù
(cÚ¡ *
v1
, cÚ¡ *
v2
, cÚ¡ 
n
)

567 
s
 = 0;

568 
i
 = 0 ; i < 
n
 ; i++)

570 
s
 +ğ
v1
[
i
]*
v2
[i];

572  
s
;

573 
	}
}

575 
	gPQM©h
::
	$šÃrProduù
(cÚ¡ 
S·r£M©rix
 &
v1
, 
s1
, cÚ¡ S·r£M©rix &
v2
, 
s2
)

577 
i
 = 0;

578 
w
 = 0.0f;

581 
unÜd”ed_m­
<, > 
s
;

582 
unÜd”ed_m­
<, >::
™”©Ü
 
™
;

584 if((
v1
.
cŞ
[
s1
+1] - 
v2
.cŞ[
s2
+1] - v1.col[s1] + v2.col[s2]) > 0)

586 
i
 = 
v1
.
cŞ
[
s1
]; i < v1.col[s1+1]; i++)

588 
s
.
	`š£¹
(
	`make_·œ
(
v1
.
šdex
[
i
],i));

591 
i
 = 
v2
.
cŞ
[
s2
]; i < v2.col[s2+1]; i++)

593 
™
 = 
s
.
	`fšd
(
v2
.
šdex
[
i
]);

594 if(
™
 !ğ
s
.
	`’d
())

596 
w
 +ğ
v1
.
d©a
[
™
->
£cÚd
] * 
v2
.d©a[
i
];

603 
i
 = 
v2
.
cŞ
[
s2
]; i < v2.col[s2+1]; i++)

605 
s
.
	`š£¹
(
	`make_·œ
(
v2
.
šdex
[
i
],i));

608 
i
 = 
v1
.
cŞ
[
s1
]; i < v1.col[s1+1]; i++)

610 
™
 = 
s
.
	`fšd
(
v1
.
šdex
[
i
]);

611 if(
™
 !ğ
s
.
	`’d
())

613 
w
 +ğ
v2
.
d©a
[
™
->
£cÚd
] * 
v1
.d©a[
i
];

618  
w
;

619 
	}
}

621 
boŞ
 
	gPQM©h
::
	$isZ”os
(cÚ¡ *
ã©
, cÚ¡ 
dim
)

623 
j
;

624 
Ën
 = 0;

625 
j
 = 0; j < 
dim
; j++)

627 
Ën
 +ğ
ã©
[
j
]*feat[j];

630 
Ën
 = 
	`sq¹
(len);

631 if(
Ën
 <= 0.0000)

633  
Œue
;

637 
cout
<<
Ën
<<
’dl
;

638  
çl£
;

640 
	}
}

642 
	gPQM©h
::
	$sign
(cÚ¡ 
v®
)

644 if(
v®
 >=0 )

652 
	}
}

655 
boŞ
 
	gPQM©h
::
	$fvec_sÿË
(*
v
, cÚ¡ 
n
, cÚ¡ 
sc
)

657 
	`as£¹
(
sc
!=0.0f);

659 
i
 = 0; i < 
n
; i++)

661 
v
[
i
] = v[i]*
sc
;

663  
Œue
;

664 
	}
}

666 
boŞ
 
	gPQM©h
::
	$dvec_sÿË
(*
v
, cÚ¡ 
n
, cÚ¡ 
sc
)

668 
	`as£¹
(
sc
!=0.0f);

670 
i
 = 0; i < 
n
; i++)

672 
v
[
i
] = v[i]*
sc
;

674  
Œue
;

675 
	}
}

	@/home/pclin/cpp/gkmeans/pqmath.h

1 #iâdeà
PQMATH_H


2 
	#PQMATH_H


	)

15 
	~"¥¬£m©rix.h
"

16 
	~<£t
>

18 
usšg
 
Çme¥aû
 
	g¡d
;

20 şas 
	cPQM©h


22 
	m´iv©e
:

23 cÚ¡ 
sm®lV®0
;

24 
	mpublic
:

25 
cos
(cÚ¡ 
v1
[], cÚ¡ 
s1
,

26 cÚ¡ 
v2
[], cÚ¡ 
s2
, cÚ¡ 
d0
);

28 
l2f
(cÚ¡ 
v1
[], cÚ¡ 
s1
,

29 cÚ¡ 
v2
[], cÚ¡ 
s2
,

30 cÚ¡ 
dim0
);

31 
l2f
(cÚ¡ 
S·r£M©rix
 &
v1
, cÚ¡ 
s1
,

32 cÚ¡ 
S·r£M©rix
 &
v2
, cÚ¡ 
s2
,

33 cÚ¡ 
dim0
);

34 
l2d
(cÚ¡ 
v1
[], cÚ¡ 
s1
,

35 cÚ¡ 
v2
[], cÚ¡ 
s2
,

36 cÚ¡ 
dim0
);

37 
l2d
(cÚ¡ 
v1
[], cÚ¡ 
s1
,

38 cÚ¡ 
v2
[], cÚ¡ 
s2
,

39 cÚ¡ 
dim0
);

41 
l2d
(cÚ¡ 
v1
[], cÚ¡ 
s1
,

42 cÚ¡ 
S·r£M©rix
 &
b
, cÚ¡ 
s2
,

43 cÚ¡ 
dim0
);

44 
g‘I2
(cÚ¡ *
Ds
, cÚ¡ 
k
, cÚ¡ 
dim
, cÚ¡ *
tm²s
);

45 
g‘E2
(cÚ¡ *
Ds
, cÚ¡ 
k
, cÚ¡ 
dim
, cÚ¡ *
tm²s
);

46 
g‘I1
(cÚ¡ *
Ds
, cÚ¡ 
k
, cÚ¡ 
dim
, cÚ¡ *
tm²s
);

47 
g‘E1
(cÚ¡ *
Ds
, cÚ¡ 
k
, cÚ¡ 
dim
, cÚ¡ *
tm²s
);

49 
boŞ
 
l2_nÜm
(*
veù1
, cÚ¡ 
dim
);

50 
boŞ
 
l2_nÜm
(*
veù1
, cÚ¡ 
dim
);

51 
boŞ
 
is_l2NÜm
(cÚ¡ *
veù1
, cÚ¡ 
dim
);

52 
fvec_nÜm
(cÚ¡ *
v
, cÚ¡ 
n
, cÚ¡ 
nÜm
);

53 
dvec_nÜm
(cÚ¡ *
v
, cÚ¡ 
n
, cÚ¡ 
nÜm
);

54 
boŞ
 
¿ndS“ds
(cÚ¡ 
bound
, 
£t
<> &
£eds
, cÚ¡ 
numb
);

56 
šÃrProduù
(cÚ¡ *
v1
, cÚ¡ *
v2
, cÚ¡ 
n
);

57 
šÃrProduù
(cÚ¡ 
S·r£M©rix
 &
v1
,
s1
, cÚ¡ S·r£M©rix &
v2
, 
s2
);

59 
nÜmVeùs
(*
veùs
, cÚ¡ 
d0
,

60 cÚ¡ 
n0
, *
Ëns
);

61 
nÜmVeùs
(*
veùs
, cÚ¡ 
d0
,

62 cÚ¡ 
n0
);

63 
sq¹_SIFT
(*
veùs
, cÚ¡ 
d0
, cÚ¡ 
numb
);

64 
boŞ
 
isZ”os
(cÚ¡ *
ã©
, cÚ¡ 
dim
);

65 
sign
(cÚ¡ 
v®
);

66 
pow”Law
(*
veù
, cÚ¡ 
®pha
, cÚ¡ 
d0
);

68 
boŞ
 
fvec_sÿË
(*
v
, cÚ¡ 
n
, cÚ¡ 
sc
);

69 
boŞ
 
dvec_sÿË
(*
v
, cÚ¡ 
n
, cÚ¡ 
sc
);

71 
	mpublic
:

72 
	$PQM©h
() {}

73 
vœtu®
 ~
	$PQM©h
(è{
	}
}

	@/home/pclin/cpp/gkmeans/print2scrn.cpp

1 
	~"´št2sün.h
"

3 
	~<io¡»am
>

4 
	~<iomª
>

5 
	~<f¡»am
>

6 
	~<ÿs£¹
>

8 
usšg
 
Çme¥aû
 
	g¡d
;

10 
	gPršt2Sün
::
	$´štCLInfo
(cÚ¡ 
CLSInfo
 *
šfo
, cÚ¡ 
n
)

12 
cout
<<"-------------------------------\n";

13 
i
 = 0; i < 
n
; i++)

15 
cout
<<
i
<<"\t"<<
šfo
[i].
n
<<
’dl
;

17 
cout
<<"================================\n";

18 
	}
}

20 
	gPršt2Sün
::
	$´štCLInfo
(cÚ¡ 
CLSInfo
 *
šfo
, cÚ¡ 
n
,

21 cÚ¡ *
d¡â
)

23 
of¡»am
 *
outSŒm
 = 
Ãw
 
	`of¡»am
(
d¡â
, 
ios
::
out
);

24 
i
 = 0; i < 
n
; i++)

26 (*
outSŒm
)<<
i
<<"\t"<<
šfo
[i].
n
<<
’dl
;

28 
outSŒm
->
	`şo£
();

30 
	}
}

32 
	gPršt2Sün
::
´štveù
(
veùÜ
<
NNI‹m
*> &
veùs
)

34 
veùÜ
<
NNI‹m
*>::
™”©Ü
 
v™
;

35 
NNI‹m
* 
	güÁItm
 = 
NULL
;

36 
	gcout
<<"Solution------------------\n";

37 
	gcout
<<" "<<
	gveùs
.
size
()<<" ways of clustering\n";

38 
	gcout
<<"--------------------------\n";

39 
	gcout
<<" Clabel\t Size\tISim\t|\n";

40 
	gcout
<<"--------------------------\n";

41 
	gv™
 = 
veùs
.
begš
(); v™ !ğveùs.
’d
(); vit++)

43 
	güÁItm
 = *
v™
;

44 
	gcout
<<
£tw
(4)<<
	güÁItm
->
	gšdex
<<"\t"<<£tw(4)<<üÁItm->
	gsize
<<"\t+"<<
£»cisiÚ
(4)<<üÁItm->
	gv®
<<"|"<<
	g’dl
;

46 
	gcout
<<"--------------------------\n";

49 
	gPršt2Sün
::
	$´štveù
(*
v
, cÚ¡ 
n
)

51 
cout
<<"----------------------------"<<
’dl
;

52 
i
 = 0; i < 
n
; i++)

54 
cout
<<
v
[
i
]<<" ";

56 
cout
<<"\n----------------------------"<<
’dl
;

57 
	}
}

60 
	gPršt2Sün
::
´štveù
(
veùÜ
<
NNI‹m
*> &
veùs
, cÚ¡ *
d¡_šfo_â
)

62 
as£¹
(
d¡_šfo_â
);

63 
of¡»am
 *
	goutSŒm
 = 
Ãw
 of¡»am(
d¡_šfo_â
, 
ios
::
out
);

64 
	gveùÜ
<
	gNNI‹m
*>::
™”©Ü
 
v™
;

65 
NNI‹m
* 
	güÁItm
;

66 (*
	goutSŒm
)<<"Clabel\tSize\tISim/IDst\n";

67 
	gv™
 = 
veùs
.
begš
(); v™ !ğveùs.
’d
(); vit++)

69 
	güÁItm
 = *
v™
;

70 (*
	goutSŒm
)<<
	güÁItm
->
	gšdex
<<"\t"<<üÁItm->
	gsize
<<"\t"<<
£»cisiÚ
(4)<<üÁItm->
	gv®
<<
	g’dl
;

72 (*
	goutSŒm
).
şo£
();

	@/home/pclin/cpp/gkmeans/print2scrn.h

1 #iâdeà
PRINT2SCRN_H


2 
	#PRINT2SCRN_H


	)

4 
	~"şsšfo.h
"

5 
	~"Â™em.h
"

7 
	~<veùÜ
>

9 
usšg
 
Çme¥aû
 
	g¡d
;

11 şas 
	cPršt2Sün


13 
	mpublic
:

14 
	$Pršt2Sün
() {}

15 
vœtu®
 ~
	$Pršt2Sün
(è{
	}
}

17 
´štveù
(
veùÜ
<
NNI‹m
*> &
veùs
);

18 
´štveù
(
veùÜ
<
NNI‹m
*> &
veùs
, cÚ¡ *
d¡_šfo_â
);

19 
´štveù
(*
v
, cÚ¡ 
n
);

20 
´štCLInfo
(cÚ¡ 
CLSInfo
 *
šfo
, cÚ¡ 
n
);

21 
´štCLInfo
(cÚ¡ 
CLSInfo
 *
šfo
, cÚ¡ 
n
, cÚ¡ *
d¡â
);

	@/home/pclin/cpp/gkmeans/randompartition.cpp

1 
	~"¿ndom·¹™iÚ.h
"

3 
	~"´št2sün.h
"

4 
	~"ißg’t.h
"

5 
	~"ş—Ãr.h
"

6 
	~"v¡ršg.h
"

7 
	~"Â™em.h
"

8 
	~"pqm©h.h
"

9 
	~"tim”.h
"

11 
	~<unÜd”ed_m­
>

12 
	~<®gÜ™hm
>

13 
	~<io¡»am
>

14 
	~<f¡»am
>

15 
	~<c¡ršg
>

16 
	~<iomª
>

17 
	~<lim™s
>

18 
	~<ÿs£¹
>

19 
	~<c¡dlib
>

20 
	~<b™£t
>

21 
	~<veùÜ
>

22 
	~<cm©h
>

23 
	~<ùime
>

25 
usšg
 
Çme¥aû
 
	g¡d
;

27 cÚ¡ 
	gRªdomP¬t™iÚ
::
NTRAILS
= 1;

28 cÚ¡ 
	gRªdomP¬t™iÚ
::
NI‹r
 = 20;

29 cÚ¡ 
	gRªdomP¬t™iÚ
::
E¼0
 = 0;

30 
	gch
 = 10;

31 
	gt1
 = 0, 
	gt2
 = 0, 
	gt3
 = 0;

33 
šlše
 
boŞ
 
m­Ls
(cÚ¡ 
·œ
<, > &
a
, cÚ¡…aœ<, > &
b
)

35  
	ga
.
	gfœ¡
 < 
	gb
.first;

38 
	gRªdomP¬t™iÚ
::
	$RªdomP¬t™iÚ
()

40 
this
->
D1
 = 
NULL
;

41 
this
->
¬¿yD
 = 
NULL
;

42 
this
->
Ns
 = 
NULL
;

43 
this
->
_INIT_
 = 
çl£
;

44 
this
->
_REFER_
 = 
çl£
;

45 
this
->
di¡ªû
 = 
Ãw
 
DISTANCE
::
L2Di¡ªû
<>;

46 
this
->
kmMtd
 = 
_½kmn_
;

47 
	`¡rıy
(
mthSŒ
, "_rpkmn_");

49 
	}
}

51 
	gRªdomP¬t™iÚ
::
RªdomP¬t™iÚ
(cÚ¡ 
DISTANCE
::
Di¡ªû
<>* 
d
):
	$di¡ªû
(
d
)

53 
this
->
D1
 = 
NULL
;

54 
this
->
¬¿yD
 = 
NULL
;

55 
this
->
_INIT_
 = 
çl£
;

56 
this
->
_REFER_
 = 
çl£
;

57 
this
->
kmMtd
 = 
_½kmn_
;

58 
	`¡rıy
(
mthSŒ
, "_rpkmn_");

60 
	}
}

62 
boŞ
 
	gRªdomP¬t™iÚ
::
	$š™
(cÚ¡ *
¤câ
)

64 
cout
<<"Loading matrix ................... ";

65 
	`as£¹
(
¤câ
);

66 
	`¡rıy
(
¤cm©â
, 
¤câ
);

68 if(
VSŒšg
::
	`’dW™h
(
¤câ
, ".txt"))

70 
ù
, 
nd
;

71 
this
->
d©a
 = 
IOAg’t
::
	`lßdM©rix
(
¤câ
, 
ù
, 
nd
);

72 
this
->
couÁ
 = 
ù
;

73 
this
->
ndim
 = 
nd
;

74 
this
->
d©aTy³
 = 0;

76 if(
VSŒšg
::
	`’dW™h
(
¤câ
, ".fvecs"))

78 
ù
, 
nd
;

79 
this
->
d©a
 = 
IOAg’t
::
	`lßd_fvecs
(
¤câ
, 
ù
, 
nd
);

80 
this
->
couÁ
 = 
ù
;

81 
this
->
ndim
 = 
nd
;

82 
this
->
d©aTy³
 = 0;

84 if(
VSŒšg
::
	`’dW™h
(
¤câ
, ".mat"))

86 
ù
, 
nd
;

87 
this
->
d©a
 = 
IOAg’t
::
	`lßdD©
(
¤câ
, 
ù
, 
nd
);

89 
this
->
couÁ
 = 
ù
;

90 
this
->
ndim
 = 
nd
;

94 if(
VSŒšg
::
	`’dW™h
(
¤câ
, ".tvecs"))

96 
ù
, 
nd
;

97 
veùÜ
<> 
ids
;

98 
this
->
d©a
 = 
IOAg’t
::
	`lßdTruncM©
(
¤câ
, 
ù
, 
nd
, 
ids
);

99 
this
->
couÁ
 = 
ù
;

100 
this
->
ndim
 = 
nd
;

101 
ids
.
	`ş—r
();

107 
ù
 = 0, 
nd
 = 0;

108 
this
->
d©a
 = 
IOAg’t
::
	`lßdItms
(
¤câ
, "fsvb", 10000000, 
ù
, 
nd
);

109 
this
->
couÁ
 = 
ù
;

110 
this
->
ndim
 = 
nd
;

113 if(
this
->
d©a
 =ğ
NULL
)

115 
cout
<<"Exceptions ....................... Loading matrix failed!\n";

116 
	`ex™
(0);

119 
cout
<<
this
->
couÁ
<<"x"<<this->
ndim
<<
’dl
;

120 
this
->
_INIT_
 = 
Œue
;

121 
this
->
_REFER_
 = 
çl£
;

122 
this
->
Ns
 = (*)
	`ÿÎoc
Ñhis->
şnumb
, ());

123 
this
->
¬¿yD
 = (*)
	`ÿÎoc
Ñhis->
şnumb
,his->
ndim
*());

125  
Œue
;

126 
	}
}

128 
boŞ
 
	gRªdomP¬t™iÚ
::
	$š™
(*
m©
, cÚ¡ 
row
, cÚ¡ 
dim
)

130 
	`as£¹
(
m©
);

131 if(!
this
->
_REFER_
)

133 if(
this
->
d©a
 !ğ
NULL
)

135 
	`ä“
(
this
->
d©a
);

136 
this
->
d©a
 = 
NULL
;

141 
this
->
d©a
 = 
NULL
;

144 
this
->
d©a
 = 
m©
;

145 
this
->
couÁ
 = 
row
;

146 
this
->
ndim
 = 
dim
;

148 
this
->
_INIT_
 = 
Œue
;

149 
this
->
_REFER_
 = 
Œue
;

150 
this
->
Ns
 = (*)
	`ÿÎoc
Ñhis->
şnumb
, ());

151 
this
->
¬¿yD
 = (*)
	`ÿÎoc
Ñhis->
şnumb
,his->
ndim
*());

153  
Œue
;

154 
	}
}

157 
boŞ
 
	gRªdomP¬t™iÚ
::
	$cÚfig
(cÚ¡ *
_£ed_
, cÚ¡ *
lg_fœ¡
, cÚ¡ *
üŒn
, 
v”bo£
)

159 if(
v”bo£
)

160 
cout
<<"Distance function ................†2\n";

162 if(
v”bo£
)

163 
cout
<<"Seeds ............................ ";

164 if(!
	`¡rcmp
(
_£ed_
, "rnd"))

166 if(
v”bo£
)

167 
cout
<<"rand\n";

168 
£ed
 = 
_ºd_
;

170 if(!
	`¡rcmp
(
_£ed_
, "kpp"))

173 if(
v”bo£
)

174 
cout
<<"kpp\n";

175 
£ed
 = 
_kµ_
;

179 if(
v”bo£
)

180 
cout
<<"non\n";

181 
£ed
 = 
_nÚ_
;

184 if(
v”bo£
)

185 
cout
<<"Optimization function ............ ";

186 if(!
	`¡rcmp
(
üŒn
, "i1"))

188 
myİtz
 = 
_I1_
;

189 if(
v”bo£
)

190 
cout
<<"I1\n";

192 if(!
	`¡rcmp
(
üŒn
, "i2"))

194 
myİtz
 = 
_I2_
;

195 if(
v”bo£
)

196 
cout
<<"I2\n";

198 if(!
	`¡rcmp
(
üŒn
, "i3"))

200 
myİtz
 = 
_I3_
;

201 if(
v”bo£
)

202 
cout
<<"I3\n";

204 if(!
	`¡rcmp
(
üŒn
, "i4"))

206 
myİtz
 = 
_I4_
;

207 if(
v”bo£
)

208 
cout
<<"e1\n";

210 if(!
	`¡rcmp
(
üŒn
, "e1") )

212 
myİtz
 = 
_E1_
;

213 if(
v”bo£
)

214 
cout
<<"e1\n";

216 if(!
	`¡rcmp
(
üŒn
, "e2") )

218 
myİtz
 = 
_E2_
;

219 if(
v”bo£
)

220 
cout
<<"e2\n";

222 if(!
	`¡rcmp
(
üŒn
, "t1"))

224 
myİtz
 = 
_T1_
;

225 if(
v”bo£
)

226 
cout
<<"t1\n";

228 if(!
	`¡rcmp
(
üŒn
, "i4"))

230 
myİtz
 = 
_I4_
;

231 if(
v”bo£
)

232 
cout
<<"i4\n";

236 
cout
<<"UnkowÀİtimizİtiÚ '"<<
üŒn
<<"'!\n";

237 
	`ex™
(0);

240  
Œue
;

241 
	}
}

244 
	gRªdomP¬t™iÚ
::
	$şu¡
(cÚ¡ 
şu¡_num
, cÚ¡ *
d¡â
, cÚ¡ 
v”bo£
)

246 
i
, 
j
, 
k
, 
d
, 
num
, 
Æab–
, 
şab–
 = 0;

247 
veùÜ
<> 
tmpşu¡”
;

249 
this
->
D1
 = 
Ãw
 [this->
ndim
];

250 
this
->
D2
 = 
Ãw
 [this->
ndim
];

251 
this
->
C1
 = 
Ãw
 [this->
ndim
];

252 
this
->
C2
 = 
Ãw
 [this->
ndim
];

253 
this
->
tmpC1
 = 
Ãw
 [this->
ndim
];

254 
this
->
tmpC2
 = 
Ãw
 [this->
ndim
];

257 
this
->
şu¡”s
 = 
Ãw
 
veùÜ
<>[this->
şnumb
];

258 
i
 = 0; i < 
this
->
şnumb
; i++)

260 
this
->
şu¡”s
[
i
].
	`ş—r
();

263 
i
 = 0; i < 
this
->
couÁ
; i++)

265 
this
->
şu¡”s
[0].
	`push_back
(
i
);

267 
j
 = 0; j < 
şu¡_num
; j++)

269 
this
->
šfoM­
[
j
].
E
 = 0.0f;

270 
this
->
šfoM­
[
j
].
n
 = 0;

273 
şab–
 = 0;

275 
Æab–
 = 1;

276 
d
 = 0;

278 
k
 = 0;

279 
num
 = 1;

280 if(
v”bo£
)

281 
cout
<<"Clustering ....................... on…rogress\n";

283 
Æab–
 < 
şnumb
)

286 if(!
this
->
_REFINE_
)

287 
this
->
	`gkm—nI‹r
(
şab–
, 
Æab–
);

289 
this
->
	`¿ndom
(
şab–
, 
Æab–
);

292 
tmpşu¡”
.
	`ş—r
();

293 
tmpşu¡”
.
	`»£rve
(
şu¡”s
[
şab–
].
	`size
());

295 autØ
™
 = 
this
->
şu¡”s
[
şab–
].
	`begš
(); iˆ!ğthis->şu¡”s[şab–].
	`’d
(); it++)

297 
tmpşu¡”
.
	`push_back
(*
™
);

300 
şu¡”s
[
şab–
].
	`ş—r
();

301 
şu¡”s
[
şab–
].
	`»£rve
(
this
->
Ns
[clabel]);

303 
şu¡”s
[
Æab–
].
	`»£rve
(
this
->
Ns
[nlabel]);

304 autØ
™
 = 
tmpşu¡”
.
	`begš
(); iˆ!ğtmpşu¡”.
	`’d
(); it++)

306 
şu¡”s
[
Ïb–s
[*
™
]].
	`push_back
(*it);

309 
k
++;

310 if(
k
 =ğ
num
)

312 
d
++;

313 
k
 = 0;

314 
num
 =‚um*2;

316 
şab–
 = 
k
;

318 
Æab–
++;

321 
i
 = 0; i < 
couÁ
; i++)

323 
şab–
 = 
Ïb–s
[
i
];

324 
j
 = 0; j < 
this
->
ndim
; j++)

326 
this
->
¬¿yD
[
şab–
*this->
ndim
+
j
] +ğthis->
d©a
[
i
*this->ndim+j];

330 
this
->
	`ÿlAVGDi¡
Ñhis->
¬¿yD
,his->
Ns
, 
şu¡_num
, 
šfoM­
);

332 if(!
this
->
_REFER_
)

334 
this
->
	`§veC’‹rs
(
d¡â
, 0);

338 
i
 = 0; i < 
this
->
şnumb
; i++)

340 
this
->
şu¡”s
[
i
].
	`ş—r
();

344 
d–‘e
 [] 
this
->
şu¡”s
;

345 
this
->
şu¡”s
 = 
NULL
;

346 
d–‘e
 [] 
D1
;

347 
d–‘e
 [] 
D2
;

348 
d–‘e
 [] 
C1
;

349 
d–‘e
 [] 
C2
;

350 
d–‘e
 [] 
tmpC1
;

351 
d–‘e
 [] 
tmpC2
;

352 
D1
 = 
NULL
;

353 
D2
 = 
NULL
;

354 
C1
 = 
NULL
;

355 
C2
 = 
NULL
;

356 
tmpC1
 = 
NULL
;

357 
tmpC2
 = 
NULL
;

360 
	}
}

362 
	gRªdomP¬t™iÚ
::
	$gkm—nI‹r
(
şab–
, 
nwlbl
)

364 
_loc1
 = 0, 
_loc2
 = 0, 
loc
 = 0;

365 
i
 = 0, 
j
 = 0, 
r
 = 0;

366 
ıysize
 = ()*
this
->
ndim
;

367 
tmp1
 = 0, 
tmp2
 = 0, 
Ën
 = 0, 
n1
, 
n2
;

368 
šnDùs
[2];

370 
veùÜ
<> 
üÁClu¡
 = 
this
->
şu¡”s
[
şab–
];

372 
numb
 = 
üÁClu¡
.
	`size
();

373 *
¾
 = 
Ãw
 [
numb
];

374 
i
 = 0; i < 
numb
; i++)

376 
¾
[
i
] = i;

378 if(
numb
 == 2)

380 
i
 = 
üÁClu¡
[1];

381 
this
->
Ïb–s
[
i
] = 
nwlbl
;

382 
this
->
Ns
[
şab–
] = 1;

383 
this
->
Ns
[
nwlbl
] = 1;

384  
Œue
;

386 if(
numb
 < 2)

388 
cout
<<"unseperatable\n";

391 *
nwÏb–s
 = 
Ãw
 [
numb
];

392 
	`mem£t
(
nwÏb–s
, 0, ()*
numb
);

394 
v
 = 0, 
tm²1
 = 0, 
tm²2
 = 0;

395 
£d1
 = 0, 
£d2
 = 0, 
™”
 = 0;

396 
tmpEg
 = 0, 
İtEg
 = 0, 
d¡1
 = 0, 
d¡2
 = 0;

397 
boŞ
 
_UPDATE_
 = 
Œue
, 
F2S
 = 
çl£
;

398 
n1
 = 
n2
 = 0;

402 
	`mem£t
(
D1
, 0, 
ıysize
);

403 
	`mem£t
(
D2
, 0, 
ıysize
);

404 
šnDùs
[0] = innDcts[1] = 0;

406 if(
this
->
£ed
 !ğ
_nÚ_
)

408 
	`¿ndom_shufæe
(
¾
,„l+
numb
);

409 
£d1
 = 
üÁClu¡
[
¾
[0]];

410 
£d2
 = 
üÁClu¡
[
¾
[1]];

411 
_loc1
 = 
£d1
*
this
->
ndim
;

412 
_loc2
 = 
£d2
*
this
->
ndim
;

413 
j
 = 0; j < 
this
->
ndim
; j++)

415 
tmpC1
[
j
] = 
this
->
d©a
[
_loc1
+j];

416 
tmpC2
[
j
] = 
this
->
d©a
[
_loc2
+j];

418 
i
 = 0; i < 
numb
; i++)

420 
v
 = 
üÁClu¡
[
i
];

421 
mvs
[0]++;

422 
d¡1
 = 
PQM©h
::
	`l2f
(
tmpC1
, 0, 
this
->
d©a
, 
v
,his->
ndim
);

423 
d¡2
 = 
PQM©h
::
	`l2f
(
tmpC2
, 0, 
this
->
d©a
, 
v
,his->
ndim
);

424 
loc
 = 
v
*
this
->
ndim
;

426 if(
d¡1
 < 
d¡2
)

428 
j
 = 0; j < 
this
->
ndim
; j++)

430 
this
->
D1
[
j
] +ğthis->
d©a
[
loc
+j];

432 
tm²1
++;

433 
nwÏb–s
[
i
] = -1;

437 
j
 = 0; j < 
this
->
ndim
; j++)

439 
D2
[
j
] +ğ
this
->
d©a
[
loc
+j];

441 
tm²2
++;

442 
nwÏb–s
[
i
] = 
v
;

448 
	`¿ndom_shufæe
(
¾
,„l+
numb
);

449 
loc
 = 
	`¿nd
()%
numb
;

450 if(
loc
 == 0)

451 
loc
 = 1;

452 
i
 = 0; i < 
loc
; i++)

454 
v
 = 
üÁClu¡
[
¾
[
i
]];

455 
j
 = 0; j < 
this
->
ndim
; j++)

457 
this
->
D1
[
j
] +ğthis->
d©a
[
v
*
ndim
+j];

459 
tm²1
++;

460 
nwÏb–s
[
¾
[
i
]] = -1;

462 
i
 < 
numb
)

464 
v
 = 
üÁClu¡
[
¾
[
i
]];

465 
j
 = 0; j < 
this
->
ndim
; j++)

467 
this
->
D2
[
j
] +ğthis->
d©a
[
v
*
ndim
+j];

469 
tm²2
++;

470 
nwÏb–s
[
¾
[
i
]] = 
v
;

471 
i
++;

474 
šnDùs
[0] = 
PQM©h
::
	`fvec_nÜm
(
D1
, 
this
->
ndim
, 2);

475 
šnDùs
[1] = 
PQM©h
::
	`fvec_nÜm
(
D2
, 
this
->
ndim
, 2);

476 
šnDùs
[0] = innDcts[0]*innDcts[0];

477 
šnDùs
[1] = innDcts[1]*innDcts[1];

479 
İtEg
 = 
šnDùs
[0]/
tm²1
 + iÂDùs[1]/
tm²2
;

485 
	`¿ndom_shufæe
(
¾
,„È+ 
numb
);

486 
_UPDATE_
 = 
çl£
;

487 
™”
 = 0; i‹¸< 
numb
; iter++)

489 
mvs
[0]++;

490 
r
 = 
¾
[
™”
];

491 
v
 = 
üÁClu¡
[
r
];

492 
loc
 = 
v
*
this
->
ndim
;

493 
F2S
 = 
çl£
;

494 if(
nwÏb–s
[
r
] == -1)

496 if(
tm²1
 > 1)

498 
tm²1
--;

499 
tm²2
++;

500 
nwÏb–s
[
r
] = 
v
;

501 
F2S
 = 
Œue
;

510 if(
tm²2
 > 1)

512 
tm²1
++;

513 
tm²2
--;

514 
nwÏb–s
[
r
] = -1;

515 
F2S
 = 
çl£
;

523 
tmp1
 = 
tmp2
 = 0;

524 
j
 = 0; j < 
this
->
ndim
; j++)

526 
tmp1
 +ğ
D1
[
j
]*
d©a
[
loc
+j];

527 
tmp2
 +ğ
D2
[
j
]*
d©a
[
loc
+j];

530 
Ën
 = 
this
->
Ëns
[
v
];

531 if(
F2S
)

533 
tmp1
 = 
šnDùs
[0] - 2*tmp1 + 
Ën
;

534 
tmp2
 = 
šnDùs
[1] + 2*tmp2 + 
Ën
;

539 
tmp1
 = 
šnDùs
[0] + 2*tmp1 + 
Ën
;

540 
tmp2
 = 
šnDùs
[1] - 2*tmp2 + 
Ën
;

543 
tmpEg
 = 
tmp1
/
tm²1
 + 
tmp2
/
tm²2
;

546 if(
tmpEg
 > (
İtEg
+0.00001))

548 if(
F2S
)

550 
j
 = 0; j < 
this
->
ndim
; j++)

552 
D1
[
j
] -ğ
this
->
d©a
[
loc
+j];

553 
D2
[
j
] +ğ
this
->
d©a
[
loc
+j];

558 
j
 = 0; j < 
this
->
ndim
; j++)

560 
D1
[
j
] +ğ
this
->
d©a
[
loc
+j];

561 
D2
[
j
] -ğ
this
->
d©a
[
loc
+j];

564 
İtEg
 = 
tmpEg
;

565 
šnDùs
[0] = 
tmp1
;

566 
šnDùs
[1] = 
tmp2
;

567 
_UPDATE_
 = 
Œue
;

568 
mvs
[1]++;

573 if(
nwÏb–s
[
r
] == -1)

575 
tm²1
--;

576 
tm²2
++;

577 
nwÏb–s
[
r
] = 
v
;

581 
tm²1
++;

582 
tm²2
--;

583 
nwÏb–s
[
r
] = -1;

588 
™”
++;

589 if(
™”
 > 
this
->
NI‹r
)

591 }
_UPDATE_
);

593 
vr
 = 0;

594 
·œ
<, > *
vlm­
 = 
Ãw
…aœ<, >[
numb
];

595 
i
 = 0; i < 
ndim
; i++)

597 
D2
[
i
] -ğ
D1
[i];

598 
D2
[
i
] /ğ
numb
;

601 
i
 = 0; i < 
numb
; i++)

603 
r
 = 
üÁClu¡
[
i
];

604 
vr
 = 0;

605 
j
 = 0; j < 
ndim
; j++)

607 
vr
 +ğ
d©a
[
r
*
ndim
+
j
]*
D2
[j];

609 
vlm­
[
i
].
fœ¡
 = 
vr
;

610 
vlm­
[
i
].
£cÚd
 = 
r
;

613 
	`sÜt
(
vlm­
, vlm­+
numb
, 
m­Ls
);

614 
n1
 = (
numb
+1)/2;

615 
n2
 = 
numb
-
n1
;

616 
this
->
Ns
[
şab–
] = 
n1
;

617 
this
->
Ns
[
nwlbl
] = 
n2
;

618 
i
 = 0; i < 
n1
; i++)

620 
v
 = 
vlm­
[
i
].
£cÚd
;

621 
Ïb–s
[
v
] = 
şab–
;

624 
i
 < 
numb
)

626 
v
 = 
vlm­
[
i
].
£cÚd
;

627 
Ïb–s
[
v
] = 
nwlbl
;

628 
i
++;

631 
d–‘e
 [] 
vlm­
;

632 
d–‘e
 [] 
nwÏb–s
;

633 
d–‘e
 [] 
¾
;

634 
nwÏb–s
 = 
NULL
;

636  
Œue
;

637 
	}
}

639 
	gRªdomP¬t™iÚ
::
	$¿ndP¬t™iÚ
(
şab–
, 
Æab–
)

641 
i
 = 0, 
k
 = 0, 
numb
 = 0;

642 
n1
 = 0, 
n2
 = 0, 
r
 = 0, 
v
 = 0, 
m1
 = 0, 
m2
 = 0;

643 
v®
 = 0, 
vmš
 = -1;

644 
veùÜ
<> 
üÁClu¡
 = 
this
->
şu¡”s
[
şab–
];

645 
·œ
<, > *
vlm­
 = 
NULL
;

646 
numb
 = 
üÁClu¡
.
	`size
();

647 
vr
 = 0;

648 
boŞ
 
isz”o
 = 
Œue
;

650 
vlm­
 = 
Ãw
 
·œ
<, >[
numb
];

651 *
¾
 = 
Ãw
 [
numb
];

652 
i
 = 0; i < 
numb
; i++)

654 
¾
[
i
] = i;

656 
k
 = 0; k < 
this
->
NI‹r
; k++)

659 
	`¿ndom_shufæe
(
¾
,„l+
numb
);

660 
r
 = 
üÁClu¡
[
¾
[0]];

661 
v
 = 
üÁClu¡
[
¾
[1]];

662 
i
 = 0; i < 
ndim
; i++)

664 
D2
[
i
] = 
d©a
[
r
*
ndim
+i];

665 
D1
[
i
] = 
d©a
[
v
*
ndim
+i];

667 
i
 = 0; i < 
ndim
; i++)

669 
D2
[
i
] = D2[i] - 
D1
[i];

670 if(
D2
[
i
] != 0)

671 
isz”o
 = 
çl£
;

673 
isz”o
)

675 
i
 = 0; i < 
ndim
; i++)

677 
D2
[
i
] = (
	`¿nd
()+0.0)/
RAND_MAX
;

678 if(
D2
[
i
] != 0)

679 
isz”o
 = 
çl£
;

682 
i
 = 0; i < 
numb
; i++)

684 
r
 = 
üÁClu¡
[
i
];

685 
vr
 = 
this
->
di¡ªû
->
	`dÙ
(
d©a
+
r
*
ndim
, 
D2
,‚dim);

686 
vlm­
[
i
].
fœ¡
 = 
vr
;

687 
vlm­
[
i
].
£cÚd
 = 
r
;

690 
	`sÜt
(
vlm­
, vlm­+
numb
, 
m­Ls
);

692 
n1
 = (
numb
+1)/2;

693 
n2
 = 
numb
-
n1
;

694 
m1
 = 
n1
/2;

695 
m2
 = (
numb
+
n1
)/2;

697 
v®
 = 
vlm­
[
m2
].
fœ¡
 - vlm­[
m1
].first;

700 if(
v®
 > 
vmš
)

703 
vmš
 = 
v®
;

704 
i
 = 0; i < 
n1
; i++)

706 
v
 = 
vlm­
[
i
].
£cÚd
;

707 
Ïb–s
[
v
] = 
şab–
;

709 
i
 < 
numb
)

711 
v
 = 
vlm­
[
i
].
£cÚd
;

712 
Ïb–s
[
v
] = 
Æab–
;

713 
i
++;

715 
this
->
Ns
[
şab–
] = 
n1
;

716 
this
->
Ns
[
Æab–
] = 
n2
;

721 
d–‘e
 [] 
vlm­
;

722 
d–‘e
 [] 
¾
;

723 
vlm­
 = 
NULL
;

724 
¾
 = 
NULL
;

725  
Œue
;

726 
	}
}

728 
	gRªdomP¬t™iÚ
::
	$KDT»e
(
şab–
, 
Æab–
)

730 
i
 = 0, 
k
 = 0, 
numb
 = 0, 
n1
 = 0;

731 
n2
 = 0, 
r
 = 0, 
v
 = 0, 
m1
 = 0, 
m2
 = 0;

732 
v®
 = 0, 
vmš
 = -1;

733 
veùÜ
<> 
üÁClu¡
 = 
this
->
şu¡”s
[
şab–
];

734 
·œ
<, > *
vlm­
 = 
NULL
;

735 
numb
 = 
üÁClu¡
.
	`size
();

736 
vr
 = 0;

737 
boŞ
 
isz”o
 = 
Œue
;

739 
vlm­
 = 
Ãw
 
·œ
<, >[
numb
];

742 
k
 = 
	`¿nd
()%
this
->
ndim
;

743 
i
 = 0; i < 
numb
; i++)

745 
r
 = 
üÁClu¡
[
i
];

746 
vr
 = 0;

747 
vr
 +ğ
d©a
[
r
*
ndim
+
k
]*
D2
[k];

748 
vlm­
[
i
].
fœ¡
 = 
vr
;

749 
vlm­
[
i
].
£cÚd
 = 
r
;

752 
	`sÜt
(
vlm­
, vlm­+
numb
, 
m­Ls
);

754 
n1
 = (
numb
+1)/2;

755 
n2
 = 
numb
-
n1
;

756 
m1
 = 
n1
/2;

757 
m2
 = (
numb
+
n1
)/2;

759 
v®
 = 
vlm­
[
m2
].
fœ¡
 - vlm­[
m1
].first;

762 if(
v®
 > 
vmš
)

765 
vmš
 = 
v®
;

766 
i
 = 0; i < 
n1
; i++)

768 
v
 = 
vlm­
[
i
].
£cÚd
;

769 
Ïb–s
[
v
] = 
şab–
;

771 
i
 < 
numb
)

773 
v
 = 
vlm­
[
i
].
£cÚd
;

774 
Ïb–s
[
v
] = 
Æab–
;

775 
i
++;

777 
this
->
Ns
[
şab–
] = 
n1
;

778 
this
->
Ns
[
Æab–
] = 
n2
;

782 
d–‘e
 [] 
vlm­
;

783 
vlm­
 = 
NULL
;

784  
Œue
;

785 
	}
}

787 
	gRªdomP¬t™iÚ
::
	$¿ndom
(
şab–
, 
Æab–
)

789 
i
 = 0, 
numb
 = 0, 
n1
 = 0, 
n2
 = 0, 
r
 = 0, 
v
 = 0;

790 
veùÜ
<> 
üÁClu¡
 = 
this
->
şu¡”s
[
şab–
];

791 
·œ
<, > *
vlm­
 = 
NULL
;

792 
numb
 = 
üÁClu¡
.
	`size
();

793 
vr
 = 0;

794 
boŞ
 
isz”o
 = 
Œue
;

796 
vlm­
 = 
Ãw
 
·œ
<, >[
numb
];

798 *
¾
 = 
Ãw
 [
numb
];

799 
i
 = 0; i < 
numb
; i++)

801 
¾
[
i
] = i;

804 
	`¿ndom_shufæe
(
¾
,„l+
numb
);

805 
r
 = 
üÁClu¡
[
¾
[0]];

806 
v
 = 
üÁClu¡
[
¾
[1]];

807 
i
 = 0; i < 
ndim
; i++)

809 
D2
[
i
] = 
d©a
[
r
*
ndim
+i];

810 
D1
[
i
] = 
d©a
[
v
*
ndim
+i];

812 
i
 = 0; i < 
ndim
; i++)

814 
D2
[
i
] = D2[i] - 
D1
[i];

815 if(
D2
[
i
] != 0)

816 
isz”o
 = 
çl£
;

818 
isz”o
)

820 
i
 = 0; i < 
ndim
; i++)

822 
D2
[
i
] = (
	`¿nd
()+0.0)/
RAND_MAX
;

823 if(
D2
[
i
] != 0)

824 
isz”o
 = 
çl£
;

828 
i
 = 0; i < 
numb
; i++)

830 
r
 = 
üÁClu¡
[
i
];

832 
vr
 = 
this
->
di¡ªû
->
	`dÙ
(
D2
,his->
d©a
+
r
*
ndim
,‚dim);

833 
vlm­
[
i
].
fœ¡
 = 
vr
;

834 
vlm­
[
i
].
£cÚd
 = 
r
;

837 
	`sÜt
(
vlm­
, vlm­+
numb
, 
m­Ls
);

839 
n1
 = (
numb
+1)/2;

840 
n2
 = 
numb
-
n1
;

844 
i
 = 0; i < 
n1
; i++)

846 
v
 = 
vlm­
[
i
].
£cÚd
;

847 
Ïb–s
[
v
] = 
şab–
;

849 
i
 < 
numb
)

851 
v
 = 
vlm­
[
i
].
£cÚd
;

852 
Ïb–s
[
v
] = 
Æab–
;

853 
i
++;

855 
this
->
Ns
[
şab–
] = 
n1
;

856 
this
->
Ns
[
Æab–
] = 
n2
;

859 
d–‘e
 [] 
vlm­
;

860 
d–‘e
 [] 
¾
;

861 
vlm­
 = 
NULL
;

862 
¾
 = 
NULL
;

863  
Œue
;

864 
	}
}

866 
	gRªdomP¬t™iÚ
::
	$§veC’‹rs
(cÚ¡ *
d¡â
, 
boŞ
 
­³nd
)

868 
şab–
 = 0, 
j
, 
loc
, 
rCNum
 = 0;

869 
of¡»am
 *
outSŒm
 = 
NULL
;

871 
şab–
 = 0; cÏb– < 
this
->
şnumb
; clabel++)

873 if(
this
->
šfoM­
[
şab–
].
n
 > 0)

875 
rCNum
++;

879 if(!
this
->
_INIT_
||
rCNum
 == 0)

884 if(
­³nd
)

886 
outSŒm
 = 
Ãw
 
	`of¡»am
(
d¡â
, 
ios
::
­p
);

890 
outSŒm
 = 
Ãw
 
	`of¡»am
(
d¡â
, 
ios
::
out
);

891 (*
outSŒm
)<<
rCNum
<<" "<<
this
->
ndim
<<
’dl
;;

893 
şab–
 = 0; cÏb– < 
this
->
şnumb
; clabel++)

895 
loc
 = 
şab–
*
this
->
ndim
;

897 if(
this
->
šfoM­
[
şab–
].
n
 <= 0)

900 
j
 = 0; j < 
this
->
ndim
; j++)

902 (*
outSŒm
)<<
this
->
¬¿yD
[
loc
+
j
]/this->
šfoM­
[
şab–
].
n
<<" ";

904 (*
outSŒm
)<<
’dl
;

907 
outSŒm
->
	`şo£
();

909 
	}
}

911 
	gRªdomP¬t™iÚ
::
	$ãtchC’‹rs
(*
ûÁ”s
)

913 
şab–
 = 0, 
j
 = 0, 
loc
 = 0, 
idxi
 = 0, 
rCNum
 = 0;

914 
	`as£¹
(
ûÁ”s
);

916 
şab–
 = 0; cÏb– < 
this
->
şnumb
; clabel++)

918 if(
this
->
šfoM­
[
şab–
].
n
 > 0)

920 
rCNum
++;

924 if(!
this
->
_INIT_
||
rCNum
 == 0)

926 
	`mem£t
(
ûÁ”s
, 0, 
this
->
şnumb
*this->
ndim
*());

930 
şab–
 = 0; cÏb– < 
this
->
şnumb
; clabel++)

932 
loc
 = 
şab–
*
this
->
ndim
;

934 if(
this
->
šfoM­
[
şab–
].
n
 <= 0)

937 
j
 = 0; j < 
this
->
ndim
; j++)

939 
ûÁ”s
[
idxi
 + 
j
] = 
this
->
¬¿yD
[
loc
+j]/this->
šfoM­
[
şab–
].
n
;

941 
idxi
 +ğ
this
->
ndim
;

943  
rCNum
;

944 
	}
}

946 
	gRªdomP¬t™iÚ
::~
	$RªdomP¬t™iÚ
()

948 if(
this
->
Ns
 !ğ
NULL
)

950 
	`ä“
(
this
->
Ns
);

951 
this
->
Ns
 = 
NULL
;

953 if(
this
->
¬¿yD
 !ğ
NULL
)

955 
	`ä“
(
this
->
¬¿yD
);

956 
this
->
¬¿yD
 = 
NULL
;

958 
	}
}

960 
	$v‹¡
()

963 cÚ¡ *
¤câ
 = "/home/chenghaod/data/sift/raw/sift_learn.txt";

964 cÚ¡ *
d¡â
 = "/home/chenghaod/dataset/vlad/ox5kbowhe.out";

965 
i
 = 0, 
j
 = 0, 
id
 = 0;

966 
şnumb
;

967 
şlv
 = 10;

968 
™
 = 10;

969 
num
 = 100000;

970 
¹
 = 0;

971 
şnumb
 = 
	`pow
(2, 
şlv
);

972 *
Ïb–
 = 
Ãw
 [
num
];

974 
tmpid
[200];

975 *
¹İ
 = 
Ãw
 [200*
num
];

976 
if¡»am
 
	`is
("nn.txt");

977 
i
 = 0; i < 
num
; i++)

979 
j
 = 0; j < 200; j++)

981 
is
>>
id
;

982 
tmpid
[
j
] = 
id
;

984 
j
 = 0; j < 200; j++)

985 
¹İ
[
i
*200+
j
] = 
tmpid
[j];

987 
is
.
	`şo£
();

989 
RªdomP¬t™iÚ
 *
mykm
;

990 
i
 = 0; i < 
™
; i++)

992 
mykm
 = 
Ãw
 
	`RªdomP¬t™iÚ
();

993 
mykm
->
	`budşu¡”
(
¤câ
, 
d¡â
, "nÚ", "Ïrge", "i2", 
şnumb
, 
çl£
);

994 
mykm
->
	`g‘Lab–
(
Ïb–
);

995 
d–‘e
 
mykm
;

997 
j
 = 0; j < 
num
; j++)

999 if(
Ïb–
[
j
] =ğÏb–[
¹İ
[j*200+99]])

1000 
¹
++;

1004 
cout
<<
¹
<<"„©"<<Ôt+0.0)/
num
/
™
<<
’dl
;

1006 
d–‘e
 [] 
Ïb–
;

1007 
d–‘e
 [] 
¹İ
;

1010 
	}
}

1012 
	gRªdomP¬t™iÚ
::
	$‹¡
()

1016 cÚ¡ *
¤cM©Fn1
 = "/home/chenghaod/datasets/bignn/mat/sift1m/sift_base.txt";

1017 cÚ¡ *
¤cM©Fn2
 = "/home/chenghaod/datasets/bignn/mat/sift_learn.txt";

1018 cÚ¡ *
¤cM©Fn3
 = "itm_vlad_hesaff_flickr10m.itm";

1019 cÚ¡ *
d¡â
 = "/home/chenghaod/datasets/vlad/ox5kbowhe.out";

1022 cÚ¡ *
¤câ
 = "/home/chenghaod/data/sift/raw/sift_base.fvecs";

1026 
RªdomP¬t™iÚ
 *
mykm
 = 
Ãw
 
	`RªdomP¬t™iÚ
();

1027 
mykm
->
	`budşu¡”
(
¤câ
, 
d¡â
, "nÚ", "Ïrge", "i2", 1000, 
çl£
);

1028 
d–‘e
 
mykm
;

1029 
	}
}

	@/home/pclin/cpp/gkmeans/randompartition.h

12 #iâdeà
RANDOMPARTITION_H


13 
	#RANDOMPARTITION_H


	)

15 
	~"ab¡¿ùkm—ns.h
"

16 
	~"di¡ªû.hµ
"

17 
	~"Â™em.h
"

19 
	~<£t
>

20 
	~<m­
>

21 
	~<unÜd”ed_£t
>

23 şas 
	cRªdomP¬t™iÚ
: 
public
 
Ab¡¿ùKM—ns


25 cÚ¡ 
DISTANCE
::
Di¡ªû
<>* 
di¡ªû
;

26 cÚ¡ 
	mNTRAILS
;

27 cÚ¡ 
	mNI‹r
;

28 cÚ¡ 
	mE¼0
;

29 *
	mD1
, *
	mD2
, *
	mC1
, *
	mC2
, *
	mtmpC1
, *
	mtmpC2
;

30 *
	m¬¿yD
;

31 *
	mNs
;

33 
	mveùÜ
<> *
	mşu¡”s
;

35 
	mpublic
 :

36 
RªdomP¬t™iÚ
();

37 
RªdomP¬t™iÚ
(cÚ¡ 
DISTANCE
::
Di¡ªû
<>* );

38 
	mvœtu®
 ~
RªdomP¬t™iÚ
();

39 
boŞ
 
š™
(cÚ¡ *
¤câ
);

40 
boŞ
 
š™
(*
m©
, cÚ¡ 
row
, cÚ¡ 
dim
);

41 
boŞ
 
š™
(*
m©
, cÚ¡ 
row
, cÚ¡ 
dim
);

43 
gkm—nI‹r
(
Ïb–
, 
Æab–
);

44 
¿ndP¬t™iÚ
(
Ïb–
, 
Æab–
);

45 
KDT»e
(
Ïb–
, 
Æab–
);

47 
¿ndom
(
Ïb–
, 
Æab–
);

48 
boŞ
 
cÚfig
(cÚ¡ *
_£ed_
, cÚ¡ *
lg_fœ¡
, cÚ¡ *
üŒn
, 
v”bo£
);

50 
şu¡
(cÚ¡ 
şu¡_num
, cÚ¡ *
d¡â
, cÚ¡ 
v”bo£
);

51 
boŞ
 
ºdS“ds
(cÚ¡ 
k
, 
r£eds
[], cÚ¡ 
bound
);

52 
boŞ
 
kµS“ds
(cÚ¡ 
k
, 
r£eds
[], cÚ¡ 
bound
);

53 
§veC’‹rs
(cÚ¡ *
d¡â
, 
boŞ
 
­³nd
);

54 
ãtchC’‹rs
(*
ûÁ”s
);

56 
‹¡
();

	@/home/pclin/cpp/gkmeans/scriptparser.cpp

1 
	~"sü¬£r.h
"

2 
	~"v¡ršg.h
"

4 
	~<io¡»am
>

5 
	~<f¡»am
>

6 
	~<c¡ršg
>

7 
	~<c¡dlib
>

8 
	~<ÿs£¹
>

9 
	~<li¡
>

11 
usšg
 
Çme¥aû
 
	g¡d
;

13 
	gm­
<
	g¡ršg
, cÚ¡ *> 
	gSütP¬£r
::
	$g‘CÚf
(cÚ¡ *
â
)

15 
	`as£¹
(
â
);

16 
FILE
 *
å
 = 
	`fİ’
(
â
, "r");

17 if(
å
 =ğ
NULL
)

19 
	`´štf
("CÚfigu» '%s' cªnÙ bİ’!\n", 
â
);

20 
	`ex™
(0);

23 
m­
<
¡ršg
, cÚ¡ *> 
·¿s
;

25 
¡ršg
 
f¡_¡r
 = "", 
£c_¡r
 = "";

26 *
·œf
 = 
NULL
, *
·œs
 = NULL, 
»suÉ
[
STRLEN
];

27 *
±SŒ
 = 
NULL
;

29 !
	`ãof
(
å
))

31 
±SŒ
 = 
	`fg‘s
(
»suÉ
, 
STRLEN
, 
å
);

33 if(
±SŒ
 =ğ
NULL
)

36 if(!
	`¡rcmp
(
±SŒ
, ""))

39 if(
»suÉ
[0] == '#')

42 
VSŒšg
::
	`ŒimEnd
(
»suÉ
, '\n');

43 
VSŒšg
::
	`ŒimEnd
(
»suÉ
, '\r');

44 
VSŒšg
::
	`·r£Paœ
(
»suÉ
, 
f¡_¡r
, 
£c_¡r
, '=');

46 
·œf
 = 
Ãw
 [
f¡_¡r
.
	`Ëngth
()+1];

47 
	`¡rıy
(
·œf
, 
f¡_¡r
.
	`c_¡r
());

49 
·œs
 = 
Ãw
 [
£c_¡r
.
	`Ëngth
()+1];

50 
	`¡rıy
(
·œs
, 
£c_¡r
.
	`c_¡r
());

52 
·¿s
.
	`š£¹
(
·œ
<cÚ¡ *, cÚ¡ *>(
·œf
, 
·œs
));

54 
f¡_¡r
.
	`”a£
(f¡_¡r.
	`begš
(), f¡_¡r.
	`’d
());

55 
£c_¡r
.
	`”a£
(£c_¡r.
	`begš
(), sec_¡r.
	`’d
());

56 
	`¡rıy
(
»suÉ
, "");

58 
	`fşo£
(
å
);

60  
·¿s
;

61 
	}
}

63 
	gm­
<, m­<
	g¡ršg
, cÚ¡ *>* > 
	gSütP¬£r
::
	$g‘ItmM­s
(cÚ¡ *
â
)

65 
	`as£¹
(
â
);

67 
šdex
 = 0;

68 
FILE
 *
å
 = 
	`fİ’
(
â
, "r");

69 if(
å
 =ğ
NULL
)

71 
	`´štf
("CÚfigu» '%s' cªnÙ bİ’!\n", 
â
);

72 
	`ex™
(0);

75 
»suÉ
[
STRLEN
];

77 
m­
<, m­<
¡ršg
, cÚ¡ *>* > 
d©a
;

78 
m­
<
¡ršg
, cÚ¡ *> *
üÁ_·¿_m­
;

79 
¡ršg
 
f¡_¡r
 = "", 
£c_¡r
 = "";

80 *
·œf
 = 
NULL
, *
·œs
 = NULL;

81 *
±SŒ
 = 
NULL
;

83 !
	`ãof
(
å
))

85 
±SŒ
 = 
	`fg‘s
(
»suÉ
, 
STRLEN
, 
å
);

87 if(
±SŒ
 =ğ
NULL
)

90 if(!
	`¡rcmp
(
±SŒ
, ""))

93 
VSŒšg
::
	`ŒimEnd
(
»suÉ
, '\n');

94 
VSŒšg
::
	`ŒimEnd
(
»suÉ
, '\r');

96 if(!
	`¡rcmp
(
»suÉ
, "<item>"))

98 
üÁ_·¿_m­
 = 
Ãw
 
m­
<
¡ršg
, const *>;

99 
±SŒ
 = 
	`fg‘s
(
»suÉ
, 
STRLEN
, 
å
);

101 if(!
	`¡rcmp
(
»suÉ
, ""))

104 if(
»suÉ
[0] == '#')

107 
VSŒšg
::
	`ŒimEnd
(
»suÉ
, '\n');

108 
VSŒšg
::
	`ŒimEnd
(
»suÉ
, '\r');

109 
	`¡rcmp
(
»suÉ
, "</item>"))

111 
VSŒšg
::
	`·r£Paœ
(
»suÉ
, 
f¡_¡r
, 
£c_¡r
, '=');

112 
·œf
 = 
Ãw
 [
f¡_¡r
.
	`Ëngth
()+1];

113 
	`¡rıy
(
·œf
, 
f¡_¡r
.
	`c_¡r
());

115 
·œs
 = 
Ãw
 [
£c_¡r
.
	`Ëngth
()+1];

116 
	`¡rıy
(
·œs
, 
£c_¡r
.
	`c_¡r
());

117 
üÁ_·¿_m­
->
	`š£¹
(
·œ
<cÚ¡ *,cÚ¡ *>(
·œf
,
·œs
));

118 
f¡_¡r
.
	`”a£
(f¡_¡r.
	`begš
(),f¡_¡r.
	`’d
());

119 
£c_¡r
.
	`”a£
(£c_¡r.
	`begš
(),£c_¡r.
	`’d
());

121 
±SŒ
 = 
	`fg‘s
(
»suÉ
, 
STRLEN
, 
å
);

123 if(!
	`¡rcmp
(
±SŒ
, ""))

126 
VSŒšg
::
	`ŒimEnd
(
»suÉ
, '\n');

127 
VSŒšg
::
	`ŒimEnd
(
»suÉ
, '\r');

129 
d©a
.
	`š£¹
(
·œ
<,
m­
<
¡ršg
,cÚ¡ *>* >(
šdex
, 
üÁ_·¿_m­
));

130 
šdex
++;

132 
	`¡rıy
(
»suÉ
, "");

134 
	`fşo£
(
å
);

135  
d©a
;

136 
	}
}

138 
	gSütP¬£r
::
g‘SŒPaœs
(cÚ¡ *
¤câ
, 
veùÜ
<cÚ¡ *> &
¡¾¡1
,

139 
veùÜ
<cÚ¡ *> &
¡¾¡2
)

141 
as£¹
(
¤câ
);

142 
´štf
("Read string…airs ........... ");

143 
FILE
 *
	gå
 = 
fİ’
(
¤câ
, "r");

144 if(
	gå
 =ğ
NULL
)

146 
´štf
("F'%s' cªnÙ bİ’!\n", 
¤câ
);

150 
	g»suÉ
[
STRLEN
];

151 
	gfÜm”
[
STRLEN
];

152 
	gÏ‰”
[
STRLEN
];

154 *
	gfœ¡
 = 
NULL
, *
	g£cÚd
 = NULL;

155 
	gi
 = 0, 
	gËn1
 = 0, 
	gËn2
 = 0;

156 
	gÇrgs
 = 0;

158 !
ãof
(
å
))

160 
	gÇrgs
 = 
fsÿnf
(
å
, "%s\n", 
»suÉ
);

162 if(
	gÇrgs
 == 0)

165 if((!
¡rcmp
(
»suÉ
, "NULL"))||(!strcmp(result, "")))

171 
	gVSŒšg
::
¥l™_twš
(
fÜm”
, 
Ï‰”
, 
»suÉ
, '^');

172 
	gËn1
 = 
¡¾’
(
fÜm”
) + 1;

173 
	gËn2
 = 
¡¾’
(
Ï‰”
) + 1;

174 
	gfœ¡
 = 
Ãw
 [
Ën1
];

175 
	g£cÚd
 = 
Ãw
 [
Ën2
];

177 
¡rıy
(
fœ¡
, 
fÜm”
);

178 
¡rıy
(
£cÚd
, 
Ï‰”
);

180 
	g¡¾¡1
.
push_back
(
fœ¡
);

181 
	g¡¾¡2
.
push_back
(
£cÚd
);

182 
	gi
++;

184 
¡rıy
(
»suÉ
, "");

186 
´štf
("%d\n", 
i
);

187 
fşo£
(
å
);

191 
	gveùÜ
<cÚ¡ *> 
	gSütP¬£r
::
	$g‘Nam–¡
(cÚ¡ *
âame
)

193 
	`as£¹
(
âame
);

194 
veùÜ
<cÚ¡ *> 
kæ¡
;

196 
FILE
 *
å
 = 
	`fİ’
(
âame
, "r");

197 if(
å
 =ğ
NULL
)

199 
	`´štf
("F'%s' cªnÙ bİ’!\n",
âame
);

200  
kæ¡
;

203 
»suÉ
[
SütP¬£r
::
STRLEN
];

204 *
üÁKeyFrm
 = 
NULL
;

205 
i
 = 0, 
Ën
 = 0, 
Çrgs
 = 0;

207 !
	`ãof
(
å
))

209 
Çrgs
 = 
	`fsÿnf
(
å
, "%s\n", 
»suÉ
);

211 if(
Çrgs
 == 0)

214 
Ën
 = 
	`¡¾’
(
»suÉ
) + 1;

215 if((!
	`¡rcmp
(
»suÉ
, "NULL"))||(!strcmp(result, "")))

221 
üÁKeyFrm
 = 
Ãw
 [
Ën
];

222 
	`¡rıy
(
üÁKeyFrm
, 
»suÉ
);

223 
kæ¡
.
	`push_back
(
üÁKeyFrm
);

224 
i
++;

226 
	`¡rıy
(
»suÉ
, "");

228 
	`fşo£
(
å
);

229  
kæ¡
;

230 
	}
}

233 
boŞ
 
	gSütP¬£r
::
v”ifyP¬aM­
(cÚ¡ *
İtiÚs
[], cÚ¡ 
n
,

234 
m­
<
¡ršg
, cÚ¡ *> &
·¿s
)

236 
	gi
;

237 
	gi
 = 0; i < 
	gn
; i++)

239 if(
	g·¿s
.
fšd
(
İtiÚs
[
i
]è=ğ
·¿s
.
’d
())

241 
cout
<<"O±iÚ '"<<
İtiÚs
[
i
]<<"' has‚ot been set!\n";

244  
	gŒue
;

247 
	gSütP¬£r
::
ş—rP¬aM­
(
m­
<
¡ršg
, cÚ¡ *> &
·¿s
)

249 
¡ršg
 
	gkey
;

250 cÚ¡ *
	gv®
;

251 
	gm­
<
	g¡ršg
, cÚ¡ *>::
™”©Ü
 
m™
;

253 
	gm™
 = 
·¿s
.
begš
(); m™ !ğ·¿s.
’d
(); mit++)

255 
	gkey
 = 
m™
->
fœ¡
;

256 
	gkey
.
ş—r
();

257 
	gv®
 = 
m™
->
£cÚd
;

258 
	gd–‘e
 [] 
	gv®
;

260 
	g·¿s
.
ş—r
();

263 
	gSütP¬£r
::
ş—rItmM­s
(
m­
<, m­<
¡ršg
, cÚ¡ *>* > &
™mM­s
)

265 
	gidx
 = 0;

266 
	gm­
<
	g¡ršg
, cÚ¡ *>* 
	güÁM­
;

267 
	gidx
 = 0; idx < 
	g™mM­s
.
size
(); idx++)

269 
	güÁM­
 = 
™mM­s
[
idx
];

270 
	gSütP¬£r
::
ş—rP¬aM­
(*
üÁM­
);

271 
d–‘e
 
	güÁM­
;

273 
	g™mM­s
.
ş—r
();

276 
	gSütP¬£r
::
	$‹¡
()

278 
veùÜ
<cÚ¡ *> 
kæ¡1
;

279 
veùÜ
<cÚ¡ *> 
kæ¡2
;

281 cÚ¡ *
â
 = "e:/wanlei/vcdlab/itmtabs.txt";

283 
m­
<, m­<
¡ršg
, cÚ¡ *>* > 
™mM­s
;

284 
™mM­s
 = 
SütP¬£r
::
	`g‘ItmM­s
(
â
);

286 
m­
<, m­<
¡ršg
, cÚ¡ *>* >::
™”©Ü
 
™
;

287 
m­
<
¡ršg
, cÚ¡ *>::
™”©Ü
 
™”
;

288 
m­
<
¡ršg
, cÚ¡ *> *
üÁM­
;

289 
¡ršg
 
key¡r
;

290 
™
 = 
™mM­s
.
	`begš
(); iˆ!ğ™mM­s.
	`’d
(); it++)

292 
cout
<<
™
->
fœ¡
<<
’dl
;

293 
üÁM­
 = 
™
->
£cÚd
;

294 
™”
 = 
üÁM­
->
	`begš
(); i‹¸!ğüÁM­->
	`’d
(); iter++)

296 
cout
<<
™”
->
fœ¡
<<"\t"<<™”->
£cÚd
<<
’dl
;

297 
key¡r
 = 
™”
->
fœ¡
;

298 
d–‘e
 [] 
™”
->
£cÚd
;

299 
key¡r
.
	`ş—r
();

301 
cout
<<
’dl
;

302 
üÁM­
->
	`ş—r
();

303 
d–‘e
 
üÁM­
;

305 
™mM­s
.
	`ş—r
();

306 
	}
}

	@/home/pclin/cpp/gkmeans/scriptparser.h

1 #iâdeà
SCRIPTPARSER_H


2 
	#SCRIPTPARSER_H


	)

4 
	~<¡ršg
>

5 
	~<veùÜ
>

6 
	~<li¡
>

7 
	~<m­
>

9 
usšg
 
Çme¥aû
 
	g¡d
;

22 şas 
	cSütP¬£r


25 
	mpublic
:

26 cÚ¡ 
STRLEN
 = 512;

27 
	$SütP¬£r
(){}

29 
m­
<
¡ršg
, cÚ¡ *> 
	`g‘CÚf
(cÚ¡ *
â
);

30 
veùÜ
<cÚ¡ *> 
	`g‘Nam–¡
(cÚ¡ *
âame
);

31 
m­
<, m­<
¡ršg
,cÚ¡ *>* > 
	`g‘ItmM­s
(cÚ¡ *
â
);

33 
	`g‘SŒPaœs
(cÚ¡ * 
¤câ
, 
veùÜ
<cÚ¡ *> &
¡¾¡1
,

34 
veùÜ
<cÚ¡ *> &
¡¾¡2
);

36 
	`ş—rP¬aM­
(
m­
<
¡ršg
, cÚ¡ *> &
·¿s
);

37 
	`ş—rItmM­s
(
m­
<, m­<
¡ršg
, cÚ¡ *>* > &
™mM­s
);

38 
boŞ
 
	`v”ifyP¬aM­
(cÚ¡ *
İtiÚs
[], cÚ¡ 
num
,

39 
m­
<
¡ršg
, cÚ¡ *> &
·¿s
);

41 
vœtu®
 ~
	$SütP¬£r
(){
	}
}

42 
‹¡
();

	@/home/pclin/cpp/gkmeans/sparsematrix.h

1 #iâdeà
SPARSEMATRIX_H


2 
	#SPARSEMATRIX_H


	)

4 
	sS·r£M©rix


6 *
	md©a
;

7 *
	mcŞ
;

8 *
	mšdex
;

	@/home/pclin/cpp/gkmeans/timer.cpp

1 
	~"tim”.h
"

3 
	~<io¡»am
>

4 
	~<f¡»am
>

5 
	~<c¡dlib
>

6 
	~<ùime
>

8 
usšg
 
Çme¥aû
 
	g¡d
;

10 
	gTim”
::
	$Tim”
()

12 
this
->
¡¬‹d
 = 
çl£
;

13 
	}
}

15 
	gTim”
::
	$¡¬t
()

17 
this
->
¡¬‹d
 = 
Œue
;

18 
	`time
(&
this
->
¡¬t_t
);

19 
	`loÿÉime
(&
this
->
¡¬t_t
);

20 
	}
}

22 
tm
* 
	gTim”
::
	$’d
()

24 
tm
 *
tm_s
, *
tm_e
, *
tm_–­s
=Ñm *)
	`m®loc
((tm));

25 
mš
 = 0, 
£c
 = 0, 
hour
 = 0, 
yday
 = 0;

26 
tm_–­s
->
tm_hour
 = 0;

27 
tm_–­s
->
tm_isd¡
 = 0;

28 
tm_–­s
->
tm_mday
 = 0;

29 
tm_–­s
->
tm_mš
 = 0;

30 
tm_–­s
->
tm_mÚ
 = 0;

31 
tm_–­s
->
tm_£c
 = 0;

32 
tm_–­s
->
tm_wday
 = 0;

33 
tm_–­s
->
tm_yday
 = 0;

34 
tm_–­s
->
tm_y—r
 = 0;

36 if(
this
->
¡¬‹d
)

38 
	`time
(&
this
->
’d_t
);

39 
tm_s
 = 
	`loÿÉime
(&
this
->
¡¬t_t
);

40 
yday
 = 
tm_s
->
tm_yday
;

41 
hour
 = 
tm_s
->
tm_hour
;

42 
mš
 = 
tm_s
->
tm_mš
;

43 
£c
 = 
tm_s
->
tm_£c
;

44 
tm_e
 = 
	`loÿÉime
(&
this
->
’d_t
);

45 
tm_–­s
->
tm_yday
 = 
tm_e
->tm_yday - 
yday
;

46 
tm_–­s
->
tm_hour
 = 
tm_e
->tm_hou¸- 
hour
;

47 
tm_–­s
->
tm_mš
 = 
tm_e
->tm_mš - 
mš
;

48 
tm_–­s
->
tm_£c
 = 
tm_e
->tm_£ø- 
£c
;

50 if(
tm_–­s
->
tm_£c
 < 0)

52 
tm_–­s
->
tm_mš
 =m_elaps->tm_min - 1;

53 
tm_–­s
->
tm_£c
 =m_elaps->tm_sec+60;

56 if(
tm_–­s
->
tm_mš
 < 0)

58 
tm_–­s
->
tm_hour
 =m_elaps->tm_hour-1;

59 
tm_–­s
->
tm_mš
 =m_elaps->tm_min+60;

62 if(
tm_–­s
->
tm_hour
 < 0)

64 
tm_–­s
->
tm_yday
 =m_elaps->tm_yday - 1;

65 
tm_–­s
->
tm_hour
 =m_elaps->tm_hour + 24;

68  
tm_–­s
;

69 
	}
}

71 
	gTim”
::
	$’d
(
boŞ
 
TXT_OUT
)

73 
tm
 *
tm_s
,*
tm_e
,*
tm_–­s
 = (tm *)
	`m®loc
((tm));

74 
mš
 = 0, 
£c
 = 0, 
hour
 = 0, 
yday
 = 0;

75 
tm_–­s
->
tm_hour
 = 0;

76 
tm_–­s
->
tm_isd¡
 = 0;

77 
tm_–­s
->
tm_mday
 = 0;

78 
tm_–­s
->
tm_mš
 = 0;

79 
tm_–­s
->
tm_mÚ
 = 0;

80 
tm_–­s
->
tm_£c
 = 0;

81 
tm_–­s
->
tm_wday
 = 0;

82 
tm_–­s
->
tm_yday
 = 0;

83 
tm_–­s
->
tm_y—r
 = 0;

85 if(
this
->
¡¬‹d
)

87 
	`time
(&
this
->
’d_t
);

88 
tm_s
 = 
	`loÿÉime
(&
this
->
¡¬t_t
);

89 
yday
 = 
tm_s
->
tm_yday
;

90 
hour
 = 
tm_s
->
tm_hour
;

91 
mš
 = 
tm_s
->
tm_mš
;

92 
£c
 = 
tm_s
->
tm_£c
;

93 
tm_e
 = 
	`loÿÉime
(&
this
->
’d_t
);

94 
tm_–­s
->
tm_yday
 = 
tm_e
->tm_yday-
yday
;

95 
tm_–­s
->
tm_hour
 = 
tm_e
->tm_hour-
hour
;

96 
tm_–­s
->
tm_mš
 = 
tm_e
->tm_mš-
mš
;

97 
tm_–­s
->
tm_£c
 = 
tm_e
->tm_£c-
£c
;

99 if(
tm_–­s
->
tm_£c
 < 0)

101 
tm_–­s
->
tm_mš
 =m_elaps->tm_min-1;

102 
tm_–­s
->
tm_£c
 =m_elaps->tm_sec+60;

105 if(
tm_–­s
->
tm_mš
 < 0)

107 
tm_–­s
->
tm_hour
 =m_elaps->tm_hour-1;

108 
tm_–­s
->
tm_mš
 =m_elaps->tm_min+60;

111 if(
tm_–­s
->
tm_hour
 < 0)

113 
tm_–­s
->
tm_yday
 =m_elaps->tm_yday - 1;

114 
tm_–­s
->
tm_hour
 =m_elaps->tm_hour + 24;

117 if(
TXT_OUT
)

119 
cout
<<
’dl
<<"Time costs:";

120 if(
tm_–­s
->
tm_yday
 != 0.0f)

122 
cout
<<" "<<
tm_–­s
->
tm_yday
<<" day(s)";

125 if(
tm_–­s
->
tm_hour
 != 0.0f)

127 
cout
<<" "<<
tm_–­s
->
tm_hour
<<" hour(s)";

129 if(
tm_–­s
->
tm_mš
 != 0.0f)

131 
cout
<<" "<< 
tm_–­s
->
tm_mš
<<" minute(s)";

133 if(
tm_–­s
->
tm_£c
 != 0.0f)

135 
cout
<<" "<<
tm_–­s
->
tm_£c
<<" second(s)";

137 
cout
<<
’dl
;

139 
	`ä“
(
tm_–­s
);

141 
	}
}

143 
	gTim”
::
	$’d
(cÚ¡ *
msg
, cÚ¡ *
d¡Fn
)

145 
of¡»am
 
outSŒm
;

146 
outSŒm
.
	`İ’
(
d¡Fn
, 
ios
::
­p
);

147 
tm
 *
tm_s
,*
tm_e
,*
tm_–­s
 = (tm *)
	`m®loc
((tm));

148 
mš
 = 0, 
£c
 = 0, 
hour
 = 0, 
yday
 = 0;

149 
tm_–­s
->
tm_hour
 = 0;

150 
tm_–­s
->
tm_isd¡
 = 0;

151 
tm_–­s
->
tm_mday
 = 0;

152 
tm_–­s
->
tm_mš
 = 0;

153 
tm_–­s
->
tm_mÚ
 = 0;

154 
tm_–­s
->
tm_£c
 = 0;

155 
tm_–­s
->
tm_wday
 = 0;

156 
tm_–­s
->
tm_yday
 = 0;

157 
tm_–­s
->
tm_y—r
 = 0;

159 if(
this
->
¡¬‹d
)

161 
	`time
(&
this
->
’d_t
);

162 
tm_s
 = 
	`loÿÉime
(&
this
->
¡¬t_t
);

163 
yday
 = 
tm_s
->
tm_yday
;

164 
hour
 = 
tm_s
->
tm_hour
;

165 
mš
 = 
tm_s
->
tm_mš
;

166 
£c
 = 
tm_s
->
tm_£c
;

167 
tm_e
 = 
	`loÿÉime
(&
this
->
’d_t
);

168 
tm_–­s
->
tm_yday
 = 
tm_e
->tm_yday-
yday
;

169 
tm_–­s
->
tm_hour
 = 
tm_e
->tm_hour-
hour
;

170 
tm_–­s
->
tm_mš
 = 
tm_e
->tm_mš-
mš
;

171 
tm_–­s
->
tm_£c
 = 
tm_e
->tm_£c-
£c
;

173 if(
tm_–­s
->
tm_£c
 < 0)

175 
tm_–­s
->
tm_mš
 =m_elaps->tm_min-1;

176 
tm_–­s
->
tm_£c
 =m_elaps->tm_sec+60;

179 if(
tm_–­s
->
tm_mš
 < 0)

181 
tm_–­s
->
tm_hour
 =m_elaps->tm_hour-1;

182 
tm_–­s
->
tm_mš
 =m_elaps->tm_min+60;

185 if(
tm_–­s
->
tm_hour
 < 0)

187 
tm_–­s
->
tm_yday
 =m_elaps->tm_yday - 1;

188 
tm_–­s
->
tm_hour
 =m_elaps->tm_hour + 24;

191 
outSŒm
<<
msg
;

192 if(
tm_–­s
->
tm_yday
 != 0.0f)

194 
outSŒm
<<" "<<
tm_–­s
->
tm_yday
<<" day(s)";

197 if(
tm_–­s
->
tm_hour
 != 0.0f)

199 
outSŒm
<<" "<<
tm_–­s
->
tm_hour
<<" hour(s)";

201 if(
tm_–­s
->
tm_mš
 != 0.0f)

203 
outSŒm
<<" "<< 
tm_–­s
->
tm_mš
<<" minute(s)";

205 if(
tm_–­s
->
tm_£c
 != 0.0f)

207 
outSŒm
<<" "<<
tm_–­s
->
tm_£c
<<" second(s)";

209 
outSŒm
<<
’dl
;

210 
	`ä“
(
tm_–­s
);

211 
outSŒm
.
	`şo£
();

213 
	}
}

215 
	gTim”
::
	$‹¡
()

217 
Tim”
 *
my
 = 
Ãw
 
	`Tim”
();

218 
my
->
	`¡¬t
();

219 
i
 = 0; i < 100; i++)

220 
j
 = 0; j < 3000; j++)

222 
cout
<<"H–low"<<
’dl
;

224 
my
->
	`’d
("hi", "/home/wlzhao/hi.txt");

226 
	}
}

228 
	gTim”
::~
	$Tim”
()

231 
	}
}

	@/home/pclin/cpp/gkmeans/timer.h

1 #iâdeà
TIMER_H


2 
	#TIMER_H


	)

4 
	~<ùime
>

6 şas 
	cTim”


8 
	mpublic
:

9 
Tim”
();

10 
¡¬t
();

11 
tm
 *
’d
();

12 
’d
(
boŞ
 
TXT_OUT
);

13 
’d
(cÚ¡ *
msg
, cÚ¡ *
d¡Fn
);

15 
‹¡
();

16 
	mvœtu®
 ~
Tim”
();

17 
	m´iv©e
:

18 
boŞ
 
¡¬‹d
;

19 
time_t
 
	m¡¬t_t
, 
	m’d_t
;

	@/home/pclin/cpp/gkmeans/vstring.cpp

1 
	~<sys/ty³s.h
>

2 
	~<dœ’t.h
>

3 
	~<io¡»am
>

4 
	~<c¡dlib
>

5 
	~<ÿs£¹
>

6 
	~<f¡»am
>

7 
	~<c¡ršg
>

8 
	~<veùÜ
>

9 
	~<c¡dio
>

10 
	~<cm©h
>

11 
	~<li¡
>

13 
	~"v¡ršg.h
"

15 
usšg
 
Çme¥aû
 
	g¡d
;

17 
	gVSŒšg
::
	$VSŒšg
()

18 {
	}
}

20 
boŞ
 
VSŒšg
::
	$’dW™h
(cÚ¡ 
¡r
[], cÚ¡ 
’d
[])

22 
ËÃnd
 = 
	`¡¾’
(
’d
);

23 
Ën¡r
 = 
	`¡¾’
(
¡r
);

24 if(
ËÃnd
 > 
Ën¡r
)

25  
çl£
;

27 
¡¬t
 = 
Ën¡r
 - 
ËÃnd
, 
i
, 
j
 = 0;

28 
i
 = 
¡¬t
; i < 
Ën¡r
; i++,
j
++)

30 if(
¡r
[
i
]!ğ
’d
[
j
])

31  
çl£
;

33  
Œue
;

34 
	}
}

36 
boŞ
 
	gVSŒšg
::
	$¡¬tW™h
(cÚ¡ 
¡r
[], cÚ¡ 
’d
[])

38 
ËÃnd
 = 
	`¡¾’
(
’d
);

39 
Ën¡r
 = 
	`¡¾’
(
¡r
), 
i
;

40 if(
ËÃnd
 > 
Ën¡r
)

42  
çl£
;

45 if(
ËÃnd
 == 0)

47  
Œue
;

50 
i
 = 0; i<
ËÃnd
; i++)

52 if(
¡r
[
i
] !ğ
’d
[i])

53  
çl£
;

55  
Œue
;

56 
	}
}

58 
boŞ
 
	gVSŒšg
::
	$exi¡Dœ
(cÚ¡ *
dœ
)

60 
DIR
* 
mydœ
 = 
	`İ’dœ
(
dœ
);

61 if(
mydœ
 =ğ
NULL
)

63  
çl£
;

67 
	`şo£dœ
(
mydœ
);

68  
Œue
;

70 
	}
}

73 
boŞ
 
	gVSŒšg
::
	$v®id©eP©h
(cÚ¡ *
·th
)

75 
Ën
 = 
	`¡¾’
(
·th
);

77 if(
Ën
 == 0)

78  
çl£
;

80 *
tmpdœ
 = 
Ãw
 [
Ën
+1];

81 
boŞ
 
r¦t
 = 
VSŒšg
::
	`·r£DIR
(
tmpdœ
, 
·th
);

82 if(!
r¦t
)

84 
d–‘e
 [] 
tmpdœ
;

85  
çl£
;

88 
r¦t
 = 
VSŒšg
::
	`exi¡Dœ
(
tmpdœ
);

90 if(!
r¦t
)

92 
d–‘e
 [] 
tmpdœ
;

93  
çl£
;

96 *
tmpâ
 = 
Ãw
 [
Ën
+1];

97 
r¦t
 = 
VSŒšg
::
	`·r£FName
(
tmpâ
, 
·th
);

98 if(!
r¦t
)

100  
çl£
;

102 if(
tmpâ
[0] >= 'a' &&mpfn[0] <= 'z')

104 
d–‘e
 [] 
tmpâ
;

105  
Œue
;

106 }if(
tmpâ
[0] >= 'A' &&mpfn[0] <= 'Z')

108 
d–‘e
 [] 
tmpâ
;

109  
Œue
;

110 }if(
tmpâ
[0] >= '0' &&mpfn[0] <= '9')

112 
d–‘e
 [] 
tmpâ
;

113  
Œue
;

115 
d–‘e
 [] 
tmpâ
;

116  
çl£
;

120  
çl£
;

121 
	}
}

123 
boŞ
 
	gVSŒšg
::
	$exi¡Fe
(cÚ¡ *
â
)

125 
FILE
* 
myå
 = 
	`fİ’
(
â
, "r");

126 if(
myå
 =ğ
NULL
)

128  
çl£
;

132 
	`fşo£
(
myå
);

133  
Œue
;

135 
	}
}

137 
	gVSŒšg
::
	$toUµ”
(
¡r
[])

139 
Ën
 = 
	`¡¾’
(
¡r
), 
i
;

140 
i
 = 0; i <
Ën
; i++)

142 
¡r
[
i
] = 
	`touµ”
(str[i]);

144 
	}
}

146 
	gVSŒšg
::
	$toLow”
(
¡r
[])

148 
Ën
 = 
	`¡¾’
(
¡r
), 
i
;

149 
i
 = 0; i < 
Ën
; i++)

151 
¡r
[
i
] = 
	`tŞow”
(str[i]);

154 
	}
}

156 
boŞ
 
	gVSŒšg
::
	$·r£DIR
(
dœÇme
[], cÚ¡ 
·th
[])

158 
	`as£¹
(
dœÇme
);

159 
	`as£¹
(
·th
);

160 
	`¡rıy
(
dœÇme
, "");

162 if(
	`¡¾’
(
·th
) == 0)

164  
çl£
;

166 
sidx
 = 0;

168 if(
VSŒšg
::
	`¡¬tW™h
(
·th
, "./"))

170 
	`¡rıy
(
dœÇme
, "./");

171  
Œue
;

174 if(
VSŒšg
::
	`¡¬tW™h
(
·th
, ".\\"))

176 
	`¡rıy
(
dœÇme
, ".\\");

177  
Œue
;

180 
eidx
 = 
VSŒšg
::
	`Ï¡šdexof
(
·th
, '/');

181 
_eidx
 = 
VSŒšg
::
	`Ï¡šdexof
(
·th
, '\\');

183 if(
eidx
 =ğ-1 && 
_eidx
 == -1)

185 
	`¡rıy
(
dœÇme
, "./");

186  
Œue
;

189 
eidx
 =ƒidx>
_eidx
?eidx:_eidx;

191 if(
eidx
 == 0)

193 
	`¥rštf
(
dœÇme
, "/");

196 if(
sidx
 < 
eidx
)

198 
VSŒšg
::
	`subbtw
(
dœÇme
, 
·th
, 
sidx
, 
eidx
);

199 
VSŒšg
::
	`»¶a£
(
dœÇme
, '\\', '/');

200  
Œue
;

204  
çl£
;

206 
	}
}

208 
boŞ
 
	gVSŒšg
::
	$·r£FName
(
âame
[], cÚ¡ 
·th
[])

210 
	`as£¹
(
âame
);

211 
	`as£¹
(
·th
);

212 
	`¡rıy
(
âame
, "");

214 if(
	`¡¾’
(
·th
) == 0)

216  
çl£
;

219 
sidx
 = 
VSŒšg
::
	`Ï¡šdexof
(
·th
, '\\');

220 
_sidx
 = 
VSŒšg
::
	`Ï¡šdexof
(
·th
, '/');

221 
eidx
 = 
VSŒšg
::
	`Ï¡šdexof
(
·th
, '.');

223 if(
eidx
 == -1)

225 
eidx
 = 
	`¡¾’
(
·th
) - 1;

229 if(
·th
[0] =ğ'.' && 
eidx
 == 0)

231 
eidx
 = 
	`¡¾’
(
·th
) - 1;

234 
eidx
 =ƒidx - 1;

238 
sidx
 = sidx>
_sidx
?sidx:_sidx;

240 if(
sidx
 < 
eidx
)

242 
sidx
 = sidx + 1;

243 
VSŒšg
::
	`subbtw
(
âame
, 
·th
, 
sidx
, 
eidx
);

244  
Œue
;

248  
çl£
;

250 
	}
}

252 
boŞ
 
	gVSŒšg
::
	$v®idFName
(cÚ¡ 
âame
[])

254 
Ën
 = 
	`¡¾’
(
âame
);

255 if(
Ën
 <= 0)

257  
çl£
;

259 if((
âame
[0] >= 'a' && fname[0] <= 'z')

260 ||(
âame
[0] >= 'A' && fname[0] <= 'Z'))

262  
Œue
;

264  
çl£
;

266 
	}
}

268 
boŞ
 
	gVSŒšg
::
	$·r£P©h
(
âame
[], cÚ¡ 
·th
[])

270 
	`as£¹
(
âame
);

271 
	`as£¹
(
·th
);

272 
	`¡rıy
(
âame
, "");

274 if(
	`¡¾’
(
·th
) == 0)

276  
çl£
;

279 if(!
	`¡rcmp
(
·th
, "./") ||!strcmp(path, ".\\"))

281  
çl£
;

284 *
Çme
 = 
Ãw
 [
	`¡¾’
(
·th
)+1];

285 
	`¡rıy
(
Çme
, "");

287 
eidx
 = 
VSŒšg
::
	`Ï¡šdexof
(
·th
, '.');

289 
VSŒšg
::
	`·r£FName
(
Çme
, 
·th
);

291 if(
VSŒšg
::
	`v®idFName
(
Çme
))

293 if(
eidx
 <= 0)

295 
	`¡rıy
(
âame
, 
·th
);

296 
VSŒšg
::
	`»¶a£
(
âame
, '\\', '/');

298 
	`¡ºıy
(
âame
, 
·th
, 
eidx
);

299 
VSŒšg
::
	`»¶a£
(
âame
, '\\', '/');

300 
âame
[
eidx
] = '\0';

302 
d–‘e
 [] 
Çme
;

303  
Œue
;

305 
d–‘e
 [] 
Çme
;

306  
çl£
;

308 
	}
}

310 
	gVSŒšg
::
	$»¶a£
(
¤c¡r
[], cÚ¡ 
ch
, cÚ¡ 
nwch
)

312 
Ën
 = 0, 
i
;

313 if((
Ën
 = 
	`¡¾’
(
¤c¡r
)) == 0)

317 
i
 = 0; i < 
Ën
; i++)

319 if(
¤c¡r
[
i
] =ğ
ch
)

321 
¤c¡r
[
i
] = 
nwch
;

325 
	}
}

327 
	gVSŒšg
::
	$subbtw
(
de¡
[], cÚ¡ 
¤c
[],

328 cÚ¡ 
¡¬t
, cÚ¡ 
’d
)

330 
i
 = 0, 
r_’d
 = 0, 
k
 = 0;

331 
æ’
 = 0;

332 
æ’
 = 
	`¡¾’
(
¤c
);

333 
	`as£¹
(
de¡
);

335 if(
¡¬t
 =ğ
æ’
)

339 
r_’d
 = 
’d
 >ğ
æ’
?(flen-1):end;

340 
i
 = 
¡¬t
; i <ğ
r_’d
; i++)

342 
de¡
[
k
] = 
¤c
[
i
];

343 
k
++;

346 
de¡
[
k
] = '\0';

348 
	}
}

350 
	gVSŒšg
::
	$fœ¡šdexof
(cÚ¡ *
¤c
, cÚ¡ 
ch
)

352 
i
 = 0, 
Ën
 = 
	`¡¾’
(
¤c
);

353 
i
 = 0; i < 
Ën
; i++)

355 if(
¤c
[
i
] =ğ
ch
)

356  
i
;

359 
	}
}

361 
	gVSŒšg
::
	$Ï¡šdexof
(cÚ¡ *
¤c
, 
ch
)

363 
i
, 
’d
 = 
	`¡¾’
(
¤c
) - 1;

364 
i
 = 
’d
; i >= 0; i--)

366 if(
¤c
[
i
] =ğ
ch
)

367  
i
;

370 
	}
}

372 
	gVSŒšg
::
	$¥l™_twš
(*
fœ¡
, *
£cÚd
, cÚ¡ *
¤c
, cÚ¡ 
ch
)

374 
i
, 
j
, 
Ën
 = 
	`¡¾’
(
¤c
)-1;

376 
	`as£¹
(
fœ¡
);

377 
	`as£¹
(
£cÚd
);

379 
i
 = 0; i < 
Ën
; i++)

381 if(
¤c
[
i
] !ğ
ch
)

383 
fœ¡
[
i
] = 
¤c
[i];

390 
fœ¡
[
i
] = '\0';

391 
i
 = i+1;

393 
j
 = 
i
; j <ğ
Ën
; j++)

395 
£cÚd
[
j
-
i
] = 
¤c
[j];

397 
£cÚd
[
j
-
i
] = '\0';

399 
	}
}

401 
	gVSŒšg
::
	$·r£Paœ
(cÚ¡ 
¤c_¡r
[], 
¡ršg
 &
f¡_¡r
,

402 
¡ršg
 &
£cd_¡r
, cÚ¡ 
¥l™‹r
)

404 
Ën
, 
i
, 
j
;

405 
Ën
 = 
	`¡¾’
(
¤c_¡r
);

407 
i
 = 0; i < 
Ën
; i++)

409 if(
¤c_¡r
[
i
] =ğ
¥l™‹r
)

414 
j
=0; j < 
i
; j++)

416 
f¡_¡r
 +ğ
¤c_¡r
[
j
];

419 
j
 = 
i
+1; j < 
Ën
; j++)

421 
£cd_¡r
 +ğ
¤c_¡r
[
j
];

424 
	}
}

427 
	gVSŒšg
::
·r£_wÜds
(cÚ¡ *
¡r
, 
veùÜ
<> &
nums
)

429 
	gch
[2] = {' ', '\t'};

430 
	gi
, 
	gËn
 = 
¡¾’
(
¡r
), 
	gcouÁ
 = 0, 
	gidx
 = 0;

431 *
	gwÜd
 = 
Ãw
 [
Ën
+1];

432 
¡rıy
(
wÜd
, "");

433 
boŞ
 
	gFOUL
 = 
çl£
;

434 
	gi
 = 0; i < 
	gËn
; i++)

436 if(
	g¡r
[
i
] =ğ
ch
[0] || 
¡r
[i] == ch[1])

438 if(
idx
 != 0)

440 if(!
FOUL
)

442 
wÜd
[
idx
] = '\0';

443 
	gidx
 = 0;

444 
	gnums
.
push_back
(
©oi
(
wÜd
));

448 
	gFOUL
 = 
çl£
;

449 
	gidx
 = 0;

452 if(
	gi
 > 0)

454 if(
	g¡r
[
i
-1] !ğ
ch
[0] && 
¡r
[i-1] != ch[1])

456 
couÁ
++;

462 if(
	g¡r
[
i
] < '0' || str[i] > '9')

464 
	gFOUL
 = 
Œue
;

466 
	gwÜd
[
idx
] = 
¡r
[
i
];

467 
	gidx
++;

470 if(
	gidx
 != 0)

472 
wÜd
[
idx
] = '\0';

473 
	gidx
 = 0;

474 if(!
	gFOUL
)

476 
	gnums
.
push_back
(
©oi
(
wÜd
));

480 
	gd–‘e
 [] 
	gwÜd
;

481  
	gnums
.
size
();

484 
	gVSŒšg
::
¥l™by
(cÚ¡ *
lše
, cÚ¡ 
¥l™‹r
, 
veùÜ
<
¡ršg
> &
wÜds
)

486 
as£¹
(
lše
 !ğ
NULL
);

488 
	gi
 = 0, 
	gËn
 = 
¡¾’
(
lše
);

489 
	gch
 = ' ';

490 
¡ršg
 
	gwÜd
 = "";

492 
	gi
 = 0; i < 
	gËn
; i++)

494 
	gch
 = 
lše
[
i
];

495 if(
	gch
 !ğ
¥l™‹r
)

497 
wÜd
 = wÜd + 
ch
;

501 
	gwÜds
.
push_back
(
wÜd
);

502 
	gwÜd
 = "";

505 
	gwÜds
.
push_back
(
wÜd
);

509 
	gVSŒšg
::
·r£Lše
(cÚ¡ *
lše
, cÚ¡ 
¥l™”
, 
£t
<> &
»gTab
)

511 
as£¹
(
lše
 !ğ
NULL
);

513 
	gËn
 = 
¡¾’
(
lše
), 
	gi
, 
	gsize
 = 0, 
	gv®
;

514 
	gwÜd
[30], 
	gch
 = ' ';

515 
boŞ
 
	gPARSED
 = 
Œue
;

516 
¡rıy
(
wÜd
, "");

518 
	gi
 = 0; i < 
	gËn
; i++)

520 
	gch
 = 
lše
[
i
];

522 if((
	gch
 >='0' && 
ch
 <= '9'))

524 
PARSED
 = 
çl£
;

525 
	gwÜd
[
size
] = 
ch
;

526 
	gsize
++;

528 if(
	gch
 =ğ'+'||
ch
=='-')

530 
wÜd
[
size
] = 
ch
;

531 
	gsize
++;

533 if(
	gch
 == '.')

535 if(!
PARSED
)

537 
wÜd
[
size
] = 
ch
;

538 
	gsize
++;

543 if(!
	gPARSED
)

545 
	gwÜd
[
size
] ='\0';

546 
	gv®
 = 
©oi
(
wÜd
);

547 
	g»gTab
.
š£¹
(
v®
);

549 
	gPARSED
 = 
Œue
;

550 
¡rıy
(
wÜd
,"");

551 
	gsize
 = 0;

555 
	gwÜd
[
size
]='\0';

556 if(!
	gPARSED
&& 
¡rcmp
(
wÜd
,""))

558 
	gv®
 = 
©oi
(
wÜd
);

559 
	g»gTab
.
š£¹
(
v®
);

563 
	gVSŒšg
::
·r£Lše
(cÚ¡ *
lše
, cÚ¡ 
¥l™”
, 
veùÜ
<> &
·r£dV®s
)

565 
as£¹
(
lše
 !ğ
NULL
);

566 
	gËn
 = 
¡¾’
(
lše
), 
	gi
, 
	gsize
 = 0;

567 
	gwÜd
[30], 
	gch
;

568 
boŞ
 
	gPARSED
 = 
Œue
;

569 
¡rıy
(
wÜd
, "");

571 
	gi
 = 0; i < 
	gËn
; i++)

573 
	gch
 = 
lše
[
i
];

575 if(
	gch
 >='0' && 
ch
 <= '9')

577 
PARSED
 = 
çl£
;

578 
	gwÜd
[
size
] = 
ch
;

579 
	gsize
++;

581 if(
	gch
 =ğ'+'||
ch
=='-')

583 
wÜd
[
size
] = 
ch
;

584 
	gsize
++;

586 if(
	gch
 == '.')

588 if(!
PARSED
)

590 
wÜd
[
size
] = 
ch
;

591 
	gsize
++;

596 if(!
	gPARSED
)

598 
	gwÜd
[
size
] = '\0';

599 
	g·r£dV®s
.
push_back
(
©of
(
wÜd
));

600 
	gPARSED
 = 
Œue
;

601 
¡rıy
(
wÜd
, "");

602 
	gsize
 = 0;

606 
	gwÜd
[
size
] = '\0';

607 if(!
	gPARSED
 && 
¡rcmp
(
wÜd
, ""))

609 
	g·r£dV®s
.
push_back
(
©of
(
wÜd
));

613 
	g£t
<> 
	gVSŒšg
::
	$·r£Lše
(cÚ¡ *
lše
, cÚ¡ 
¥l™”
)

615 
	`as£¹
(
lše
 !ğ
NULL
);

616 
£t
<> 
myli¡
;

618 
Ën
 = 
	`¡¾’
(
lše
), 
i
, 
size
 = 0;

619 
wÜd
[30], 
ch
;

620 
v®
 = 0;

621 
boŞ
 
PARSED
 = 
Œue
;

623 
i
 = 0; i < 
Ën
; i++)

625 
ch
 = 
lše
[
i
];

627 if(
ch
 >= '0' && ch <= '9')

629 
PARSED
 = 
çl£
;

630 
wÜd
[
size
]=
ch
;

631 
size
++;

633 if(
ch
 == '+'||ch == '-')

635 
wÜd
[
size
]=
ch
;

636 
size
++;

638 if(
ch
 == '.')

640 if(!
PARSED
)

642 
wÜd
[
size
]=
ch
;

643 
size
++;

648 if(!
PARSED
)

650 
wÜd
[
size
]='\0';

651 
v®
=
	`©oi
(
wÜd
);

652 
myli¡
.
	`š£¹
(
v®
);

654 
PARSED
 = 
Œue
;

655 
	`¡rıy
(
wÜd
,"");

656 
size
 = 0;

660 
wÜd
[
size
] = '\0';

661 if(!
PARSED
 && 
	`¡rcmp
(
wÜd
, ""))

663 
v®
 = 
	`©oi
(
wÜd
);

664 
myli¡
.
	`š£¹
(
v®
);

666  
myli¡
;

667 
	}
}

669 
	gVSŒšg
::
	$ŒimEnd
(*
lše
, cÚ¡ 
ch
)

671 
Ën
 = 
	`¡¾’
(
lše
), 
i
, 
j
;

673 if(
Ën
 <= 0)

678 
i
 = 
Ën
-1; i > 0; i--)

680 if(
lše
[
i
] !ğ
ch
)

685 
j
 = 
i
+1; j < 
Ën
; j++)

687 
lše
[
j
] = '\0';

690 
	}
}

692 
	gVSŒšg
::
	$ŒimH—d
(*
lše
, cÚ¡ 
ch
)

694 
i
 = 0, 
j
 = 0, 
Ën
 = 
	`¡¾’
(
lše
);

696 if(
Ën
 == 0)

699 
i
 = 0; i < 
Ën
; i++)

701 if(
lše
[
i
] !ğ
ch
)

706 
j
 = 0; 
lše
[
i
] != '\0'; j++,i++)

708 
lše
[
j
] =†še[
i
];

711 
	}
}

713 
	gVSŒšg
::
	$ŒimStİs
(*
lše
)

715 if(
lše
 =ğ
NULL
)

718 if(
	`¡¾’
(
lše
) == 0)

721 
VSŒšg
::
	`ŒimH—d
(
lše
, ' ');

722 
VSŒšg
::
	`ŒimEnd
(
lše
, ' ');

723 
VSŒšg
::
	`ŒimEnd
(
lše
, '\n');

724 
VSŒšg
::
	`ŒimEnd
(
lše
, '\r');

726 
	}
}

728 
	gVSŒšg
::
	$ŒimAá”
(*
lše
, cÚ¡ 
ch
)

730 
i
, 
Ën
 = 
	`¡¾’
(
lše
);

731 
i
 = 0; i < 
Ën
; i++)

733 if(
lše
[
i
] =ğ
ch
)

735 
lše
[
i
] ='\0';

740 
	}
}

742 
	gVSŒšg
::
	$time2SŒ
(*
tmSŒ
, cÚ¡ 
£cÚds
)

744 
»®tm
 = 
£cÚds
;

745 
tm_hour
 = 
»®tm
/3600;

746 
»®tm
 = 
£cÚds
%3600;

747 
tm_mš
 = 
»®tm
/60;

748 
tm_£c
 = 
»®tm
%60;

750 
hour
[3];

751 
mš
[3];

752 
£c
[3];

754 if(
tm_hour
>9)

756 
	`¥rštf
(
hour
,"%d",
tm_hour
);

758 if(
tm_hour
>0)

760 
	`¥rštf
(
hour
,"0%d",
tm_hour
);

764 
	`¥rštf
(
hour
,"0");

766 if(
tm_mš
>9)

768 
	`¥rštf
(
mš
,"%d",
tm_mš
);

770 if(
tm_mš
 >0)

772 
	`¥rštf
(
mš
,"0%d",
tm_mš
);

776 
	`¥rštf
(
mš
,"00");

779 if(
tm_£c
>9)

781 
	`¥rštf
(
£c
,"%d",
tm_£c
);

783 if(
tm_£c
 > 0)

785 
	`¥rštf
(
£c
,"0%d",
tm_£c
);

789 
	`¥rštf
(
£c
,"00");

792 
	`¥rštf
(
tmSŒ
,"%s:%s:%s",
hour
,
mš
,
£c
);

793 
	}
}

795 cÚ¡ *
	gVSŒšg
::
	$time2SŒ
(cÚ¡ 
£cÚds
)

797 
»®tm
 = 
£cÚds
;

798 
tm_hour
 = 
»®tm
/3600;

799 
»®tm
 = 
£cÚds
%3600;

800 
tm_mš
 = 
»®tm
/60;

801 
tm_£c
 = 
»®tm
%60;

802 *
tm¡r
 = 
Ãw
 [12];

803 
hour
[3];

804 
mš
[3];

805 
£c
[3];

808 if(
tm_hour
>9)

810 
	`¥rštf
(
hour
,"%d",
tm_hour
);

812 if(
tm_hour
>0)

814 
	`¥rštf
(
hour
,"0%d",
tm_hour
);

818 
	`¥rštf
(
hour
,"0");

820 if(
tm_mš
>9)

822 
	`¥rštf
(
mš
,"%d",
tm_mš
);

824 if(
tm_mš
 > 0)

826 
	`¥rštf
(
mš
,"0%d",
tm_mš
);

830 
	`¥rštf
(
mš
,"00");

833 if(
tm_£c
>9)

835 
	`¥rštf
(
£c
,"%d",
tm_£c
);

837 if(
tm_£c
 > 0)

839 
	`¥rštf
(
£c
,"0%d",
tm_£c
);

843 
	`¥rštf
(
£c
,"00");

846 
	`¥rštf
(
tm¡r
,"%s:%s:%s",
hour
,
mš
,
£c
);

847  
tm¡r
;

848 
	}
}

850 
	gVSŒšg
::
	$‹¡
()

852 
dœ
[] = "2435sdfsrwese";

854 if(
VSŒšg
::
	`¡¬tW™h
(
dœ
, "243"))

856 
cout
<<"It contains\n";

860 
boŞ
 
t
;

861 
de¡
[64] = "";

863 cÚ¡ *
hi
[10] = {"/", "sdf/aa", "/mnt/a", "\\var/s1r", "s/er\1aa",

865 
i
 = 0; i < 10; i++)

870 
t
 = 
VSŒšg
::
	`·r£P©h
(
de¡
, 
hi
[
i
]);

871 
cout
<<
hi
[
i
]<<"\t"<<
t
<<"\t"<<
de¡
<<
’dl
;

874 
	}
}

	@/home/pclin/cpp/gkmeans/vstring.h

1 #iâdeà
VSTRING_H


2 
	#VSTRING_H


	)

4 
	~<io¡»am
>

5 
	~<¡ršg
>

6 
	~<veùÜ
>

7 
	~<li¡
>

8 
	~<£t
>

10 
usšg
 
Çme¥aû
 
	g¡d
;

12 şas 
	cVSŒšg


14 
	m´iv©e
:

15 
subbtw
(
de¡
[], cÚ¡ 
¤c
[],

16 cÚ¡ 
¡¬t
, cÚ¡ 
’d
);

17 
»¶a£
(
¤c
[], cÚ¡ 
ch
, cÚ¡ 
nwch
);

19 
	mpublic
:

20 
VSŒšg
();

21 
¥l™by
(cÚ¡ *
lše
, cÚ¡ 
¥l™”
, 
veùÜ
<
¡ršg
> &
wÜds
);

22 
·r£Paœ
(cÚ¡ 
¤c_¡r
[], 
¡ršg
 &
f¡_¡r
,

23 
¡ršg
 &
£cd_¡r
, cÚ¡ 
¥l™‹r
);

25 
boŞ
 
¡¬tW™h
(cÚ¡ *
¡r
, cÚ¡ *
±Š
);

26 
boŞ
 
’dW™h
(cÚ¡ 
¡r
[], cÚ¡ 
’d
[]);

27 
ŒimEnd
(*
lše
, cÚ¡ 
ch
);

28 
ŒimH—d
(*
lše
, cÚ¡ 
ch
);

29 
ŒimAá”
(*
lše
, cÚ¡ 
ch
);

30 
ŒimStİs
(*
lše
);

32 
fœ¡šdexof
(cÚ¡ *
¤c
, cÚ¡ 
ch
);

33 
Ï¡šdexof
(cÚ¡ *
¤c
, cÚ¡ 
ch
);

34 
couÁ_wÜds
(cÚ¡ *
¡r
);

35 
·r£_wÜds
(cÚ¡ *
¡r
, 
veùÜ
<> &
nums
);

37 
¥l™_twš
(*
fœ¡
, *
£cÚd
, cÚ¡ *
¤c
, cÚ¡ 
ch
);

39 
·r£Lše
(cÚ¡ *
lše
, cÚ¡ 
¥l™”
, 
£t
<> &
»gTab
);

40 
	m£t
<> 
·r£Lše
(cÚ¡ *
lše
, cÚ¡ 
¥l™”
);

41 
·r£Lše
(cÚ¡ *
lše
, cÚ¡ 
¥l™”
, 
veùÜ
<> &
v®s
);

43 
boŞ
 
exi¡Fe
(cÚ¡ *
â
);

44 
boŞ
 
exi¡Dœ
(cÚ¡ *
dœ
);

45 
boŞ
 
v®id©eP©h
(cÚ¡ *
·th
);

47 
boŞ
 
·r£FName
(
âame
[], cÚ¡ 
·th
[]);

48 
boŞ
 
·r£DIR
(
dœÇme
[], cÚ¡ 
·th
[]);

49 
boŞ
 
·r£P©h
(
âame
[], cÚ¡ 
·th
[]);

50 
boŞ
 
v®idFName
(cÚ¡ 
âame
[]);

51 
toUµ”
(
¡r
[]);

52 
toLow”
(
¡r
[]);

54 cÚ¡ *
time2SŒ
(cÚ¡ 
£cÚds
);

55 
time2SŒ
(*
tmSŒ
, cÚ¡ 
£cÚds
);

57 
‹¡
();

58 
	mvœtu®
 ~
	$VSŒšg
(){}

60 
	}
};

	@/usr/include/dirent.h

22 #iâdef 
_DIRENT_H


23 
	#_DIRENT_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

31 #ifdeà
__USE_XOPEN


32 #iâdeà
__šo_t_defšed


33 #iâdeà
__USE_FILE_OFFSET64


34 
__šo_t
 
	tšo_t
;

36 
__šo64_t
 
	tšo_t
;

38 
	#__šo_t_defšed


	)

40 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


41 
__šo64_t
 
	tšo64_t
;

42 
	#__šo64_t_defšed


	)

61 
	~<b™s/dœ’t.h
>

63 #ià
defšed
 
__USE_MISC
 && !defšed 
d_f’o


64 
	#d_šo
 
d_f’o


	)

81 #ifdeà
_DIRENT_HAVE_D_NAMLEN


82 
	#_D_EXACT_NAMLEN
(
d
è((d)->
d_ÇmËn
)

	)

83 
	#_D_ALLOC_NAMLEN
(
d
è(
	`_D_EXACT_NAMLEN
 (dè+ 1)

	)

85 
	#_D_EXACT_NAMLEN
(
d
è(
	`¡¾’
 ((d)->
d_Çme
))

	)

86 #ifdeà
_DIRENT_HAVE_D_RECLEN


87 
	#_D_ALLOC_NAMLEN
(
d
è(((*è(dè+ (d)->
d_»ş’
è- &(d)->
d_Çme
[0])

	)

89 
	#_D_ALLOC_NAMLEN
(
d
è( (d)->
d_Çme
 > 1 ?  (d)->d_name : \

90 
	`_D_EXACT_NAMLEN
 (
d
è+ 1)

	)

95 #ifdeà
__USE_MISC


99 
	mDT_UNKNOWN
 = 0,

100 
	#DT_UNKNOWN
 
DT_UNKNOWN


	)

101 
	mDT_FIFO
 = 1,

102 
	#DT_FIFO
 
DT_FIFO


	)

103 
	mDT_CHR
 = 2,

104 
	#DT_CHR
 
DT_CHR


	)

105 
	mDT_DIR
 = 4,

106 
	#DT_DIR
 
DT_DIR


	)

107 
	mDT_BLK
 = 6,

108 
	#DT_BLK
 
DT_BLK


	)

109 
	mDT_REG
 = 8,

110 
	#DT_REG
 
DT_REG


	)

111 
	mDT_LNK
 = 10,

112 
	#DT_LNK
 
DT_LNK


	)

113 
	mDT_SOCK
 = 12,

114 
	#DT_SOCK
 
DT_SOCK


	)

115 
	mDT_WHT
 = 14

116 
	#DT_WHT
 
DT_WHT


	)

120 
	#IFTODT
(
mode
è(((modeè& 0170000è>> 12)

	)

121 
	#DTTOIF
(
dœty³
è((dœty³è<< 12)

	)

127 
__dœ¡»am
 
	tDIR
;

134 
DIR
 *
	$İ’dœ
 (cÚ¡ *
__Çme
è
	`__nÚnuÎ
 ((1));

136 #ifdeà
__USE_XOPEN2K8


141 
DIR
 *
	`fdİ’dœ
 (
__fd
);

149 
	$şo£dœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

161 #iâdeà
__USE_FILE_OFFSET64


162 
dœ’t
 *
	$»addœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

164 #ifdeà
__REDIRECT


165 
dœ’t
 *
	`__REDIRECT
 (
»addœ
, (
DIR
 *
__dœp
), 
»addœ64
)

166 
	`__nÚnuÎ
 ((1));

168 
	#»addœ
 
»addœ64


	)

172 #ifdeà
__USE_LARGEFILE64


173 
dœ’t64
 *
	$»addœ64
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

176 #ifdeà
__USE_POSIX


182 #iâdeà
__USE_FILE_OFFSET64


183 
	$»addœ_r
 (
DIR
 *
__»¡riù
 
__dœp
,

184 
dœ’t
 *
__»¡riù
 
__’Œy
,

185 
dœ’t
 **
__»¡riù
 
__»suÉ
)

186 
	`__nÚnuÎ
 ((1, 2, 3));

188 #ifdeà
__REDIRECT


189 
	`__REDIRECT
 (
»addœ_r
,

190 (
DIR
 *
__»¡riù
 
__dœp
,

191 
dœ’t
 *
__»¡riù
 
__’Œy
,

192 
dœ’t
 **
__»¡riù
 
__»suÉ
),

193 
»addœ64_r
è
	`__nÚnuÎ
 ((1, 2, 3));

195 
	#»addœ_r
 
»addœ64_r


	)

199 #ifdeà
__USE_LARGEFILE64


200 
	$»addœ64_r
 (
DIR
 *
__»¡riù
 
__dœp
,

201 
dœ’t64
 *
__»¡riù
 
__’Œy
,

202 
dœ’t64
 **
__»¡riù
 
__»suÉ
)

203 
	`__nÚnuÎ
 ((1, 2, 3));

208 
	$»wšddœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

210 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


211 
	~<b™s/ty³s.h
>

214 
	$£ekdœ
 (
DIR
 *
__dœp
, 
__pos
è
__THROW
 
	`__nÚnuÎ
 ((1));

217 
	$‹Îdœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

220 #ifdeà
__USE_XOPEN2K8


223 
	$dœfd
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

225 #ià
defšed
 
__OPTIMIZE__
 && defšed 
_DIR_dœfd


226 
	#dœfd
(
dœp
è
	`_DIR_dœfd
 (dœp)

	)

229 #ifdeà
__USE_MISC


230 #iâdeà
MAXNAMLEN


232 
	~<b™s/posix1_lim.h
>

235 #ifdeà
NAME_MAX


236 
	#MAXNAMLEN
 
NAME_MAX


	)

238 
	#MAXNAMLEN
 255

	)

243 
	#__Ãed_size_t


	)

244 
	~<¡ddef.h
>

253 #iâdeà
__USE_FILE_OFFSET64


254 
	$sÿndœ
 (cÚ¡ *
__»¡riù
 
__dœ
,

255 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

256 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

257 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

258 cÚ¡ 
dœ’t
 **))

259 
	`__nÚnuÎ
 ((1, 2));

261 #ifdeà
__REDIRECT


262 
	`__REDIRECT
 (
sÿndœ
,

263 (cÚ¡ *
__»¡riù
 
__dœ
,

264 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

265 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

266 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

267 cÚ¡ 
dœ’t
 **)),

268 
sÿndœ64
è
	`__nÚnuÎ
 ((1, 2));

270 
	#sÿndœ
 
sÿndœ64


	)

274 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


277 
	$sÿndœ64
 (cÚ¡ *
__»¡riù
 
__dœ
,

278 
dœ’t64
 ***
__»¡riù
 
__Çm–i¡
,

279 (*
__£ËùÜ
è(cÚ¡ 
dœ’t64
 *),

280 (*
__cmp
è(cÚ¡ 
dœ’t64
 **,

281 cÚ¡ 
dœ’t64
 **))

282 
	`__nÚnuÎ
 ((1, 2));

285 #ifdeà
__USE_GNU


291 #iâdeà
__USE_FILE_OFFSET64


292 
	$sÿndœ©
 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

293 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

294 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

295 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

296 cÚ¡ 
dœ’t
 **))

297 
	`__nÚnuÎ
 ((2, 3));

299 #ifdeà
__REDIRECT


300 
	`__REDIRECT
 (
sÿndœ©
,

301 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

302 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

303 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

304 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

305 cÚ¡ 
dœ’t
 **)),

306 
sÿndœ©64
è
	`__nÚnuÎ
 ((2, 3));

308 
	#sÿndœ©
 
sÿndœ©64


	)

314 
	$sÿndœ©64
 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

315 
dœ’t64
 ***
__»¡riù
 
__Çm–i¡
,

316 (*
__£ËùÜ
è(cÚ¡ 
dœ’t64
 *),

317 (*
__cmp
è(cÚ¡ 
dœ’t64
 **,

318 cÚ¡ 
dœ’t64
 **))

319 
	`__nÚnuÎ
 ((2, 3));

323 #iâdeà
__USE_FILE_OFFSET64


324 
	$®phasÜt
 (cÚ¡ 
dœ’t
 **
__e1
,

325 cÚ¡ 
dœ’t
 **
__e2
)

326 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

328 #ifdeà
__REDIRECT


329 
	`__REDIRECT_NTH
 (
®phasÜt
,

330 (cÚ¡ 
dœ’t
 **
__e1
,

331 cÚ¡ 
dœ’t
 **
__e2
),

332 
®phasÜt64
è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

334 
	#®phasÜt
 
®phasÜt64


	)

338 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


339 
	$®phasÜt64
 (cÚ¡ 
dœ’t64
 **
__e1
,

340 cÚ¡ 
dœ’t64
 **
__e2
)

341 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

346 #ifdeà
__USE_MISC


351 #iâdeà
__USE_FILE_OFFSET64


352 
__ssize_t
 
	$g‘dœ’Œ›s
 (
__fd
, *
__»¡riù
 
__buf
,

353 
size_t
 
__nby‹s
,

354 
__off_t
 *
__»¡riù
 
__ba£p
)

355 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

357 #ifdeà
__REDIRECT


358 
__ssize_t
 
	`__REDIRECT_NTH
 (
g‘dœ’Œ›s
,

359 (
__fd
, *
__»¡riù
 
__buf
,

360 
size_t
 
__nby‹s
,

361 
__off64_t
 *
__»¡riù
 
__ba£p
),

362 
g‘dœ’Œ›s64
è
	`__nÚnuÎ
 ((2, 4));

364 
	#g‘dœ’Œ›s
 
g‘dœ’Œ›s64


	)

368 #ifdeà
__USE_LARGEFILE64


369 
__ssize_t
 
	$g‘dœ’Œ›s64
 (
__fd
, *
__»¡riù
 
__buf
,

370 
size_t
 
__nby‹s
,

371 
__off64_t
 *
__»¡riù
 
__ba£p
)

372 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

376 #ifdeà
__USE_GNU


378 #iâdeà
__USE_FILE_OFFSET64


379 
	$v”siÚsÜt
 (cÚ¡ 
dœ’t
 **
__e1
,

380 cÚ¡ 
dœ’t
 **
__e2
)

381 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

383 #ifdeà
__REDIRECT


384 
	`__REDIRECT_NTH
 (
v”siÚsÜt
,

385 (cÚ¡ 
dœ’t
 **
__e1
,

386 cÚ¡ 
dœ’t
 **
__e2
),

387 
v”siÚsÜt64
)

388 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

390 
	#v”siÚsÜt
 
v”siÚsÜt64


	)

394 #ifdeà
__USE_LARGEFILE64


395 
	$v”siÚsÜt64
 (cÚ¡ 
dœ’t64
 **
__e1
,

396 cÚ¡ 
dœ’t64
 **
__e2
)

397 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

401 
__END_DECLS


	@/usr/include/stdlib.h

22 #iâdef 
_STDLIB_H


24 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


29 
	#__Ãed_wch¬_t


	)

30 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

34 
	g__BEGIN_DECLS


36 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


37 
	#_STDLIB_H
 1

	)

39 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
è&& !defšed 
_SYS_WAIT_H


41 
	~<b™s/wa™æags.h
>

42 
	~<b™s/wa™¡©us.h
>

44 #ifdeà
__USE_MISC


49 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


50 
	#__WAIT_INT
(
¡©us
) \

51 (
	`__ex‹nsiÚ__
 (((uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; }) \

52 { .
__š
 = (
¡©us
è}).
__i
))

	)

54 
	#__WAIT_INT
(
¡©us
è(*(*è&(¡©us))

	)

62 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
wa™
 *
	m__u±r
;

70 *
	m__Œ
;

71 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (¡©us))

	)

85 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
 (
	`__WAIT_INT
 (¡©us))

	)

86 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
 (
	`__WAIT_INT
 (¡©us))

	)

87 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
 (
	`__WAIT_INT
 (¡©us))

	)

88 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (¡©us))

	)

89 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (¡©us))

	)

90 #ifdeà
__WIFCONTINUED


91 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (¡©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquÙ
;

100 
	m»m
;

101 } 
	tdiv_t
;

104 #iâdeà
__ldiv_t_defšed


107 
	mquÙ
;

108 
	m»m
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_defšed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


115 
__BEGIN_NAMESPACE_C99


117 
__ex‹nsiÚ__
 struct

119 
	mquÙ
;

120 
	m»m
;

121 } 
	tÎdiv_t
;

122 
	#__Îdiv_t_defšed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

139 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (cÚ¡ *
__ÅŒ
)

145 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

147 
	$©oi
 (cÚ¡ *
__ÅŒ
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

150 
	$©Ş
 (cÚ¡ *
__ÅŒ
)

151 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

152 
__END_NAMESPACE_STD


154 #ifdeà
__USE_ISOC99


155 
__BEGIN_NAMESPACE_C99


157 
__ex‹nsiÚ__
 
	$©Şl
 (cÚ¡ *
__ÅŒ
)

158 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$¡¹od
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

165 **
__»¡riù
 
__’d±r
)

166 
__THROW
 
	`__nÚnuÎ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$¡¹of
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

173 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1));

175 
	$¡¹Şd
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

176 **
__»¡riù
 
__’d±r
)

177 
__THROW
 
	`__nÚnuÎ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$¡¹Ş
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

184 **
__»¡riù
 
__’d±r
, 
__ba£
)

185 
__THROW
 
	`__nÚnuÎ
 ((1));

187 
	$¡¹oul
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

188 **
__»¡riù
 
__’d±r
, 
__ba£
)

189 
__THROW
 
	`__nÚnuÎ
 ((1));

190 
__END_NAMESPACE_STD


192 #ifdeà
__USE_MISC


194 
__ex‹nsiÚ__


195 
	$¡¹oq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

196 **
__»¡riù
 
__’d±r
, 
__ba£
)

197 
__THROW
 
	`__nÚnuÎ
 ((1));

199 
__ex‹nsiÚ__


200 
	$¡¹ouq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

201 **
__»¡riù
 
__’d±r
, 
__ba£
)

202 
__THROW
 
	`__nÚnuÎ
 ((1));

205 #ifdeà
__USE_ISOC99


206 
__BEGIN_NAMESPACE_C99


208 
__ex‹nsiÚ__


209 
	$¡¹Şl
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

210 **
__»¡riù
 
__’d±r
, 
__ba£
)

211 
__THROW
 
	`__nÚnuÎ
 ((1));

213 
__ex‹nsiÚ__


214 
	$¡¹ouÎ
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

215 **
__»¡riù
 
__’d±r
, 
__ba£
)

216 
__THROW
 
	`__nÚnuÎ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifdeà
__USE_GNU


235 
	~<xloÿË.h
>

239 
	$¡¹Ş_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

240 **
__»¡riù
 
__’d±r
, 
__ba£
,

241 
__loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4));

243 
	$¡¹oul_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

244 **
__»¡riù
 
__’d±r
,

245 
__ba£
, 
__loÿË_t
 
__loc
)

246 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

248 
__ex‹nsiÚ__


249 
	$¡¹Şl_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

250 **
__»¡riù
 
__’d±r
, 
__ba£
,

251 
__loÿË_t
 
__loc
)

252 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

254 
__ex‹nsiÚ__


255 
	$¡¹ouÎ_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

256 **
__»¡riù
 
__’d±r
,

257 
__ba£
, 
__loÿË_t
 
__loc
)

258 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

260 
	$¡¹od_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

261 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

262 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

264 
	$¡¹of_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

265 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

266 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

268 
	$¡¹Şd_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

269 **
__»¡riù
 
__’d±r
,

270 
__loÿË_t
 
__loc
)

271 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

275 #ifdeà
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__ex‹º_šlše
 

278 
	`__NTH
 (
	$©oi
 (cÚ¡ *
__ÅŒ
))

280  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

281 
	}
}

282 
__ex‹º_šlše
 

283 
__NTH
 (
	$©Ş
 (cÚ¡ *
__ÅŒ
))

285  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #ifdeà
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

292 
__NTH
 (
	$©Şl
 (cÚ¡ *
__ÅŒ
))

294  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

308 
	$a64l
 (cÚ¡ *
__s
)

309 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

313 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


314 
	~<sys/ty³s.h
>

321 
	$¿ndom
 (è
__THROW
;

324 
	$¤ªdom
 (
__£ed
è
__THROW
;

330 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

331 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

335 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

338 #ifdeà
__USE_MISC


343 
	s¿ndom_d©a


345 
št32_t
 *
åŒ
;

346 
št32_t
 *
½Œ
;

347 
št32_t
 *
¡©e
;

348 
¿nd_ty³
;

349 
¿nd_deg
;

350 
¿nd_£p
;

351 
št32_t
 *
’d_±r
;

354 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

355 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

357 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

358 
__THROW
 
	`__nÚnuÎ
 ((2));

360 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

361 
size_t
 
__¡©–’
,

362 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

363 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

365 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

366 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

367 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$¿nd
 (è
__THROW
;

376 
	$¤ªd
 (
__£ed
è
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifdeà
__USE_POSIX


381 
	$¿nd_r
 (*
__£ed
è
__THROW
;

385 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


389 
	$d¿nd48
 (è
__THROW
;

390 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

393 
	$Ìªd48
 (è
__THROW
;

394 
	$Äªd48
 (
__xsubi
[3])

395 
__THROW
 
	`__nÚnuÎ
 ((1));

398 
	$m¿nd48
 (è
__THROW
;

399 
	$j¿nd48
 (
__xsubi
[3])

400 
__THROW
 
	`__nÚnuÎ
 ((1));

403 
	$¤ªd48
 (
__£edv®
è
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__nÚnuÎ
 ((1));

406 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

408 #ifdeà
__USE_MISC


412 
	sd¿nd48_d©a


414 
__x
[3];

415 
__Şd_x
[3];

416 
__c
;

417 
__š™
;

418 
__ex‹nsiÚ__
 
__a
;

423 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

424 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

425 
	$”ªd48_r
 (
__xsubi
[3],

426 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

427 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

430 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

431 *
__»¡riù
 
__»suÉ
)

432 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

433 
	$Äªd48_r
 (
__xsubi
[3],

434 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

435 *
__»¡riù
 
__»suÉ
)

436 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

439 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

440 *
__»¡riù
 
__»suÉ
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

442 
	$j¿nd48_r
 (
__xsubi
[3],

443 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

444 *
__»¡riù
 
__»suÉ
)

445 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

448 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

449 
__THROW
 
	`__nÚnuÎ
 ((2));

451 
	$£ed48_r
 (
__£ed16v
[3],

452 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

454 
	$lcÚg48_r
 (
__·¿m
[7],

455 
d¿nd48_d©a
 *
__bufãr
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

462 #iâdeà
__m®loc_ªd_ÿÎoc_defšed


463 
	#__m®loc_ªd_ÿÎoc_defšed


	)

464 
__BEGIN_NAMESPACE_STD


466 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

468 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

469 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

470 
__END_NAMESPACE_STD


473 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


474 
__BEGIN_NAMESPACE_STD


480 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

481 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

483 
	$ä“
 (*
__±r
è
__THROW
;

484 
__END_NAMESPACE_STD


486 #ifdef 
__USE_MISC


488 
	$cä“
 (*
__±r
è
__THROW
;

491 #ifdeà
__USE_MISC


492 
	~<®loÿ.h
>

495 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

496 || 
defšed
 
__USE_MISC


498 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

501 #ifdeà
__USE_XOPEN2K


503 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

504 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

507 #ifdeà
__USE_ISOC11


509 *
	$®igÃd_®loc
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

510 
__THROW
 
__©Œibu‹_m®loc__
 
	`__©Œibu‹_®loc_size__
 ((2)è
__wur
;

513 
__BEGIN_NAMESPACE_STD


515 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

519 
	$©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

521 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


523 #ifdeà
__ılu¥lus


524 "C++" 
	$©_quick_ex™
 ((*
__func
) ())

525 
__THROW
 
	`__asm
 ("©_quick_ex™"è
	`__nÚnuÎ
 ((1));

527 
	$©_quick_ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

530 
__END_NAMESPACE_STD


532 #ifdef 
__USE_MISC


535 
	$Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

536 
__THROW
 
	`__nÚnuÎ
 ((1));

539 
__BEGIN_NAMESPACE_STD


543 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

545 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


549 
	$quick_ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

551 
__END_NAMESPACE_STD


553 #ifdeà
__USE_ISOC99


554 
__BEGIN_NAMESPACE_C99


557 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

558 
__END_NAMESPACE_C99


562 
__BEGIN_NAMESPACE_STD


564 *
	$g‘’v
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

565 
__END_NAMESPACE_STD


567 #ifdeà
__USE_GNU


570 *
	$£cu»_g‘’v
 (cÚ¡ *
__Çme
)

571 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

574 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


578 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

581 #ifdeà
__USE_XOPEN2K


584 
	$£‹nv
 (cÚ¡ *
__Çme
, cÚ¡ *
__v®ue
, 
__»¶aû
)

585 
__THROW
 
	`__nÚnuÎ
 ((2));

588 
	$un£‹nv
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

591 #ifdef 
__USE_MISC


595 
	$ş—»nv
 (è
__THROW
;

599 #ià
defšed
 
__USE_MISC
 \

600 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
)

606 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1));

609 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


618 #iâdeà
__USE_FILE_OFFSET64


619 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

621 #ifdeà
__REDIRECT


622 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

623 
	`__nÚnuÎ
 ((1)è
__wur
;

625 
	#mk¡emp
 
mk¡emp64


	)

628 #ifdeà
__USE_LARGEFILE64


629 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

633 #ifdeà
__USE_MISC


640 #iâdeà
__USE_FILE_OFFSET64


641 
	$mk¡emps
 (*
__‹m¶©e
, 
__suffixËn
è
	`__nÚnuÎ
 ((1)è
__wur
;

643 #ifdeà
__REDIRECT


644 
	`__REDIRECT
 (
mk¡emps
, (*
__‹m¶©e
, 
__suffixËn
),

645 
mk¡emps64
è
	`__nÚnuÎ
 ((1)è
__wur
;

647 
	#mk¡emps
 
mk¡emps64


	)

650 #ifdeà
__USE_LARGEFILE64


651 
	$mk¡emps64
 (*
__‹m¶©e
, 
__suffixËn
)

652 
	`__nÚnuÎ
 ((1)è
__wur
;

656 #ifdeà
__USE_XOPEN2K8


662 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

665 #ifdeà
__USE_GNU


672 #iâdeà
__USE_FILE_OFFSET64


673 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

675 #ifdeà
__REDIRECT


676 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

677 
	`__nÚnuÎ
 ((1)è
__wur
;

679 
	#mko¡emp
 
mko¡emp64


	)

682 #ifdeà
__USE_LARGEFILE64


683 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

692 #iâdeà
__USE_FILE_OFFSET64


693 
	$mko¡emps
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

694 
	`__nÚnuÎ
 ((1)è
__wur
;

696 #ifdeà
__REDIRECT


697 
	`__REDIRECT
 (
mko¡emps
, (*
__‹m¶©e
, 
__suffixËn
,

698 
__æags
), 
mko¡emps64
)

699 
	`__nÚnuÎ
 ((1)è
__wur
;

701 
	#mko¡emps
 
mko¡emps64


	)

704 #ifdeà
__USE_LARGEFILE64


705 
	$mko¡emps64
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

706 
	`__nÚnuÎ
 ((1)è
__wur
;

711 
__BEGIN_NAMESPACE_STD


716 
	$sy¡em
 (cÚ¡ *
__commªd
è
__wur
;

717 
__END_NAMESPACE_STD


720 #ifdef 
__USE_GNU


723 *
	$ÿnÚiÿlize_fe_Çme
 (cÚ¡ *
__Çme
)

724 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

727 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


733 *
	$»®·th
 (cÚ¡ *
__»¡riù
 
__Çme
,

734 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

739 #iâdeà
__COMPAR_FN_T


740 
	#__COMPAR_FN_T


	)

741 (*
	t__com·r_â_t
) (const *, const *);

743 #ifdef 
__USE_GNU


744 
__com·r_â_t
 
	tcom·risÚ_â_t
;

747 #ifdeà
__USE_GNU


748 (*
	t__com·r_d_â_t
) (const *, const *, *);

751 
__BEGIN_NAMESPACE_STD


754 *
	$b£¬ch
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
,

755 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

756 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

758 #ifdeà
__USE_EXTERN_INLINES


759 
	~<b™s/¡dlib-b£¬ch.h
>

764 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

765 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

766 #ifdeà
__USE_GNU


767 
	$qsÜt_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

768 
__com·r_d_â_t
 
__com·r
, *
__¬g
)

769 
	`__nÚnuÎ
 ((1, 4));

774 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

775 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

776 
__END_NAMESPACE_STD


778 #ifdeà
__USE_ISOC99


779 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

780 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

784 
__BEGIN_NAMESPACE_STD


788 
div_t
 
	$div
 (
__num”
, 
__d’om
)

789 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

790 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

791 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

792 
__END_NAMESPACE_STD


794 #ifdeà
__USE_ISOC99


795 
__BEGIN_NAMESPACE_C99


796 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

797 
__d’om
)

798 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

799 
__END_NAMESPACE_C99


803 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

804 || 
defšed
 
__USE_MISC


811 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

812 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

817 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

818 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

823 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

824 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

827 #ifdeà
__USE_MISC


829 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

830 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

831 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

832 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

833 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

834 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

835 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

836 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

841 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

842 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

843 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

844 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

845 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

846 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

848 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

849 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

850 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

851 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

852 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

853 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

854 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

855 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

859 
__BEGIN_NAMESPACE_STD


862 
	$mbËn
 (cÚ¡ *
__s
, 
size_t
 
__n
è
__THROW
;

865 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

866 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

869 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
;

873 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

874 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

876 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

877 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

878 
__THROW
;

879 
__END_NAMESPACE_STD


882 #ifdeà
__USE_MISC


887 
	$½m©ch
 (cÚ¡ *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

891 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


898 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

899 *cÚ¡ *
__»¡riù
 
__tok’s
,

900 **
__»¡riù
 
__v®u•
)

901 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

905 #ifdeà
__USE_XOPEN


907 
	$£tkey
 (cÚ¡ *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

913 #ifdeà
__USE_XOPEN2KXSI


915 
	$posix_İ’±
 (
__oæag
è
__wur
;

918 #ifdeà
__USE_XOPEN


923 
	$g¿Á±
 (
__fd
è
__THROW
;

927 
	$uÆock±
 (
__fd
è
__THROW
;

932 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

935 #ifdeà
__USE_GNU


939 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

940 
__THROW
 
	`__nÚnuÎ
 ((2));

943 
	`g‘±
 ();

946 #ifdeà
__USE_MISC


950 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

951 
__THROW
 
	`__nÚnuÎ
 ((1));

954 
	~<b™s/¡dlib-æßt.h
>

957 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


958 
	~<b™s/¡dlib.h
>

960 #ifdeà
__LDBL_COMPAT


961 
	~<b™s/¡dlib-ldbl.h
>

965 #undeà
__Ãed_m®loc_ªd_ÿÎoc


967 
__END_DECLS


	@/usr/include/time.h

22 #iâdef 
_TIME_H


24 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

25 ! 
defšed
 
	g__Ãed_time¥ec
)

26 
	#_TIME_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__Ãed_size_t


	)

36 
	#__Ãed_NULL


	)

37 
	~<¡ddef.h
>

41 
	~<b™s/time.h
>

44 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


45 #iâdeà
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

53 
	#__şock_t_defšed
 1

	)

55 
	~<b™s/ty³s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__şock_t
 
	tşock_t
;

60 
	g__END_NAMESPACE_STD


61 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX


62 
	$__USING_NAMESPACE_STD
(
şock_t
)

66 #undeà
__Ãed_şock_t


68 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

69 
	#__time_t_defšed
 1

	)

71 
	~<b™s/ty³s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #ifdeà
__USE_POSIX


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #undeà
__Ãed_time_t


84 #ià!
defšed
 
__şockid_t_defšed
 && \

85 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

86 
	#__şockid_t_defšed
 1

	)

88 
	~<b™s/ty³s.h
>

91 
__şockid_t
 
	tşockid_t
;

94 #undeà
__şockid_time_t


96 #ià!
defšed
 
__tim”_t_defšed
 && \

97 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

98 
	#__tim”_t_defšed
 1

	)

100 
	~<b™s/ty³s.h
>

103 
__tim”_t
 
	ttim”_t
;

106 #undeà
__Ãed_tim”_t


109 #ià(!
defšed
 
__time¥ec_defšed
 \

110 && ((
defšed
 
_TIME_H
 \

111 && (
defšed
 
__USE_POSIX199309
 \

112 || 
defšed
 
__USE_ISOC11
)) \

113 || 
defšed
 
__Ãed_time¥ec
))

114 
	#__time¥ec_defšed
 1

	)

116 
	~<b™s/ty³s.h
>

120 
	stime¥ec


122 
__time_t
 
tv_£c
;

123 
__sysÿÎ_¦Úg_t
 
tv_n£c
;

127 #undeà
__Ãed_time¥ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mš
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_mÚ
;

140 
tm_y—r
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd¡
;

145 #ifdef 
__USE_MISC


146 
tm_gmtoff
;

147 cÚ¡ *
tm_zÚe
;

149 
__tm_gmtoff
;

150 cÚ¡ *
__tm_zÚe
;

153 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifdeà
__USE_POSIX199309


161 
	s™im”¥ec


163 
time¥ec
 
™_š‹rv®
;

164 
time¥ec
 
™_v®ue
;

168 
sigev’t
;

172 #ifdeà
__USE_XOPEN2K


173 #iâdeà
__pid_t_defšed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_defšed


	)

180 #ifdeà
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
şock_t
 
	$şock
 (è
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

195 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

196 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

199 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

205 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

206 cÚ¡ *
__»¡riù
 
__fÜm©
,

207 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifdeà
__USE_XOPEN


213 *
	$¡½time
 (cÚ¡ *
__»¡riù
 
__s
,

214 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
)

215 
__THROW
;

218 #ifdeà
__USE_XOPEN2K8


221 
	~<xloÿË.h
>

223 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

224 cÚ¡ *
__»¡riù
 
__fÜm©
,

225 cÚ¡ 
tm
 *
__»¡riù
 
__
,

226 
__loÿË_t
 
__loc
è
__THROW
;

229 #ifdeà
__USE_GNU


230 *
	$¡½time_l
 (cÚ¡ *
__»¡riù
 
__s
,

231 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
,

232 
__loÿË_t
 
__loc
è
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

243 
tm
 *
	$loÿÉime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

244 
__END_NAMESPACE_STD


246 #ifdeà
__USE_POSIX


249 
tm
 *
	$gmtime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

250 
tm
 *
__»¡riù
 
__
è
__THROW
;

254 
tm
 *
	$loÿÉime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

255 
tm
 *
__»¡riù
 
__
è
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$asùime
 (cÚ¡ 
tm
 *
__
è
__THROW
;

264 *
	$ùime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

265 
__END_NAMESPACE_STD


267 #ifdeà
__USE_POSIX


272 *
	$asùime_r
 (cÚ¡ 
tm
 *
__»¡riù
 
__
,

273 *
__»¡riù
 
__buf
è
__THROW
;

276 *
	$ùime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

277 *
__»¡riù
 
__buf
è
__THROW
;

282 *
__tzÇme
[2];

283 
__daylight
;

284 
__timezÚe
;

287 #ifdef 
__USE_POSIX


289 *
tzÇme
[2];

293 
	$tz£t
 (è
__THROW
;

296 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


297 
daylight
;

298 
timezÚe
;

301 #ifdeà
__USE_MISC


304 
	$¡ime
 (cÚ¡ 
time_t
 *
__wh’
è
__THROW
;

310 
	#__i¦—p
(
y—r
) \

311 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

314 #ifdeà
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

322 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

325 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

329 #ifdeà
__USE_POSIX199309


334 
	`Çno¦“p
 (cÚ¡ 
time¥ec
 *
__»que¡ed_time
,

335 
time¥ec
 *
__»maššg
);

339 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

342 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

345 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, cÚ¡ 
time¥ec
 *
__
)

346 
__THROW
;

348 #ifdeà
__USE_XOPEN2K


353 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

354 cÚ¡ 
time¥ec
 *
__»q
,

355 
time¥ec
 *
__»m
);

358 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

363 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

364 
sigev’t
 *
__»¡riù
 
__evp
,

365 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

368 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

371 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

372 cÚ¡ 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

373 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

376 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

377 
__THROW
;

380 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

384 #ifdeà
__USE_ISOC11


386 
	$time¥ec_g‘
 (
time¥ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__nÚnuÎ
 ((1));

391 #ifdeà
__USE_XOPEN_EXTENDED


403 
g‘d©e_”r
;

412 
tm
 *
	`g‘d©e
 (cÚ¡ *
__¡ršg
);

415 #ifdeà
__USE_GNU


426 
	`g‘d©e_r
 (cÚ¡ *
__»¡riù
 
__¡ršg
,

427 
tm
 *
__»¡riù
 
__»sbuå
);

430 
__END_DECLS


	@abstractkmeans.h

1 #iâdeà
ABSTRACTKMEANS_H


2 
	#ABSTRACTKMEANS_H


	)

4 
	~"¥¬£m©rix.h
"

5 
	~"şsšfo.h
"

6 
	~"Â™em.h
"

8 
	~<unÜd”ed_£t
>

9 
	~<veùÜ
>

10 
	~<m­
>

12 
	sCLSIndex


14 
	mpublic
:

15 
CLSIndex
()

17 
šdex
 = 0;

18 
	mv®
 = 0.0;

20 
CLSIndex
(cÚ¡ 
idx
, cÚ¡ 
v®0
)

22 
	mšdex
 = 
idx
;

23 
	mv®
 = 
v®0
;

25 
	mšdex
;

26 
	mv®
;

28 
boŞ
 
LtComp
 (cÚ¡ 
CLSIndex
 *
a
,cÚ¡ CLSIndex *
b
)

30  (
	ma
->
	mv®
 < 
	mb
->val);

32 
boŞ
 
LgComp
 (cÚ¡ 
CLSIndex
 *
a
,cÚ¡ CLSIndex *
b
)

34  (
	ma
->
	mv®
 < 
	mb
->val);

39 
	eKMN_OPT
 {
	m_tkmn_
 = 0, 
	m_kµkmn_
 = 1, 
	m_xbkmn_
 = 2, 
	m_xtkmn_
 = 3, 
	m_mnkmn_
 = 4, 
	m_Şkmn_
 = 5, 
	m_rbkmn_
, 
	m_¼kmn_
, 
	m_lvq_
, 
	m_hek_
, 
	m_imk_
, 
	m_hec_
, 
	m_´c_
, 
	m_pqc_
, 
	m_½kmn_
};

40 
	eOPTZ
 {
	m_I1_
 = 0, 
	m_I2_
 = 1, 
	m_I3_
, 
	m_I4_
, 
	m_E1_
, 
	m_E2_
,
	m_T1_
};

41 
	eSEED
 {
	m_ºd_
 = 0, 
	m_kµ_
 = 1, 
	m_nÚ_
};

43 şas 
	cAb¡¿ùKM—ns


45 
	m´Ùeùed
:

46 
Ab¡¿ùKM—ns
();

48 
	m´Ùeùed
:

49 cÚ¡ 
·¿Bound
;

50 
	mcouÁ
, 
	mşnumb
;

51 
	mnITER
, 
	mndim
;

52 
	mnThrd
;

53 
	mveùÜ
<
	mNNI‹m
*> 
	msÜ‹d_¡ack
;

54 cÚ¡ 
	msm®lV®0
;

55 *
	mËns
, 
	m®lEg
;

56 
boŞ
 
	m_INIT_
, 
	m_REFER_
, 
	m_REFINE_
;

57 
	m¤cm©â
[1024];

58 
	mmthSŒ
[16];

59 
	mmvs
[2];

60 
	md¡Üt
;

61 
SEED
 
	m£ed
;

62 *
	md©a
;

64 
S·r£M©rix
 
	msd©a
;

65 
CLSInfo
 *
	mšfoM­
;

66 *
	mÏb–s
;

67 
KMN_OPT
 
	mkmMtd
;

68 
boŞ
 
	md©aTy³
;

69 
boŞ
 
	mSHUFFLE
;

70 
OPTZ
 
	mmyİtz
;

71 
	mpublic
:

72 
budşu¡”
(cÚ¡ *
¤câ
, cÚ¡ *
d¡â
, cÚ¡ *
_£ed_
, cÚ¡ *
lg_fœ¡
,

73 cÚ¡ *
üŒn
, cÚ¡ 
num
, 
boŞ
 
_»fše_
);

74 
budşu¡”
(*
m©
, cÚ¡ 
row
, cÚ¡ 
dim
, cÚ¡ *
d¡â
,

75 cÚ¡ *
_£ed_
, cÚ¡ *
lg_fœ¡
, cÚ¡ *
üŒn
, cÚ¡ 
num
, 
boŞ
 
_»fše_
);

77 
boŞ
 
š™Memry
(cÚ¡ 
dNum
, cÚ¡ 
şu¡Num
);

78 
vœtu®
 
boŞ
 
š™
(cÚ¡ *
¤câ
) = 0;

79 
vœtu®
 
boŞ
 
š™
(*
d©a
, cÚ¡ 
row
, cÚ¡ 
dim
) = 0;

80 
vœtu®
 
boŞ
 
cÚfig
(cÚ¡ *
_£ed_
, cÚ¡ *
lg_fœ¡
, cÚ¡ *
üŒn
, 
v”bo£
) = 0;

81 
vœtu®
 
şu¡
(cÚ¡ 
şu¡_num
, cÚ¡ *
d¡â
, cÚ¡ 
v”bo£
) = 0;

82 
g‘I2
(cÚ¡ *
Ds
, cÚ¡ 
k
, cÚ¡ 
dim
, cÚ¡ *
tm²s
);

84 
ÿlAVGDi¡
(cÚ¡ *
Ds
, cÚ¡ *
Ns
, cÚ¡ 
şu¡Num
, 
CLSInfo
 *
šfos
);

85 
ÿlAVGDi¡
(cÚ¡ *
Ds
, cÚ¡ *
Ns
, cÚ¡ 
şu¡Num
);

86 *
g‘Clu¡”
(cÚ¡ 
şab–0
, &
row
, &
dim
);

88 
vœtu®
 
§veC’‹rs
(cÚ¡ *
d¡â
, 
boŞ
 
­³nd
) = 0;

89 
§veC’‹rs
(cÚ¡ *
d¡â
, *
¬¿yD
, 
boŞ
 
­³nd
, boŞ 
nÜm
);

90 
vœtu®
 
ãtchC’‹rs
(*
ûÁ”s
) = 0;

92 
idx2şab–
(cÚ¡ 
i
);

94 
´štClu¡”s
(cÚ¡ *
d¡dœ
);

95 
´štClu¡”
(cÚ¡ *
d¡â
);

96 
boŞ
 
§ve_şu¡
(cÚ¡ *
d¡â
);

97 
boŞ
 
Ïb–2şu¡”
(
veùÜ
<> *
şu¡”s
);

98 
boŞ
 
g‘Lab–
(*
Ïb–s
);

100 
nÜmVeùs
(*
veùs
, *
Ëns
, cÚ¡ 
dim
, cÚ¡ 
n0
);

101 
nÜmVeùs
(cÚ¡ 
S·r£M©rix
 &
sveùs
, *
Ëns
, cÚ¡ 
dim
, cÚ¡ 
n0
);

102 
nÜmVeùs
(*
veùs
, cÚ¡ 
d0
, cÚ¡ 
n0
, *
Ëns
);

103 
nÜmVeùs
(
S·r£M©rix
 &
veùs
, cÚ¡ 
d0
, cÚ¡ 
n0
, *
Ëns
);

105 
»£ab–s
(&
şu¡num
);

107 
	mvœtu®
 ~
Ab¡¿ùKM—ns
();

	@cleaner.h

1 #iâdeà
CLEANER_H


2 
	#CLEANER_H


	)

4 
	~"şsšfo.h
"

5 
	~"Â™em.h
"

8 
	~<veùÜ
>

9 
	~<th»ad
>

10 
	~<li¡
>

11 
	~<m­
>

12 
	~<£t
>

24 
usšg
 
Çme¥aû
 
	g¡d
;

26 şas 
	cCËª”


30 
	mpublic
:

32 
ş—rNNLi¡
(
li¡
<
NNI‹m
*> &
ÂI‹ms
);

33 
ş—rNNLi¡
(
li¡
<
MšiNN
*> &
ÂI‹ms
);

35 
ş—rM©rix
(
veùÜ
<veùÜ<> > &
m©rix
);

37 
ş—r_k2iM­
(
m­
<
¡ršg
, > &
»fTab
);

38 
ş—r_k2iM­
(
m­
<
¡ršg
, > &
»fTab
);

39 
ş—r_i2kM­
(
m­
<, cÚ¡ *> &
i2kM­
);

41 
ä“I‹mM­s
(
m­
<, m­<
¡ršg
, cÚ¡ *> *> &
™mM­s
);

43 
ä“P¬aM­
(
m­
<
¡ršg
, cÚ¡ *> &
·¿s
);

44 
ä“SŒVeù
(
veùÜ
<cÚ¡ *> &
¡rVeù
);

45 
ş—rTh»ad
(
veùÜ
<
¡d
::
th»ad
*> &
thrds
);

47 
ş—rClu¡
(
m­
<, 
£t
<> *> &
şu¡
);

49 
boŞ
 
ş—rVeùÜ
(
veùÜ
<
NNI‹m
*> &
veùs
);

50 
ş—rInfoM­
(
m­
<, 
CLSInfo
*> &
šfoM­
);

52 
ş—rM­
(
m­
<, 
¡ršg
> &
is
);

53 
ş—rM­
(
m­
<
¡ršg
, sŒšg> &
ss
);

54 
ş—rM­
(
m­
<
¡ršg
, > &
si
);

	@clsinfo.h

1 #iâdeà
CLSINDEX_H


2 
	#CLSINDEX_H


	)

4 
	~<veùÜ
>

6 
usšg
 
	g¡d
::
veùÜ
;

8 
	sCLSInfo


10 
	mpublic
:

11 
CLSInfo
()

13 
n
 = 0;

14 
	mE
 = 0.0;

16 
	mn
;

17 
	mE
;

20 
	gCLD©a
 : 
public
 
CLSInfo


22 
veùÜ
<> 
şu¡D©aId
;

	@distance.hpp

1 #iâdeà
EFANNA_DISTANCE_H_


2 
	#EFANNA_DISTANCE_H_


	)

3 
	~<¡dlib.h
>

4 
	~<veùÜ
>

5 
	~<£t
>

6 
	~<x86šŒš.h
>

7 
	~<cm©h
>

8 
	~<io¡»am
>

10 #ifdeà
__GNUC__


11 #ifdeà
__AVX__


12 
	#KGRAPH_MATRIX_ALIGN
 32

	)

14 #ifdeà
__SSE2__


15 
	#KGRAPH_MATRIX_ALIGN
 16

	)

17 
	#KGRAPH_MATRIX_ALIGN
 4

	)

24 
Çme¥aû
 
	gDISTANCE


27 
	g‹m¶©e
<
ty³Çme
 
	gT
>

28 
	sCªdid©e


30 
size_t
 
	grow_id
;

31 
T
 
	gdi¡ªû
;

32 
Cªdid©e
(cÚ¡ 
size_t
 
row_id
, cÚ¡ 
T
 
di¡ªû
):„ow_id(row_id), distance(distance) { }

34 
boŞ
 
	gİ”©Ü
 >(cÚ¡ 
	gCªdid©e
& 
	grhs
) const

36 ià(
	gthis
->
	gdi¡ªû
 =ğ
rhs
.
di¡ªû
)

38  
this
->
row_id
 > 
rhs
.row_id;

40  
	gthis
->
	gdi¡ªû
 > 
	grhs
.distance;

42 
boŞ
 
	gİ”©Ü
 <(cÚ¡ 
	gCªdid©e
& 
	grhs
) const

44 ià(
	gthis
->
	gdi¡ªû
 =ğ
rhs
.
di¡ªû
)

46  
this
->
row_id
 < 
rhs
.row_id;

48  
	gthis
->
	gdi¡ªû
 < 
	grhs
.distance;

52 
	g‹m¶©e
<
ty³Çme
 
	gT
>

53 şas 
	cDi¡ªû


55 
	gpublic
:

56 
vœtu®
 
T
 
com·»
(cÚ¡ T* 
a
, cÚ¡ T* 
b
, 
size_t
 
Ëngth
) const = 0;

57 
vœtu®
 
T
 
nÜm
(cÚ¡ T* 
a
, 
size_t
 
Ëngth
) const = 0;

58 
vœtu®
 
T
 
dÙ
(cÚ¡ T* 
a
, cÚ¡ T* 
b
, 
size_t
 
Ëngth
) const = 0;

59 
	gvœtu®
 ~
Di¡ªû
() {}

62 
	#SSE_L2SQR
(
addr1
, 
addr2
, 
de¡
, 
tmp1
, 
tmp2
) \

63 
tmp1
 = 
	`_mm_lßd_ps
(
addr1
);\

64 
tmp2
 = 
	`_mm_lßd_ps
(
addr2
);\

65 
tmp1
 = 
	`_mm_sub_ps
Ñmp1, 
tmp2
); \

66 
tmp1
 = 
	`_mm_mul_ps
(tmp1,mp1); \

67 
de¡
 = 
	`_mm_add_ps
(de¡, 
tmp1
);

	)

70 
	g‹m¶©e
<
ty³Çme
 
	gT
>

71 
şass
 
	gL2Di¡ªûSSE
: 
public
 
Di¡ªû
<
T
>

73 
public
:

74 
T
 
	tResuÉTy³
;

79 
ResuÉTy³
 
com·»
(cÚ¡ 
T
* 
a
, cÚ¡ T* 
b
, 
size_t
 
size
) const

82 
__m128
 
	gsum
;

83 
__m128
 
	gl0
, 
	gl1
, 
	gl2
, 
	gl3
;

84 
__m128
 
	gr0
, 
	gr1
, 
	gr2
, 
	gr3
;

85 
	gD
 = (
size
 + 3) & ~3U;

86 
	gDR
 = 
D
 % 16;

87 
	gDD
 = 
D
 - 
DR
;

88 cÚ¡ *
	gl
 = 
a
;

89 cÚ¡ *
	gr
 = 
b
;

90 cÚ¡ *
	ge_l
 = 
l
 + 
DD
;

91 cÚ¡ *
	ge_r
 = 
r
 + 
DD
;

92 
	guÅack
[4] 
__©Œibu‹__
 ((
®igÃd
 (16))) = {0, 0, 0, 0};

93 
ResuÉTy³
 
	g»t
 = 0.0;

94 
	gsum
 = 
_mm_lßd_ps
(
uÅack
);

95 
	gDR
)

98 
SSE_L2SQR
(
e_l
+8, 
e_r
+8, 
sum
, 
l2
, 
r2
);

100 
SSE_L2SQR
(
e_l
+4, 
e_r
+4, 
sum
, 
l1
, 
r1
);

102 
SSE_L2SQR
(
e_l
, 
e_r
, 
sum
, 
l0
, 
r0
);

104 
	gi
 = 0; i < 
	gDD
; i +ğ16, 
	gl
 +ğ16, 
	gr
 += 16)

106 
SSE_L2SQR
(
l
, 
r
, 
sum
, 
l0
, 
r0
);

107 
SSE_L2SQR
(
l
 + 4, 
r
 + 4, 
sum
, 
l1
, 
r1
);

108 
SSE_L2SQR
(
l
 + 8, 
r
 + 8, 
sum
, 
l2
, 
r2
);

109 
SSE_L2SQR
(
l
 + 12, 
r
 + 12, 
sum
, 
l3
, 
r3
);

111 
_mm_¡Üeu_ps
(
uÅack
, 
sum
);

112 
	g»t
 = 
uÅack
[0] + unpack[1] + unpack[2] + unpack[3];

113  
	g»t
;

116 
T
 
nÜm
(cÚ¡ T* 
a
, 
size_t
 
Ëngth
) const

120 
T
 
dÙ
(cÚ¡ T* 
a
, cÚ¡ T* 
b
, 
size_t
 
Ëngth
) const

128 
	g‹m¶©e
<
ty³Çme
 
	gT
>

129 
şass
 
	gL2Di¡ªû
: 
public
 
Di¡ªû
<
T
>

131 
public
:

132 
T
 
	tResuÉTy³
;

136 
ResuÉTy³
 
com·»
(cÚ¡ 
T
* 
a
, cÚ¡ T* 
b
, 
size_t
 
size
) const

138 
ResuÉTy³
 
	g»suÉ
 = ResultType();

139 
ResuÉTy³
 
	gdiff0
 = 0;

140 
	g»suÉ
 = 0;

141 
	gi
 = 0;

142 
	gi
 = 0; i < 
	gsize
; i++)

144 
	gdiff0
 = (
ResuÉTy³
)(
a
[
i
] - 
b
[i]);

145 
	g»suÉ
 +ğ
diff0
 * diff0;

147  
	g»suÉ
;

149 
T
 
nÜm
(cÚ¡ T* 
a
, 
size_t
 
Ëngth
) const

152 
ResuÉTy³
 
	g»suÉ
 = ResultType();

153 
	gi
 = 0;

154 
	gi
 = 0; i < 
	gËngth
; i++)

156 
	g»suÉ
 +ğ(
ResuÉTy³
)(
a
[
i
]*a[i]);

159  
	g»suÉ
;

161 
T
 
dÙ
(cÚ¡ T* 
a
, cÚ¡ T* 
b
, 
size_t
 
Ëngth
) const

163 
ResuÉTy³
 
	g»suÉ
 = ResultType();

164 
ResuÉTy³
 
	gdÙ0
, 
	gdÙ1
, 
	gdÙ2
, 
	gdÙ3
;

165 
	gi
 = 0;

166 
	gi
 = 0; i < 
	gËngth
; i++)

168 
	g»suÉ
 +ğ
a
[
i
]*
b
[i];

171  
	g»suÉ
;

175 
	g‹m¶©e
<
ty³Çme
 
	gT
>

176 
şass
 
	gFa¡L2Di¡ªû
: 
public
 
Di¡ªû
<
T
>

178 
public
:

179 
T
 
	tResuÉTy³
;

184 
ResuÉTy³
 
com·»
(cÚ¡ 
T
* 
a
, cÚ¡ T* 
b
, 
size_t
 
size
) const

186 
ResuÉTy³
 
	g»suÉ
 = ResultType();

187 
ResuÉTy³
 
	gdiff0
, 
	gdiff1
, 
	gdiff2
, 
	gdiff3
;

188 cÚ¡ 
T
* 
	gÏ¡
 = 
a
 + 
size
;

189 cÚ¡ 
T
* 
	gÏ¡group
 = 
Ï¡
 - 3;

192 
	ga
 < 
	gÏ¡group
)

194 
	gdiff0
 = (
ResuÉTy³
)(
a
[0] - 
b
[0]);

195 
	gdiff1
 = (
ResuÉTy³
)(
a
[1] - 
b
[1]);

196 
	gdiff2
 = (
ResuÉTy³
)(
a
[2] - 
b
[2]);

197 
	gdiff3
 = (
ResuÉTy³
)(
a
[3] - 
b
[3]);

198 
	g»suÉ
 +ğ
diff0
 * diff0 + 
diff1
 * diff1 + 
diff2
 * diff2 + 
diff3
 * diff3;

199 
	ga
 += 4;

200 
	gb
 += 4;

203 
	ga
 < 
	gÏ¡
)

205 
	gdiff0
 = (
ResuÉTy³
)(*
a
++ - *
b
++);

206 
	g»suÉ
 +ğ
diff0
 * diff0;

208  
	g»suÉ
;

210 
T
 
nÜm
(cÚ¡ T* 
a
, 
size_t
 
size
) const

212 
T
 
	g»suÉ
 = 
ResuÉTy³
();;

213 cÚ¡ 
T
* 
	gÏ¡
 = 
a
 + 
size
;

214 cÚ¡ 
T
* 
	gÏ¡group
 = 
Ï¡
 - 3;

217 
	ga
 < 
	gÏ¡group
)

219 
	g»suÉ
 +ğ
a
[0] *‡[0] +‡[1] *‡[1] +‡[2] *‡[2] +‡[3] *‡[3];

220 
	ga
 += 4;

223 
	ga
 < 
	gÏ¡
)

225 
	g»suÉ
 +ğ*
a
 * (*a);

226 
	ga
++;

228  
	g»suÉ
;

230 
T
 
dÙ
(cÚ¡ T* 
a
, cÚ¡ T* 
b
, 
size_t
 
size
) const

232 
T
 
	g»suÉ
 = 
ResuÉTy³
();;

233 cÚ¡ 
T
* 
	gÏ¡
 = 
a
 + 
size
;

234 cÚ¡ 
T
* 
	gÏ¡group
 = 
Ï¡
 - 3;

237 
	ga
 < 
	gÏ¡group
)

239 
	g»suÉ
 +ğ
a
[0] * 
b
[0] +‡[1] * b[1] +‡[2] * b[2] +‡[3] * b[3];

240 
	ga
 += 4;

241 
	gb
 += 4;

244 
	ga
 < 
	gÏ¡
)

246 
	g»suÉ
 +ğ(*
a
++è* (*
b
++);

248  
	g»suÉ
;

252 
	g‹m¶©e
<
ty³Çme
 
	gT
>

253 
şass
 
	gL2Di¡ªûAVXr4
: 
public
 
Di¡ªû
<
T
>

255 
public
:

256 
T
 
	tResuÉTy³
;

261 
	#AVX_L2SQR
(
addr1
, 
addr2
, 
de¡
, 
tmp1
, 
tmp2
) \

262 
tmp1
 = 
	`_mm256_lßdu_ps
(
addr1
);\

263 
tmp2
 = 
	`_mm256_lßdu_ps
(
addr2
);\

264 
tmp1
 = 
	`_mm256_sub_ps
Ñmp1, 
tmp2
); \

265 
tmp1
 = 
	`_mm256_mul_ps
(tmp1,mp1); \

266 
de¡
 = 
	`_mm256_add_ps
(de¡, 
tmp1
);

	)

267 
ResuÉTy³
 
com·»
(cÚ¡ 
T
* 
a
, cÚ¡ T* 
b
, 
size_t
 
size
) const

293 
__m256
 
	gsum
;

294 
__m256
 
	gl0
, 
	gl1
, 
	gl2
, 
	gl3
;

295 
__m256
 
	gr0
, 
	gr1
, 
	gr2
, 
	gr3
;

296 
	gD
 = (
size
 + 7) & ~7U;

297 
	gDR
 = 
D
 % 32;

298 
	gDD
 = 
D
 - 
DR
;

299 cÚ¡ *
	gl
 = 
a
;

300 cÚ¡ *
	gr
 = 
b
;

301 cÚ¡ *
	ge_l
 = 
l
 + 
DD
;

302 cÚ¡ *
	ge_r
 = 
r
 + 
DD
;

303 
	guÅack
[8] 
__©Œibu‹__
 ((
®igÃd
 (32))) = {0, 0, 0, 0, 0, 0, 0, 0};

304 
ResuÉTy³
 
	g»t
 = 0.0;

305 
	gsum
 = 
_mm256_lßdu_ps
(
uÅack
);

306 
	gDR
)

309 
AVX_L2SQR
(
e_l
+16, 
e_r
+16, 
sum
, 
l2
, 
r2
);

311 
AVX_L2SQR
(
e_l
+8, 
e_r
+8, 
sum
, 
l1
, 
r1
);

313 
AVX_L2SQR
(
e_l
, 
e_r
, 
sum
, 
l0
, 
r0
);

315 
	gi
 = 0; i < 
	gDD
; i +ğ32, 
	gl
 +ğ32, 
	gr
 += 32)

317 
AVX_L2SQR
(
l
, 
r
, 
sum
, 
l0
, 
r0
);

318 
AVX_L2SQR
(
l
 + 8, 
r
 + 8, 
sum
, 
l1
, 
r1
);

319 
AVX_L2SQR
(
l
 + 16, 
r
 + 16, 
sum
, 
l2
, 
r2
);

320 
AVX_L2SQR
(
l
 + 24, 
r
 + 24, 
sum
, 
l3
, 
r3
);

322 
_mm256_¡Üeu_ps
(
uÅack
, 
sum
);

323 
	g»t
 = 
uÅack
[0] + unpack[1] + unpack[2] + unpack[3] + unpack[4] + unpack[5] + unpack[6] + unpack[7];

324  
	g»t
;

326 
	#AVX_L2NORM
(
addr
, 
de¡
, 
tmp
) \

327 
tmp
 = 
	`_mm256_lßdu_ps
(
addr
); \

328 
tmp
 = 
	`_mm256_mul_ps
(tmp,mp); \

329 
de¡
 = 
	`_mm256_add_ps
(de¡, 
tmp
);

	)

330 
T
 
nÜm
(cÚ¡ T* 
a
, 
size_t
 
size
) const

332 
__m256
 
	gsum
;

333 
__m256
 
	gl0
, 
	gl1
;

334 
	gD
 = (
size
 + 7) & ~7U;

335 
	gDR
 = 
D
 % 16;

336 
	gDD
 = 
D
 - 
DR
;

337 cÚ¡ *
	gl
 = 
a
;

338 cÚ¡ *
	ge_l
 = 
l
 + 
DD
;

339 
	guÅack
[8] 
__©Œibu‹__
 ((
®igÃd
 (32))) = {0, 0, 0, 0, 0, 0, 0, 0};

340 
ResuÉTy³
 
	g»t
 = 0.0;

341 
	gsum
 = 
_mm256_lßdu_ps
(
uÅack
);

342 if(
	gDR
)

344 
AVX_L2NORM
(
e_l
, 
sum
, 
l0
);

346 
	gi
 = 0; i < 
	gDD
; i +ğ16, 
	gl
 += 16)

348 
AVX_L2NORM
(
l
, 
sum
, 
l0
);

349 
AVX_L2NORM
(
l
 + 8, 
sum
, 
l1
);

351 
_mm256_¡Üeu_ps
(
uÅack
, 
sum
);

352 
	g»t
 = 
uÅack
[0] + unpack[1] + unpack[2] + unpack[3] + unpack[4] + unpack[5] + unpack[6] + unpack[7];

353  
	g»t
;

355 
	#AVX_L2DOT
(
addr1
, 
addr2
, 
de¡
, 
tmp1
, 
tmp2
) \

356 
tmp1
 = 
	`_mm256_lßdu_ps
(
addr1
);\

357 
tmp2
 = 
	`_mm256_lßdu_ps
(
addr2
);\

358 
tmp1
 = 
	`_mm256_mul_ps
Ñmp1, 
tmp2
); \

359 
de¡
 = 
	`_mm256_add_ps
(de¡, 
tmp1
);

	)

360 
T
 
dÙ
(cÚ¡ T* 
a
, cÚ¡ T* 
b
, 
size_t
 
size
) const

362 
__m256
 
	gsum
;

363 
__m256
 
	gl0
, 
	gl1
;

364 
__m256
 
	gr0
, 
	gr1
;

365 
	gD
 = (
size
 + 7) & ~7U;

366 
	gDR
 = 
D
 % 16;

367 
	gDD
 = 
D
 - 
DR
;

368 cÚ¡ *
	gl
 = 
a
;

369 cÚ¡ *
	gr
 = 
b
;

370 cÚ¡ *
	ge_l
 = 
l
 + 
DD
;

371 cÚ¡ *
	ge_r
 = 
r
 + 
DD
;

372 
	guÅack
[8] 
__©Œibu‹__
 ((
®igÃd
 (32))) = {0, 0, 0, 0, 0, 0, 0, 0};

373 
ResuÉTy³
 
	g»t
 = 0.0;

374 
	gsum
 = 
_mm256_lßdu_ps
(
uÅack
);

375 if(
	gDR
)

377 
AVX_L2DOT
(
e_l
, 
e_r
, 
sum
, 
l0
, 
r0
);

380 
	gi
 = 0; i < 
	gDD
; i +ğ16, 
	gl
 +ğ16, 
	gr
 += 16)

382 
AVX_L2DOT
(
l
, 
r
, 
sum
, 
l0
, 
r0
);

383 
AVX_L2DOT
(
l
 + 8, 
r
 + 8, 
sum
, 
l1
, 
r1
);

385 
_mm256_¡Üeu_ps
(
uÅack
, 
sum
);

386 
	g»t
 = 
uÅack
[0] + unpack[1] + unpack[2] + unpack[3] + unpack[4] + unpack[5] + unpack[6] + unpack[7];

387  
	g»t
;

391 
	g‹m¶©e
<
ty³Çme
 
	gT
>

392 
şass
 
	gL2Di¡ªûAVX
: 
public
 
Di¡ªû
<
T
>

394 
public
:

395 
T
 
	tResuÉTy³
;

400 
	#AVX_L2SQR
(
addr1
, 
addr2
, 
de¡
, 
tmp1
, 
tmp2
) \

401 
tmp1
 = 
	`_mm256_lßdu_ps
(
addr1
);\

402 
tmp2
 = 
	`_mm256_lßdu_ps
(
addr2
);\

403 
tmp1
 = 
	`_mm256_sub_ps
Ñmp1, 
tmp2
); \

404 
tmp1
 = 
	`_mm256_mul_ps
(tmp1,mp1); \

405 
de¡
 = 
	`_mm256_add_ps
(de¡, 
tmp1
);

	)

406 
ResuÉTy³
 
com·»
(cÚ¡ 
T
* 
a
, cÚ¡ T* 
b
, 
size_t
 
size
) const

409 
__m256
 
	gsum
;

410 
__m256
 
	gl0
, 
	gl1
;

411 
__m256
 
	gr0
, 
	gr1
;

412 
	gD
 = (
size
 + 7) & ~7U;

413 
	gDR
 = 
D
 % 32;

414 
	gDD
 = 
D
 - 
DR
;

415 cÚ¡ *
	gl
 = 
a
;

416 cÚ¡ *
	gr
 = 
b
;

417 cÚ¡ *
	ge_l
 = 
l
 + 
DD
;

418 cÚ¡ *
	ge_r
 = 
r
 + 
DD
;

419 
	guÅack
[8] 
__©Œibu‹__
 ((
®igÃd
 (32))) = {0, 0, 0, 0, 0, 0, 0, 0};

420 
ResuÉTy³
 
	g»t
 = 0.0;

421 
	gsum
 = 
_mm256_lßdu_ps
(
uÅack
);

422 if(
	gDR
)

424 
AVX_L2SQR
(
e_l
, 
e_r
, 
sum
, 
l0
, 
r0
);

427 
	gi
 = 0; i < 
	gDD
; i +ğ16, 
	gl
 +ğ16, 
	gr
 += 16)

429 
AVX_L2SQR
(
l
, 
r
, 
sum
, 
l0
, 
r0
);

430 
AVX_L2SQR
(
l
 + 8, 
r
 + 8, 
sum
, 
l1
, 
r1
);

432 
_mm256_¡Üeu_ps
(
uÅack
, 
sum
);

433 
	g»t
 = 
uÅack
[0] + unpack[1] + unpack[2] + unpack[3] + unpack[4] + unpack[5] + unpack[6] + unpack[7];

434  
	g»t
;

436 
	#AVX_L2NORM
(
addr
, 
de¡
, 
tmp
) \

437 
tmp
 = 
	`_mm256_lßdu_ps
(
addr
); \

438 
tmp
 = 
	`_mm256_mul_ps
(tmp,mp); \

439 
de¡
 = 
	`_mm256_add_ps
(de¡, 
tmp
);

	)

440 
T
 
nÜm
(cÚ¡ T* 
a
, 
size_t
 
size
) const

442 
__m256
 
	gsum
;

443 
__m256
 
	gl0
, 
	gl1
;

444 
	gD
 = (
size
 + 7) & ~7U;

445 
	gDR
 = 
D
 % 16;

446 
	gDD
 = 
D
 - 
DR
;

447 cÚ¡ *
	gl
 = 
a
;

448 cÚ¡ *
	ge_l
 = 
l
 + 
DD
;

449 
	guÅack
[8] 
__©Œibu‹__
 ((
®igÃd
 (32))) = {0, 0, 0, 0, 0, 0, 0, 0};

450 
ResuÉTy³
 
	g»t
 = 0.0;

451 
	gsum
 = 
_mm256_lßdu_ps
(
uÅack
);

452 if(
	gDR
)

454 
AVX_L2NORM
(
e_l
, 
sum
, 
l0
);

456 
	gi
 = 0; i < 
	gDD
; i +ğ16, 
	gl
 += 16)

458 
AVX_L2NORM
(
l
, 
sum
, 
l0
);

459 
AVX_L2NORM
(
l
 + 8, 
sum
, 
l1
);

461 
_mm256_¡Üeu_ps
(
uÅack
, 
sum
);

462 
	g»t
 = 
uÅack
[0] + unpack[1] + unpack[2] + unpack[3] + unpack[4] + unpack[5] + unpack[6] + unpack[7];

463  
	g»t
;

465 
	#AVX_L2DOT
(
addr1
, 
addr2
, 
de¡
, 
tmp1
, 
tmp2
) \

466 
tmp1
 = 
	`_mm256_lßdu_ps
(
addr1
);\

467 
tmp2
 = 
	`_mm256_lßdu_ps
(
addr2
);\

468 
tmp1
 = 
	`_mm256_mul_ps
Ñmp1, 
tmp2
); \

469 
de¡
 = 
	`_mm256_add_ps
(de¡, 
tmp1
);

	)

470 
T
 
dÙ
(cÚ¡ T* 
a
, cÚ¡ T* 
b
, 
size_t
 
size
) const

472 
__m256
 
	gsum
;

473 
__m256
 
	gl0
, 
	gl1
;

474 
__m256
 
	gr0
, 
	gr1
;

475 
	gD
 = (
size
 + 7) & ~7U;

476 
	gDR
 = 
D
 % 16;

477 
	gDD
 = 
D
 - 
DR
;

478 cÚ¡ *
	gl
 = 
a
;

479 cÚ¡ *
	gr
 = 
b
;

480 cÚ¡ *
	ge_l
 = 
l
 + 
DD
;

481 cÚ¡ *
	ge_r
 = 
r
 + 
DD
;

482 
	guÅack
[8] 
__©Œibu‹__
 ((
®igÃd
 (32))) = {0, 0, 0, 0, 0, 0, 0, 0};

483 
ResuÉTy³
 
	g»t
 = 0.0;

484 
	gsum
 = 
_mm256_lßdu_ps
(
uÅack
);

485 if(
	gDR
)

487 
AVX_L2DOT
(
e_l
, 
e_r
, 
sum
, 
l0
, 
r0
);

490 
	gi
 = 0; i < 
	gDD
; i +ğ16, 
	gl
 +ğ16, 
	gr
 += 16)

492 
AVX_L2DOT
(
l
, 
r
, 
sum
, 
l0
, 
r0
);

493 
AVX_L2DOT
(
l
 + 8, 
r
 + 8, 
sum
, 
l1
, 
r1
);

495 
_mm256_¡Üeu_ps
(
uÅack
, 
sum
);

496 
	g»t
 = 
uÅack
[0] + unpack[1] + unpack[2] + unpack[3] + unpack[4] + unpack[5] + unpack[6] + unpack[7];

497  
	g»t
;

	@evaluator.h

1 #iâdeà
EVALUATOR_H


2 
	#EVALUATOR_H


	)

4 
	~<veùÜ
>

5 
	~<m­
>

6 
	~<£t
>

8 
usšg
 
Çme¥aû
 
	g¡d
;

17 şas 
	cEv®u©Ü


19 
	mpublic
:

20 
	$Ev®u©Ü
(){}

21 
vœtu®
 ~
	$Ev®u©Ü
(){
	}
}

24 
lßdClu¡
(cÚ¡ *
¤cFn
, 
m­
<, 
£t
<> *> &
şu¡s
);

25 
’Œİy
(
m­
<, 
£t
<> *> &
şu¡s
, m­<, s‘<> *> &
grdT¹h
);

26 
pur™y
(
m­
<, 
£t
<> *> &
şu¡s
, m­<, s‘<> *> &
grdT¹h
);

27 
’Œİy
(
£t
<> &
şu¡
, 
m­
<, s‘<> *> &
grdT¹h
);

28 
pur™y
(
£t
<> &
şu¡
, 
m­
<, s‘<> *> &
grdT¹h
);

29 
’Œİy
(cÚ¡ *
¤cFn
, cÚ¡ *
grdFn
);

30 
pur™y
(cÚ¡ *
¤cFn
, cÚ¡ *
grdFn
);

31 
š‹rSeù
(cÚ¡ 
£t
<> &
s1
, cÚ¡ s‘<> &
£t2
);

32 
funScÜe
(cÚ¡ *
şu¡Fn
, cÚ¡ *
d©Fn
, cÚ¡ *
fun
);

33 
g‘SEP
(cÚ¡ *
şu¡Fn
, cÚ¡ *
grdFn
, cÚ¡ *
d©Fn
, &
scÜe
, &
e
, &
p
, cÚ¡ *
fun
);

34 
jacÿrd
(
m­
<, 
£t
<> *> &
şu¡s
, m­<, s‘<> *> &
grdTrh
, cÚ¡ *
â
);

35 
jacÿrd
(cÚ¡ *
£tâ
, cÚ¡ * 
grdâ
, cÚ¡ *
d¡â
);

36 
di¡ÜtiÚ
(cÚ¡ * 
¤câ
, cÚ¡ * 
şu¡”â
);

45 
NN»ÿÎ
(*
kLi¡
,
row
,
dim
,
k
,cÚ¡ *
grdD¡
);

48 
‹¡
();

	@ioagent.h

1 #iâdeà
IOAGENT_H


2 
	#IOAGENT_H


	)

4 
	~"¥¬£m©rix.h
"

6 
	~<¡ršg
>

7 
	~<veùÜ
>

8 
	~<m­
>

9 
	~<£t
>

11 
usšg
 
	g¡d
::
£t
;

12 
usšg
 
	g¡d
::
m­
;

13 
usšg
 
	g¡d
::
veùÜ
;

14 
usšg
 
	g¡d
::
¡ršg
;

16 şas 
	cIOAg’t


18 
	mpublic
:

19 
	$IOAg’t
() {}

20 
vœtu®
 ~
	$IOAg’t
(è{
	}
}

21 *
lßd_fvecs
(cÚ¡ *
fvecâ
, &
r
, &
d
);

22 *
lßd_fvecs
(
veùÜ
<
¡ršg
> &
f’ames
, &
r
, &
d
);

23 *
lßd_bvecs
(cÚ¡ *
bvecâ
, &
r
, &
d
);

24 *
lßd_bvecs
(cÚ¡ *
bvecâ
, &
r
, &
d
, 
row
);

26 *
lßdKNNG
(cÚ¡ *
¤cFn
, &
row
, &
dim
);

27 *
lßdKNNG1
(cÚ¡ *
¤cFn
, &
row
, &
dim
);

28 
m”gKNNG
(cÚ¡ *
kÂgFn1
, cÚ¡ *
kÂgFn2
, cÚ¡ *
d¡KÂg
);

30 *
lßdM©rix
(cÚ¡ *
â
, &
row
, &
cŞ
);

31 *
lßdM©rix
(
veùÜ
<
¡ršg
> &
f’ames
, &
row
, &
cŞ
);

32 *
lßdIM©
(cÚ¡ *
¤câ
, &
row
, &
cŞ
);

33 *
lßdD©
(cÚ¡ *
¤câ
, &
row
, &
cŞ
);

34 *
lßdD©
(
veùÜ
<
¡ršg
> &
f’ames
, &
row
, &
cŞ
);

35 *
lßdPQ
(cÚ¡ *
¤câ
, &
row
, &
cŞ
);

36 * 
lßdPQInfo
(cÚ¡ *
¤câ
, &
pqn
, &
pql
, &
pqm
);

37 *
lßdNN
(cÚ¡ *
Ââ
, &
row
, &
cŞ
);

39 *
lßdgroundŒuth
(cÚ¡ *
gtd¡
,&
row
,&
dim
);

41 *
lßdItms
(cÚ¡ *
â
, cÚ¡ *
idxKey
, &
row
, &
cŞ
);

42 *
lßdItms
(cÚ¡ *
â
, cÚ¡ *
idxKey
, cÚ¡ 
lše
, &
row
, &
cŞ
);

43 
S·r£M©rix
 
lßdBOVW
(cÚ¡ *
â
, &
row
, &
cŞ
);

44 
S·r£M©rix
 
lßdS·r£
(cÚ¡ *
â
, &
row
, &
cŞ
);

46 
g‘M©rixInfo
(cÚ¡ *
m©â
, &
cŞ
, &
row
);

48 
§veD©
(cÚ¡ *
â
, cÚ¡ &
row
, cÚ¡ &
cŞ
,*
D©
);

49 
§veD©
(cÚ¡ * 
â
, cÚ¡ & 
row
, cÚ¡ &
cŞ
, *
D©
);

50 
§veS·r£
(cÚ¡ * 
â
, cÚ¡ & 
row
, cÚ¡ &
cŞ
, cÚ¡ 
S·r£M©rix
 &
sd©a
);

51 *
lßdTruncM©
(cÚ¡ *
¤cFn
, &
row
, &
dim
, 
veùÜ
<> &
ids
);

52 
§veTruncM©
(cÚ¡ *
d¡Fn
, cÚ¡ 
dim
, *
m©
, 
£t
<> &
ids
);

53 
boŞ
 
»adFeName
(cÚ¡ * 
¤cdœ
, 
veùÜ
<
¡ršg
 >& 
f’ame
);

54 
§veEx
(
veùÜ
<
¡ršg
> &
f’ames
, *
e
, *
p
, cÚ¡ *
»suÉ
);

55 
addR¦t
(cÚ¡ *
f’ame
, *
e
, *
p
, cÚ¡ *
»suÉ
);

56 
§veAsFuÎM©
(cÚ¡ *
d©
, &
row
, &
cŞ
, cÚ¡ *
fe
);

57 
§vekÂG¿ph
(cÚ¡ *
kÂG¿ph
, 
row
, 
dim
,

58 
m­
<, > &
idM­
, cÚ¡ *
d¡Fn
);

60 
lßdClu¡
(cÚ¡ *
â
, 
m­
<, 
£t
<> *> &
şu¡”
);

62 
lßdmClu¡
(cÚ¡ *
¤cFn
, 
m­
<, 
£t
<> *> &
şu¡s
);

63 
§veClu¡
(cÚ¡ * 
â
, 
m­
<, 
£t
<> *>&
şu¡”
);

65 
‹¡
();

	@missionagent.h

1 #iâdeà
MISSIONAGENT_H


2 
	#MISSIONAGENT_H


	)

14 
	~<c¡ršg
>

15 
	~<¡ršg
>

16 
	~<m­
>

18 
usšg
 
Çme¥aû
 
	g¡d
;

20 şas 
	cMissiÚAg’t


22 
	mpublic
:

23 
	$MissiÚAg’t
(){}

24 
vœtu®
 ~
	$MissiÚAg’t
(){
	}
}

25 
boŞ
 
budClu¡
(
m­
<
¡ršg
, cÚ¡ *> &
¬gum’ts
);

26 
boŞ
 
budKNNG
(
m­
<
¡ršg
, cÚ¡ *> &
¬gum’ts
);

	@nn.h

1 #iâdeà
NN_H


2 
	#NN_H


	)

4 
šlše
 
In£¹IÁoKÂ
(
veùÜ
<
·œ
<, > > &
tİm­
, 
L
, 
id
, 
di¡
, &
¿dius
)

6 if(
	gtİm­
.
size
(è< 
	gL
 && 
	gdi¡
 > 
	g¿dius
)

8 
	gtİm­
.
push_back
(
·œ
<, >(
di¡
, 
id
));

9 
	g¿dius
 = 
di¡
;

12 if(
	gdi¡
 > 
	g¿dius
)

18 
	gj
;

19 
	gK
 = 
tİm­
.
size
()-1;

21 
	gi
 = 
K
;

22 
	gi
 > 0)

24 
	gj
 = 
i
 - 1;

25 ià(
	gtİm­
[
j
].
	gfœ¡
 <ğ
di¡
) ;

26 
	gi
 = 
j
;

29 
	gl
 = 
i
 + 1;

30 
	gl
 > 0)

32 
	gj
 = 
l
 - 1;

33 ià(
	gtİm­
[
j
].
	gfœ¡
 < 
	gdi¡
) ;

34 ià(
	gtİm­
[
j
].
	g£cÚd
 =ğ
id
è 
K
 + 1;

35 
	gl
 = 
j
;

38 if(
	gtİm­
.
size
(è< 
	gL
)

40 
	gtİm­
.
push_back
(
·œ
<, >(
tİm­
[
K
].
fœ¡
,İm­[K].
£cÚd
));

43 
	gj
 = 
K
;

44 
	gj
 > 
	gi
)

46 
	gtİm­
[
j
].
	gfœ¡
 = 
tİm­
[j-1].
fœ¡
;

47 
	gtİm­
[
j
].
	g£cÚd
 = 
tİm­
[j-1].
£cÚd
;

48 --
	gj
;

50 
	gtİm­
[
i
].
	gfœ¡
 = 
di¡
;

51 
	gtİm­
[
i
].
	g£cÚd
 = 
id
;

52 
	g¿dius
 = 
tİm­
[tİm­.
size
()-1].
fœ¡
;

56 
šlše
 
In£¹IÁoKÂ
 (
veùÜ
<> &
tİm­
, 
id
)

59 
	gi
, 
	gj
;

60 
	gK
 = 
tİm­
.
size
() - 1;

61 
	gl
;

63 if(
	gtİm­
.
size
(è=ğ0 || 
tİm­
[
K
] < 
id
)

65 
tİm­
.
push_back
(
id
);

68 if(
	gtİm­
[
K
] =ğ
id
)

71 
	gi
 = 
K
;

73 
	gi
 > 0)

75 
	gj
 = 
i
 - 1;

76 if(
	gtİm­
[
j
] <ğ
id
) ;

77 
	gi
 = 
j
;

81 
	gl
 = 
i
;

82 
	gl
 > 0)

84 
	gj
 = 
l
 - 1;

85 if(
	gtİm­
[
j
] =ğ
id
)  1;

86 
	gl
 = 
j
;

89 
	gtİm­
.
push_back
(
tİm­
[
K
]);

91 
	gj
 = 
K
;

92 
	gj
 > 
	gi
)

94 
	gtİm­
[
j
] = 
tİm­
[j-1];

95 --
	gj
;

97 
	gtİm­
[
i
] = 
id
;

102 
šlše
 
In£¹IÁoKÂ
 (
veùÜ
<
·œ
<, > > &
tİm­
, 
id
, 
di¡
, &
¿dius
)

105 
	gj
;

106 
	gK
 = 
tİm­
.
size
()-1;

108 
	gi
 = 
K
;

109 
	gi
 > 0)

111 
	gj
 = 
i
 - 1;

112 ià(
	gtİm­
[
j
].
	gfœ¡
 <ğ
di¡
) ;

113 
	gi
 = 
j
;

116 
	gl
 = 
i
;

117 
	gl
 > 0)

119 
	gj
 = 
l
 - 1;

120 ià(
	gtİm­
[
j
].
	gfœ¡
 < 
	gdi¡
) ;

121 ià(
	gtİm­
[
j
].
	g£cÚd
 =ğ
id
è 
K
 + 1;

122 
	gl
 = 
j
;

126 
	gj
 = 
K
;

127 
	gj
 > 
	gi
)

129 
	gtİm­
[
j
].
	gfœ¡
 = 
tİm­
[j-1].
fœ¡
;

130 
	gtİm­
[
j
].
	g£cÚd
 = 
tİm­
[j-1].
£cÚd
;

131 --
	gj
;

133 
	gtİm­
[
i
].
	gfœ¡
 = 
di¡
;

134 
	gtİm­
[
i
].
	g£cÚd
 = 
id
;

135 
	g¿dius
 = 
tİm­
[
K
].
fœ¡
;

140 
šlše
 
	$In£¹IÁoKÂ
 (*
NNG
, *
tİ
, 
tİK
, 
di¡
, 
id
, &
¿dius
)

143 
j
 = 0;

144 
K
 = 
tİK
;

145 
i
 = 
K
;

147 
i
 > 0)

149 
j
 = 
i
 - 1;

150 ià(
NNG
[
j
] =ğ
id
è 
K
 + 1;

151 
i
 = 
j
;

154 
i
 = 
tİK
;

155 
i
 > 0)

157 
j
 = 
i
 - 1;

158 ià(
tİ
[
j
] =ğ
¿dius
) ;

159 
i
 = 
j
;

163 
tİ
[
j
] = 
di¡
;

164 
NNG
[
j
] = 
id
;

166 
i
 = 
K
;

167 
¿dius
 = 0;

168 
i
 > 0)

170 
j
 = 
i
 - 1;

171 ià(
tİ
[
j
] > 
¿dius
)

172 
¿dius
 = 
tİ
[
j
];

173 
i
 = 
j
;

175  
i
;

176 
	}
}

179 
šlše
 
	$In£¹IÁoKÂ
 (*
NNG
, *
tİDi¡
, 
tİK
, 
id
, 
di¡
, &
¿dius
)

182 
j
;

183 
K
 = 
tİK
-1;

184 
i
 = 
K
;

185 
i
 > 0)

187 
j
 = 
i
 - 1;

188 ià(
tİDi¡
[
j
] <ğ
di¡
) ;

189 
i
 = 
j
;

192 
l
 = 
i
;

193 
l
 > 0)

195 
j
 = 
l
 - 1;

196 ià(
tİDi¡
[
j
] < 
di¡
) ;

197 ià(
NNG
[
j
] =ğ
id
è 
K
 + 1;

198 
l
 = 
j
;

201 
j
 = 
K
;

202 
j
 > 
i
)

204 
tİDi¡
[
j
] =opDist[j-1];

205 
NNG
[
j
] = NNG[j-1];

206 --
j
;

208 
tİDi¡
[
i
] = 
di¡
;

209 
NNG
[
i
] = 
id
;

210 
¿dius
 = 
tİDi¡
[
K
-1];

211  
i
;

212 
	}
}

214 şas 
	cNN


216 
	mk
;

217 *
	md©a
;

218 
	mrow
;

219 
	mcŞ
;

220 *
	mtİLi¡
;

221 
	m»ÿÎ
;

223 
	mpublic
:

224 
NN
();

225 
	mvœtu®
 ~
NN
();

226 
vœtu®
 
š™
() = 0;

227 
vœtu®
 
budNN
(cÚ¡ *
¤câ
, cÚ¡ *
d¡â
, &
tİk
) = 0;

228 
vœtu®
 
budNN
(*, &
row
, &
cŞ
, &
tİk
) = 0;

234 
boŞ
 
§veNN
(cÚ¡ *
d¡â
);

235 
g‘ReÿÎ
(cÚ¡ *
grdâ
);

238 
g‘ReÿÎ
(cÚ¡ *
grdâ
, cÚ¡ *
Ââ
, 
tİk
);

239 
g‘TİLi¡
(*
tİLi¡
);

240 
‹¡
();

	@nngkmeans.h

10 #iâdeà
NNGKM—ns_H


11 
	#NNGKM—ns_H


	)

13 
	~"ab¡¿ùkm—ns.h
"

14 
	~<£t
>

15 
	~<unÜd”ed_£t
>

17 
	~"ev®u©Ü.h
"

19 şas 
	cNNGKM—ns
: 
public
 
Ab¡¿ùKM—ns


21 cÚ¡ 
NBI‹r
, 
	mT»eNum
;

22 cÚ¡ 
	mNI‹r
;

23 cÚ¡ 
	mRªgeFœ¡
;

24 cÚ¡ 
	mRªgeSecÚd
;

25 cÚ¡ 
	mE¼0
;

27 
boŞ
 
	moutNN
 = 
çl£
;

29 
	mlÚgloc
;

31 *
	mEs
, *
	m¬¿yD
;

32 *
	mNs
;

33 *
	mDs
;

34 *
	mtİLi¡
;

36 *
	mrkNNNum
 = 
NULL
;

37 **
	mrkNNG¿ph
 = 
NULL
;

38 *
	mdi¡li¡
 = (*)
ÿÎoc
(40,());

40 *
	mtİDi¡
;

42 
	munÜd”ed_£t
<> *
	mvis™Li¡
;

43 
	mveùÜ
<> 
	midx2ids
;

45 *
	m¿dius
;

46 *
	m´Upd©ed
, *
	müUpd©ed
;

48 cÚ¡ 
	mT»esize
;

49 cÚ¡ 
	mTİK
;

50 cÚ¡ 
	mNNTİ
;

52 
adju¡NN
();

53 
İtzI2
(
boŞ
 
v”bo£
, cÚ¡ 
NNTİ
, cÚ¡ 
n™”0
);

54 
NewO±zI2
(
boŞ
 
v”bo£
, cÚ¡ 
NNTİ
, cÚ¡ 
n™”0
);

55 
š™NNG¿ph
();

56 
budNNG¿phBy2Mn
(
v”bo£
);

57 
upd©eNNG¿ph
();

58 
budNNG¿ph4şu¡
();

60 
	mpublic
 :

62 *
»s
;

63 
	mnum
;

64 
	mtm±ime
;

65 *
	mtmLogs
;

66 *
	md¡Logs
;

67 
	mnLogs
;

69 
NNGKM—ns
();

70 
	mvœtu®
 ~
NNGKM—ns
();

71 
ä“O³¿tiÚ
();

72 
boŞ
 
š™
(cÚ¡ *
¤câ
);

73 
boŞ
 
š™
(*
m©
, cÚ¡ 
row
, cÚ¡ 
dim
);

74 
boŞ
 
š™
(*
m©
, cÚ¡ 
row
, cÚ¡ 
dim
);

75 
boŞ
 
£tLogOn
(cÚ¡ 
logSize
);

77 
»ÿÎ
();

78 
NNI2
(
boŞ
 
v”bo£
, cÚ¡ 
n™”0
);

79 
budClu¡”
(* 
NN
, * 
d©a
, 
row
, 
ndim
, 
şu¡numb
);

80 
budClu¡”
(cÚ¡ *
¤câ
, cÚ¡ *
Ââ
, cÚ¡ *
d¡â
, 
şu¡numb
);

82 
cİy2TİLi¡
(*
tİ
);

83 
cİyFromTİLi¡
(*
tİ
, 
tİNum
);

84 
boŞ
 
cÚfig
(cÚ¡ *
_£ed_
, cÚ¡ *
lg_fœ¡
, cÚ¡ *
üŒn
, 
v”bo£
);

85 
l2
(cÚ¡ 
i
, cÚ¡ 
j
);

87 
şu¡
(cÚ¡ 
şu¡_num
, cÚ¡ *
d¡â
, cÚ¡ 
v”bo£
);

89 
budKNNG¿ph
(cÚ¡ *
¤câ
, cÚ¡ *
d¡â
, cÚ¡ 
dpg
);

90 
div”sify_by_cut
(*
kNNG¿ph
, cÚ¡ 
N
, cÚ¡ 
K
, cÚ¡ 
edge_num
);

91 
augRvsKNN
(*
kNNG¿ph
, 
N
, 
D
,
L
);

94 
boŞ
 
ºdS“ds
(cÚ¡ 
k
, 
r£eds
[], cÚ¡ 
bound
);

95 
boŞ
 
kµS“ds
(cÚ¡ 
k
, 
r£eds
[], cÚ¡ 
bound
);

97 
§veC’‹rs
(cÚ¡ *
d¡â
, 
boŞ
 
­³nd
);

98 
§veKNNG¿ph
(cÚ¡ *
d¡â
, 
k0
);

99 *
lßdKNNG¿ph
(cÚ¡ *
¤câ
);

100 
§veKNNG¿ph
(cÚ¡ *
d¡â
, cÚ¡ 
n
, cÚ¡ 
k0
, 
veùÜ
<> &
ids
);

101 
§veKNNG¿phDPG
(cÚ¡ *
d¡â
, 
k0
);

102 
§veKNNG¿phDPG
(cÚ¡ *
d¡â
, cÚ¡ 
N
, cÚ¡ 
D
,

103 **
kÂG¿ph
, *
kÂNumb
);

104 
ãtchC’‹rs
(*
ûÁ”s
);

106 
§veKG¿ph
(cÚ¡ *
d¡â
,
k
);

107 
§veLogs
(cÚ¡ *
d¡Fn
);

109 
‹¡
();

110 
CH‹¡
();

111 
YJ‹¡
();

112 
WL‹¡
();

113 
PC‹¡
();

	@nnitem.h

1 #iâdeà
NNITEM_H


2 
	#NNITEM_H


	)

4 
	~<®gÜ™hm
>

5 
	~<veùÜ
>

6 
	~<li¡
>

7 
	~<m­
>

9 
usšg
 
Çme¥aû
 
	g¡d
;

11 
	sV®Id


13 
	mpublic
 :

14 
idx
;

15 
	mv®
;

16 
LLcom·»r
(cÚ¡ 
V®Id
 &
a
, cÚ¡ V®Id &
b
)

18  (
	ma
.
	mv®
 < 
	mb
.val);

20 
LGcom·»r
(cÚ¡ 
V®Id
 &
a
, cÚ¡ V®Id &
b
)

22  (
	ma
.
	mv®
 > 
	mb
.val);

26 
	sMšiNN


28 
	mpublic
:

29 
idx
;

30 
	mv®
;

33 
LLcom·»r
(cÚ¡ 
MšiNN
 *
a
, cÚ¡ MšiNN *
b
)

35  (
	ma
->
	mv®
 < 
	mb
->val);

41 
LGcom·»r
(cÚ¡ 
MšiNN
 *
a
, cÚ¡ MšiNN *
b
)

43  (
	ma
->
	mv®
 > 
	mb
->val);

49 şas 
	cNNI‹m


51 
	mpublic
:

52 
	$NNI‹m
(cÚ¡ 
šdex
, cÚ¡ 
di¡
)

54 
this
->
šdex
 = index;

55 
this
->
v®
 = 
di¡
;

56 
this
->
size
 = 0;

57 
this
->
dvd
 = 
Œue
;

59 
	$NNI‹m
(cÚ¡ 
šdex
, cÚ¡ 
di¡
, cÚ¡ 
sz
)

61 
this
->
šdex
 = index;

62 
this
->
v®
 = 
di¡
;

63 
this
->
size
 = 
sz
;

64 
this
->
dvd
 = 
Œue
;

65 
	}
}

66 
	gšdex
;

67 
	gv®
;

68 
	gsize
;

69 
boŞ
 
	gdvd
;

72 
	$LLcom·»r
(cÚ¡ 
NNI‹m
 *
a
,cÚ¡ NNI‹m *
b
)

74  (
a
->
v®
 < 
b
->val);

75 
	}
}

78 
	$LGcom·»r
(cÚ¡ 
NNI‹m
 *
a
, cÚ¡ NNI‹m *
b
)

80  (
a
->
v®
 > 
b
->val);

81 
	}
}

84 
	$LLIDXcom·»r
(cÚ¡ 
NNI‹m
 *
a
, cÚ¡ NNI‹m *
b
)

87  (
a
->
šdex
 < 
b
->index);

88 
	}
}

91 
	$LLVALcom·»r
(cÚ¡ 
NNI‹m
 *
a
, cÚ¡ NNI‹m *
b
)

93 if((
a
->
dvd
 =ğ
çl£
è&& (
b
->dvd == false))

95  
çl£
;

97 if((
a
->
dvd
 =ğ
çl£
è&& 
b
->dvd)

99  
çl£
;

101 if(
a
->
dvd
 && (
b
->dvd =ğ
çl£
))

103  
Œue
;

107 if(
a
->
v®
 < 
b
->val)

109  
Œue
;

111 if(
a
->
v®
 =ğ
b
->val)

113 if(
a
->
size
 > 
b
->size)

115  
Œue
;

119  
çl£
;

124  
çl£
;

127 
	}
}

130 
	$LGVALcom·»r
(cÚ¡ 
NNI‹m
 *
a
, cÚ¡ NNI‹m *
b
)

132 if((
a
->
dvd
 =ğ
çl£
è&& (
b
->dvd == false))

134  
Œue
;

136 if((
a
->
dvd
 =ğ
çl£
è&& 
b
->dvd)

138  
çl£
;

140 if(
a
->
dvd
 && (
b
->dvd =ğ
çl£
))

142  
Œue
;

146 if(
a
->
v®
 > 
b
->val)

148  
Œue
;

150 if(
a
->
v®
 =ğ
b
->val)

152 if(
a
->
size
 > 
b
->size)

154  
Œue
;

158  
çl£
;

163  
çl£
;

166 
	}
}

169 
	$LGSZcom·»r
(cÚ¡ 
NNI‹m
 *
a
, cÚ¡ NNI‹m *
b
)

171 if((
a
->
dvd
 =ğ
çl£
è&& (
b
->dvd == false))

173  
Œue
;

175 if((
a
->
dvd
 =ğ
çl£
è&& 
b
->dvd)

177  
çl£
;

179 if(
a
->
dvd
 && (
b
->dvd =ğ
çl£
))

181  
Œue
;

185 if(
a
->
size
 > 
b
->size)

187  
Œue
;

189 if(
a
->
size
 =ğ
b
->size)

191 if(
a
->
v®
 > 
b
->val)

193  
Œue
;

197  
çl£
;

202  
çl£
;

205 
	}
}

	@pqmath.h

1 #iâdeà
PQMATH_H


2 
	#PQMATH_H


	)

15 
	~"¥¬£m©rix.h
"

16 
	~<£t
>

18 
usšg
 
Çme¥aû
 
	g¡d
;

20 şas 
	cPQM©h


22 
	m´iv©e
:

23 cÚ¡ 
sm®lV®0
;

24 
	mpublic
:

25 
cos
(cÚ¡ 
v1
[], cÚ¡ 
s1
,

26 cÚ¡ 
v2
[], cÚ¡ 
s2
, cÚ¡ 
d0
);

28 
l2f
(cÚ¡ 
v1
[], cÚ¡ 
s1
,

29 cÚ¡ 
v2
[], cÚ¡ 
s2
,

30 cÚ¡ 
dim0
);

31 
l2f
(cÚ¡ 
S·r£M©rix
 &
v1
, cÚ¡ 
s1
,

32 cÚ¡ 
S·r£M©rix
 &
v2
, cÚ¡ 
s2
,

33 cÚ¡ 
dim0
);

34 
l2d
(cÚ¡ 
v1
[], cÚ¡ 
s1
,

35 cÚ¡ 
v2
[], cÚ¡ 
s2
,

36 cÚ¡ 
dim0
);

37 
l2d
(cÚ¡ 
v1
[], cÚ¡ 
s1
,

38 cÚ¡ 
v2
[], cÚ¡ 
s2
,

39 cÚ¡ 
dim0
);

41 
l2d
(cÚ¡ 
v1
[], cÚ¡ 
s1
,

42 cÚ¡ 
S·r£M©rix
 &
b
, cÚ¡ 
s2
,

43 cÚ¡ 
dim0
);

44 
g‘I2
(cÚ¡ *
Ds
, cÚ¡ 
k
, cÚ¡ 
dim
, cÚ¡ *
tm²s
);

45 
g‘E2
(cÚ¡ *
Ds
, cÚ¡ 
k
, cÚ¡ 
dim
, cÚ¡ *
tm²s
);

46 
g‘I1
(cÚ¡ *
Ds
, cÚ¡ 
k
, cÚ¡ 
dim
, cÚ¡ *
tm²s
);

47 
g‘E1
(cÚ¡ *
Ds
, cÚ¡ 
k
, cÚ¡ 
dim
, cÚ¡ *
tm²s
);

49 
boŞ
 
l2_nÜm
(*
veù1
, cÚ¡ 
dim
);

50 
boŞ
 
l2_nÜm
(*
veù1
, cÚ¡ 
dim
);

51 
boŞ
 
is_l2NÜm
(cÚ¡ *
veù1
, cÚ¡ 
dim
);

52 
fvec_nÜm
(cÚ¡ *
v
, cÚ¡ 
n
, cÚ¡ 
nÜm
);

53 
dvec_nÜm
(cÚ¡ *
v
, cÚ¡ 
n
, cÚ¡ 
nÜm
);

54 
boŞ
 
¿ndS“ds
(cÚ¡ 
bound
, 
£t
<> &
£eds
, cÚ¡ 
numb
);

56 
šÃrProduù
(cÚ¡ *
v1
, cÚ¡ *
v2
, cÚ¡ 
n
);

57 
šÃrProduù
(cÚ¡ 
S·r£M©rix
 &
v1
,
s1
, cÚ¡ S·r£M©rix &
v2
, 
s2
);

59 
nÜmVeùs
(*
veùs
, cÚ¡ 
d0
,

60 cÚ¡ 
n0
, *
Ëns
);

61 
nÜmVeùs
(*
veùs
, cÚ¡ 
d0
,

62 cÚ¡ 
n0
);

63 
sq¹_SIFT
(*
veùs
, cÚ¡ 
d0
, cÚ¡ 
numb
);

64 
boŞ
 
isZ”os
(cÚ¡ *
ã©
, cÚ¡ 
dim
);

65 
sign
(cÚ¡ 
v®
);

66 
pow”Law
(*
veù
, cÚ¡ 
®pha
, cÚ¡ 
d0
);

68 
boŞ
 
fvec_sÿË
(*
v
, cÚ¡ 
n
, cÚ¡ 
sc
);

69 
boŞ
 
dvec_sÿË
(*
v
, cÚ¡ 
n
, cÚ¡ 
sc
);

71 
	mpublic
:

72 
	$PQM©h
() {}

73 
vœtu®
 ~
	$PQM©h
(è{
	}
}

	@print2scrn.h

1 #iâdeà
PRINT2SCRN_H


2 
	#PRINT2SCRN_H


	)

4 
	~"şsšfo.h
"

5 
	~"Â™em.h
"

7 
	~<veùÜ
>

9 
usšg
 
Çme¥aû
 
	g¡d
;

11 şas 
	cPršt2Sün


13 
	mpublic
:

14 
	$Pršt2Sün
() {}

15 
vœtu®
 ~
	$Pršt2Sün
(è{
	}
}

17 
´štveù
(
veùÜ
<
NNI‹m
*> &
veùs
);

18 
´štveù
(
veùÜ
<
NNI‹m
*> &
veùs
, cÚ¡ *
d¡_šfo_â
);

19 
´štveù
(*
v
, cÚ¡ 
n
);

20 
´štCLInfo
(cÚ¡ 
CLSInfo
 *
šfo
, cÚ¡ 
n
);

21 
´štCLInfo
(cÚ¡ 
CLSInfo
 *
šfo
, cÚ¡ 
n
, cÚ¡ *
d¡â
);

	@randompartition.h

12 #iâdeà
RANDOMPARTITION_H


13 
	#RANDOMPARTITION_H


	)

15 
	~"ab¡¿ùkm—ns.h
"

16 
	~"di¡ªû.hµ
"

17 
	~"Â™em.h
"

19 
	~<£t
>

20 
	~<m­
>

21 
	~<unÜd”ed_£t
>

23 şas 
	cRªdomP¬t™iÚ
: 
public
 
Ab¡¿ùKM—ns


25 cÚ¡ 
DISTANCE
::
Di¡ªû
<>* 
di¡ªû
;

26 cÚ¡ 
	mNTRAILS
;

27 cÚ¡ 
	mNI‹r
;

28 cÚ¡ 
	mE¼0
;

29 *
	mD1
, *
	mD2
, *
	mC1
, *
	mC2
, *
	mtmpC1
, *
	mtmpC2
;

30 *
	m¬¿yD
;

31 *
	mNs
;

33 
	mveùÜ
<> *
	mşu¡”s
;

35 
	mpublic
 :

36 
RªdomP¬t™iÚ
();

37 
RªdomP¬t™iÚ
(cÚ¡ 
DISTANCE
::
Di¡ªû
<>* );

38 
	mvœtu®
 ~
RªdomP¬t™iÚ
();

39 
boŞ
 
š™
(cÚ¡ *
¤câ
);

40 
boŞ
 
š™
(*
m©
, cÚ¡ 
row
, cÚ¡ 
dim
);

41 
boŞ
 
š™
(*
m©
, cÚ¡ 
row
, cÚ¡ 
dim
);

43 
gkm—nI‹r
(
Ïb–
, 
Æab–
);

44 
¿ndP¬t™iÚ
(
Ïb–
, 
Æab–
);

45 
KDT»e
(
Ïb–
, 
Æab–
);

47 
¿ndom
(
Ïb–
, 
Æab–
);

48 
boŞ
 
cÚfig
(cÚ¡ *
_£ed_
, cÚ¡ *
lg_fœ¡
, cÚ¡ *
üŒn
, 
v”bo£
);

50 
şu¡
(cÚ¡ 
şu¡_num
, cÚ¡ *
d¡â
, cÚ¡ 
v”bo£
);

51 
boŞ
 
ºdS“ds
(cÚ¡ 
k
, 
r£eds
[], cÚ¡ 
bound
);

52 
boŞ
 
kµS“ds
(cÚ¡ 
k
, 
r£eds
[], cÚ¡ 
bound
);

53 
§veC’‹rs
(cÚ¡ *
d¡â
, 
boŞ
 
­³nd
);

54 
ãtchC’‹rs
(*
ûÁ”s
);

56 
‹¡
();

	@scriptparser.h

1 #iâdeà
SCRIPTPARSER_H


2 
	#SCRIPTPARSER_H


	)

4 
	~<¡ršg
>

5 
	~<veùÜ
>

6 
	~<li¡
>

7 
	~<m­
>

9 
usšg
 
Çme¥aû
 
	g¡d
;

22 şas 
	cSütP¬£r


25 
	mpublic
:

26 cÚ¡ 
STRLEN
 = 512;

27 
	$SütP¬£r
(){}

29 
m­
<
¡ršg
, cÚ¡ *> 
	`g‘CÚf
(cÚ¡ *
â
);

30 
veùÜ
<cÚ¡ *> 
	`g‘Nam–¡
(cÚ¡ *
âame
);

31 
m­
<, m­<
¡ršg
,cÚ¡ *>* > 
	`g‘ItmM­s
(cÚ¡ *
â
);

33 
	`g‘SŒPaœs
(cÚ¡ * 
¤câ
, 
veùÜ
<cÚ¡ *> &
¡¾¡1
,

34 
veùÜ
<cÚ¡ *> &
¡¾¡2
);

36 
	`ş—rP¬aM­
(
m­
<
¡ršg
, cÚ¡ *> &
·¿s
);

37 
	`ş—rItmM­s
(
m­
<, m­<
¡ršg
, cÚ¡ *>* > &
™mM­s
);

38 
boŞ
 
	`v”ifyP¬aM­
(cÚ¡ *
İtiÚs
[], cÚ¡ 
num
,

39 
m­
<
¡ršg
, cÚ¡ *> &
·¿s
);

41 
vœtu®
 ~
	$SütP¬£r
(){
	}
}

42 
‹¡
();

	@sparsematrix.h

1 #iâdeà
SPARSEMATRIX_H


2 
	#SPARSEMATRIX_H


	)

4 
	sS·r£M©rix


6 *
	md©a
;

7 *
	mcŞ
;

8 *
	mšdex
;

	@timer.h

1 #iâdeà
TIMER_H


2 
	#TIMER_H


	)

4 
	~<ùime
>

6 şas 
	cTim”


8 
	mpublic
:

9 
Tim”
();

10 
¡¬t
();

11 
tm
 *
’d
();

12 
’d
(
boŞ
 
TXT_OUT
);

13 
’d
(cÚ¡ *
msg
, cÚ¡ *
d¡Fn
);

15 
‹¡
();

16 
	mvœtu®
 ~
Tim”
();

17 
	m´iv©e
:

18 
boŞ
 
¡¬‹d
;

19 
time_t
 
	m¡¬t_t
, 
	m’d_t
;

	@vstring.h

1 #iâdeà
VSTRING_H


2 
	#VSTRING_H


	)

4 
	~<io¡»am
>

5 
	~<¡ršg
>

6 
	~<veùÜ
>

7 
	~<li¡
>

8 
	~<£t
>

10 
usšg
 
Çme¥aû
 
	g¡d
;

12 şas 
	cVSŒšg


14 
	m´iv©e
:

15 
subbtw
(
de¡
[], cÚ¡ 
¤c
[],

16 cÚ¡ 
¡¬t
, cÚ¡ 
’d
);

17 
»¶a£
(
¤c
[], cÚ¡ 
ch
, cÚ¡ 
nwch
);

19 
	mpublic
:

20 
VSŒšg
();

21 
¥l™by
(cÚ¡ *
lše
, cÚ¡ 
¥l™”
, 
veùÜ
<
¡ršg
> &
wÜds
);

22 
·r£Paœ
(cÚ¡ 
¤c_¡r
[], 
¡ršg
 &
f¡_¡r
,

23 
¡ršg
 &
£cd_¡r
, cÚ¡ 
¥l™‹r
);

25 
boŞ
 
¡¬tW™h
(cÚ¡ *
¡r
, cÚ¡ *
±Š
);

26 
boŞ
 
’dW™h
(cÚ¡ 
¡r
[], cÚ¡ 
’d
[]);

27 
ŒimEnd
(*
lše
, cÚ¡ 
ch
);

28 
ŒimH—d
(*
lše
, cÚ¡ 
ch
);

29 
ŒimAá”
(*
lše
, cÚ¡ 
ch
);

30 
ŒimStİs
(*
lše
);

32 
fœ¡šdexof
(cÚ¡ *
¤c
, cÚ¡ 
ch
);

33 
Ï¡šdexof
(cÚ¡ *
¤c
, cÚ¡ 
ch
);

34 
couÁ_wÜds
(cÚ¡ *
¡r
);

35 
·r£_wÜds
(cÚ¡ *
¡r
, 
veùÜ
<> &
nums
);

37 
¥l™_twš
(*
fœ¡
, *
£cÚd
, cÚ¡ *
¤c
, cÚ¡ 
ch
);

39 
·r£Lše
(cÚ¡ *
lše
, cÚ¡ 
¥l™”
, 
£t
<> &
»gTab
);

40 
	m£t
<> 
·r£Lše
(cÚ¡ *
lše
, cÚ¡ 
¥l™”
);

41 
·r£Lše
(cÚ¡ *
lše
, cÚ¡ 
¥l™”
, 
veùÜ
<> &
v®s
);

43 
boŞ
 
exi¡Fe
(cÚ¡ *
â
);

44 
boŞ
 
exi¡Dœ
(cÚ¡ *
dœ
);

45 
boŞ
 
v®id©eP©h
(cÚ¡ *
·th
);

47 
boŞ
 
·r£FName
(
âame
[], cÚ¡ 
·th
[]);

48 
boŞ
 
·r£DIR
(
dœÇme
[], cÚ¡ 
·th
[]);

49 
boŞ
 
·r£P©h
(
âame
[], cÚ¡ 
·th
[]);

50 
boŞ
 
v®idFName
(cÚ¡ 
âame
[]);

51 
toUµ”
(
¡r
[]);

52 
toLow”
(
¡r
[]);

54 cÚ¡ *
time2SŒ
(cÚ¡ 
£cÚds
);

55 
time2SŒ
(*
tmSŒ
, cÚ¡ 
£cÚds
);

57 
‹¡
();

58 
	mvœtu®
 ~
	$VSŒšg
(){}

60 
	}
};

	@/usr/include/alloca.h

18 #iâdef 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

26 
	g__BEGIN_DECLS


29 #undeà
®loÿ


32 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

34 #ifdef 
__GNUC__


35 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

38 
__END_DECLS


	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

97 #undeà
__USE_ISOC11


98 #undeà
__USE_ISOC99


99 #undeà
__USE_ISOC95


100 #undeà
__USE_ISOCXX11


101 #undeà
__USE_POSIX


102 #undeà
__USE_POSIX2


103 #undeà
__USE_POSIX199309


104 #undeà
__USE_POSIX199506


105 #undeà
__USE_XOPEN


106 #undeà
__USE_XOPEN_EXTENDED


107 #undeà
__USE_UNIX98


108 #undeà
__USE_XOPEN2K


109 #undeà
__USE_XOPEN2KXSI


110 #undeà
__USE_XOPEN2K8


111 #undeà
__USE_XOPEN2K8XSI


112 #undeà
__USE_LARGEFILE


113 #undeà
__USE_LARGEFILE64


114 #undeà
__USE_FILE_OFFSET64


115 #undeà
__USE_MISC


116 #undeà
__USE_ATFILE


117 #undeà
__USE_GNU


118 #undeà
__USE_REENTRANT


119 #undeà
__USE_FORTIFY_LEVEL


120 #undeà
__KERNEL_STRICT_NAMES


124 #iâdeà
_LOOSE_KERNEL_NAMES


125 
	#__KERNEL_STRICT_NAMES


	)

135 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


136 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

137 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

139 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

146 #ià(
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE
) \

147 && !
defšed
 
	g_DEFAULT_SOURCE


152 #undeà
_DEFAULT_SOURCE


153 
	#_DEFAULT_SOURCE
 1

	)

157 #ifdeà
_GNU_SOURCE


158 #undeà
_ISOC95_SOURCE


159 
	#_ISOC95_SOURCE
 1

	)

160 #undeà
_ISOC99_SOURCE


161 
	#_ISOC99_SOURCE
 1

	)

162 #undeà
_ISOC11_SOURCE


163 
	#_ISOC11_SOURCE
 1

	)

164 #undeà
_POSIX_SOURCE


165 
	#_POSIX_SOURCE
 1

	)

166 #undeà
_POSIX_C_SOURCE


167 
	#_POSIX_C_SOURCE
 200809L

	)

168 #undeà
_XOPEN_SOURCE


169 
	#_XOPEN_SOURCE
 700

	)

170 #undeà
_XOPEN_SOURCE_EXTENDED


171 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

172 #undeà
_LARGEFILE64_SOURCE


173 
	#_LARGEFILE64_SOURCE
 1

	)

174 #undeà
_DEFAULT_SOURCE


175 
	#_DEFAULT_SOURCE
 1

	)

176 #undeà
_ATFILE_SOURCE


177 
	#_ATFILE_SOURCE
 1

	)

182 #ià(
defšed
 
_DEFAULT_SOURCE
 \

183 || (!
defšed
 
	g__STRICT_ANSI__
 \

184 && !
defšed
 
	g_ISOC99_SOURCE
 \

185 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

186 && !
defšed
 
	g_XOPEN_SOURCE
))

187 #undeà
_DEFAULT_SOURCE


188 
	#_DEFAULT_SOURCE
 1

	)

192 #ià(
defšed
 
_ISOC11_SOURCE
 \

193 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

194 
	#__USE_ISOC11
 1

	)

198 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

199 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

200 
	#__USE_ISOC99
 1

	)

204 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

205 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

206 
	#__USE_ISOC95
 1

	)

213 #ià((
defšed
 
__ılu¥lus
 && __cplusplus >= 201103L) \

214 || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__
)

215 
	#__USE_ISOCXX11
 1

	)

221 #ifdeà
_DEFAULT_SOURCE


222 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


223 
	#__USE_POSIX_IMPLICITLY
 1

	)

225 #undeà
_POSIX_SOURCE


226 
	#_POSIX_SOURCE
 1

	)

227 #undeà
_POSIX_C_SOURCE


228 
	#_POSIX_C_SOURCE
 200809L

	)

230 #ià((!
defšed
 
__STRICT_ANSI__
 \

231 || (
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

232 && !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

233 
	#_POSIX_SOURCE
 1

	)

234 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

235 
	#_POSIX_C_SOURCE
 2

	)

236 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

237 
	#_POSIX_C_SOURCE
 199506L

	)

238 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

239 
	#_POSIX_C_SOURCE
 200112L

	)

241 
	#_POSIX_C_SOURCE
 200809L

	)

243 
	#__USE_POSIX_IMPLICITLY
 1

	)

246 #ià(
defšed
 
_POSIX_SOURCE
 \

247 || (
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

248 || 
defšed
 
_XOPEN_SOURCE
)

249 
	#__USE_POSIX
 1

	)

252 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


253 
	#__USE_POSIX2
 1

	)

256 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

257 
	#__USE_POSIX199309
 1

	)

260 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

261 
	#__USE_POSIX199506
 1

	)

264 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

265 
	#__USE_XOPEN2K
 1

	)

266 #undeà
__USE_ISOC95


267 
	#__USE_ISOC95
 1

	)

268 #undeà
__USE_ISOC99


269 
	#__USE_ISOC99
 1

	)

272 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

273 
	#__USE_XOPEN2K8
 1

	)

274 #undeà
_ATFILE_SOURCE


275 
	#_ATFILE_SOURCE
 1

	)

278 #ifdef 
_XOPEN_SOURCE


279 
	#__USE_XOPEN
 1

	)

280 #ià(
_XOPEN_SOURCE
 - 0) >= 500

281 
	#__USE_XOPEN_EXTENDED
 1

	)

282 
	#__USE_UNIX98
 1

	)

283 #undeà
_LARGEFILE_SOURCE


284 
	#_LARGEFILE_SOURCE
 1

	)

285 #ià(
_XOPEN_SOURCE
 - 0) >= 600

286 #ià(
_XOPEN_SOURCE
 - 0) >= 700

287 
	#__USE_XOPEN2K8
 1

	)

288 
	#__USE_XOPEN2K8XSI
 1

	)

290 
	#__USE_XOPEN2K
 1

	)

291 
	#__USE_XOPEN2KXSI
 1

	)

292 #undeà
__USE_ISOC95


293 
	#__USE_ISOC95
 1

	)

294 #undeà
__USE_ISOC99


295 
	#__USE_ISOC99
 1

	)

298 #ifdeà
_XOPEN_SOURCE_EXTENDED


299 
	#__USE_XOPEN_EXTENDED
 1

	)

304 #ifdeà
_LARGEFILE_SOURCE


305 
	#__USE_LARGEFILE
 1

	)

308 #ifdeà
_LARGEFILE64_SOURCE


309 
	#__USE_LARGEFILE64
 1

	)

312 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

313 
	#__USE_FILE_OFFSET64
 1

	)

316 #ià
defšed
 
_DEFAULT_SOURCE


317 
	#__USE_MISC
 1

	)

320 #ifdef 
_ATFILE_SOURCE


321 
	#__USE_ATFILE
 1

	)

324 #ifdef 
_GNU_SOURCE


325 
	#__USE_GNU
 1

	)

328 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


329 
	#__USE_REENTRANT
 1

	)

332 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

333 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

334 #ià
_FORTIFY_SOURCE
 > 1

335 
	#__USE_FORTIFY_LEVEL
 2

	)

337 
	#__USE_FORTIFY_LEVEL
 1

	)

340 
	#__USE_FORTIFY_LEVEL
 0

	)

345 
	~<¡dc-´edef.h
>

353 #undeà
__GNU_LIBRARY__


354 
	#__GNU_LIBRARY__
 6

	)

358 
	#__GLIBC__
 2

	)

359 
	#__GLIBC_MINOR__
 23

	)

361 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

362 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

365 #iâdeà
__ASSEMBLER__


366 #iâdeà
_SYS_CDEFS_H


367 
	~<sys/cdefs.h
>

372 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


373 
	#__USE_LARGEFILE
 1

	)

374 
	#__USE_LARGEFILE64
 1

	)

380 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

381 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

382 && 
defšed
 
	g__ex‹º_šlše


383 
	#__USE_EXTERN_INLINES
 1

	)

391 
	~<gnu/¡ubs.h
>

	@/usr/include/xlocale.h

20 #iâdeà
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loÿË_¡ruù


30 
__loÿË_d©a
 *
	m__loÿËs
[13];

33 cÚ¡ *
	m__ùy³_b
;

34 cÚ¡ *
	m__ùy³_tŞow”
;

35 cÚ¡ *
	m__ùy³_touµ”
;

38 cÚ¡ *
	m__Çmes
[13];

39 } *
	t__loÿË_t
;

42 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

55 
	#__STDC_ISO_10646__
 201505L

	)

58 
	#__STDC_NO_THREADS__
 1

	)

	@
1
.
1
/usr/include
55
1502
/home/pclin/cpp/gkmeans/abstractkmeans.cpp
/home/pclin/cpp/gkmeans/abstractkmeans.h
/home/pclin/cpp/gkmeans/cleaner.cpp
/home/pclin/cpp/gkmeans/cleaner.h
/home/pclin/cpp/gkmeans/clsinfo.h
/home/pclin/cpp/gkmeans/dataconvert.h
/home/pclin/cpp/gkmeans/distance.hpp
/home/pclin/cpp/gkmeans/evaluator.cpp
/home/pclin/cpp/gkmeans/evaluator.h
/home/pclin/cpp/gkmeans/ioagent.cpp
/home/pclin/cpp/gkmeans/ioagent.h
/home/pclin/cpp/gkmeans/main.cpp
/home/pclin/cpp/gkmeans/missionagent.cpp
/home/pclin/cpp/gkmeans/missionagent.h
/home/pclin/cpp/gkmeans/nn.h
/home/pclin/cpp/gkmeans/nngkmeans.cpp
/home/pclin/cpp/gkmeans/nngkmeans.h
/home/pclin/cpp/gkmeans/nnitem.h
/home/pclin/cpp/gkmeans/pqmath.cpp
/home/pclin/cpp/gkmeans/pqmath.h
/home/pclin/cpp/gkmeans/print2scrn.cpp
/home/pclin/cpp/gkmeans/print2scrn.h
/home/pclin/cpp/gkmeans/randompartition.cpp
/home/pclin/cpp/gkmeans/randompartition.h
/home/pclin/cpp/gkmeans/scriptparser.cpp
/home/pclin/cpp/gkmeans/scriptparser.h
/home/pclin/cpp/gkmeans/sparsematrix.h
/home/pclin/cpp/gkmeans/timer.cpp
/home/pclin/cpp/gkmeans/timer.h
/home/pclin/cpp/gkmeans/vstring.cpp
/home/pclin/cpp/gkmeans/vstring.h
/usr/include/dirent.h
/usr/include/stdlib.h
/usr/include/time.h
abstractkmeans.h
cleaner.h
clsinfo.h
distance.hpp
evaluator.h
ioagent.h
missionagent.h
nn.h
nngkmeans.h
nnitem.h
pqmath.h
print2scrn.h
randompartition.h
scriptparser.h
sparsematrix.h
timer.h
vstring.h
/usr/include/alloca.h
/usr/include/features.h
/usr/include/xlocale.h
/usr/include/stdc-predef.h
